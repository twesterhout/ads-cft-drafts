(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    305599,       7932]
NotebookOptionsPosition[    290892,       7721]
NotebookOutlinePosition[    291294,       7737]
CellTagsIndexPosition[    291251,       7734]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Metric definition", "Section"]], "Text",
 CellChangeTimes->{
  3.8302762083487587`*^9},ExpressionUUID->"e04412b3-640a-44e4-8bd7-\
1b249639252c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<third_party/EDCRGTCcode.m\>\""}], 
  RowBox[{"(*", " ", 
   RowBox[{"Riemann", " ", "Geometry", " ", "Tensor", " ", "Calculus"}], " ", 
   "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.828071012516212*^9, 3.828071013490035*^9}, {
   3.828071063954351*^9, 3.828071090824278*^9}, {3.82826180774688*^9, 
   3.828261860967005*^9}, 3.8299739958325167`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"2058286f-9816-456d-8fd4-cb50e7d52def"],

Cell[TextData[{
 "Let us start by defining the ansatz for the metric ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "d0fd28e2-4d35-4dc6-b150-9cc9456d1ab5"],
 ". We define the line element ",
 Cell[BoxData[
  FormBox["ds", TraditionalForm]],ExpressionUUID->
  "8601a4eb-415f-4413-91b8-87797529001d"],
 ":"
}], "Text",
 CellChangeTimes->{{3.828070226634451*^9, 3.828070244040955*^9}, {
  3.828070304452022*^9, 3.828070340057252*^9}, {3.828070819077345*^9, 
  3.82807083406567*^9}, {3.830274739349166*^9, 3.8302747787759047`*^9}, {
  3.830274820373098*^9, 
  3.830274842413706*^9}},ExpressionUUID->"10217085-1c6e-496a-9671-\
1f29c001f45e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "Coord", ",", "dCoord", ",", "ds", ",", "P", ",", " ", "L", ",", " ", 
    "\[Mu]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coord", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dCoord", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"dt", ",", "dx", ",", "dy", ",", "dz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds", "=", 
   RowBox[{
    FractionBox[
     SuperscriptBox["L", "2"], 
     SuperscriptBox["z", "2"]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"1", "-", "z"}], ")"}]}], 
       RowBox[{"P", "[", "z", "]"}], 
       RowBox[{"Qtt", "[", 
        RowBox[{"x", ",", "z"}], "]"}], " ", 
       SuperscriptBox["dt", "2"]}], " ", "+", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "z"}], "]"}], " ", 
        SuperscriptBox["dz", "2"]}], 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", "z"}], ")"}]}]], "+", 
      RowBox[{
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "z"}], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"dx", " ", "+", " ", 
          RowBox[{
           SuperscriptBox["z", "2"], 
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "z"}], "]"}], "dz"}]}], ")"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"Qyy", "[", 
        RowBox[{"x", ",", "z"}], "]"}], 
       SuperscriptBox["dy", "2"]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "z_", "]"}], " ", ":=", 
   RowBox[{"1", "+", "z", "+", 
    SuperscriptBox["z", "2"], "-", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Mu]", "2"], 
      SuperscriptBox["z", "3"]}], "2"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6689227811718473`*^9, 3.6689228938939457`*^9}, {
  3.668922925446006*^9, 3.668923062694755*^9}, {3.668924507918563*^9, 
  3.6689245188382607`*^9}, {3.828070412390685*^9, 3.828070479091604*^9}, {
  3.828070658975978*^9, 3.828070699084558*^9}, {3.82807078454073*^9, 
  3.828070784909626*^9}, {3.828070913903411*^9, 3.8280709214309072`*^9}, {
  3.828071111202485*^9, 3.8280711384910707`*^9}, {3.8280715499016457`*^9, 
  3.828071555422594*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"9333a9ab-f331-4260-840e-c4470776d2d7"],

Cell[TextData[{
 "Now we can obtain ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "1b55a9ec-5104-4b58-8079-54087189f557"],
 " (we will use \[OpenCurlyDoubleQuote]d\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] to denote lower or upper \
indices):"
}], "Text",
 CellChangeTimes->{{3.828070792573882*^9, 3.828070807492648*^9}, {
  3.828070838822495*^9, 3.828070854842308*^9}, {3.828071290065103*^9, 
  3.828071328486828*^9}},ExpressionUUID->"de52d0cd-a9a3-4010-bf90-\
8b8ad4d124a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "g`dd", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g`dd", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"ds", ",", "#"}], "]"}], "&"}], ",", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"dCoord", ",", "dCoord"}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"UpperTriangularize", "[", "t", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t", "+", 
          RowBox[{"Transpose", "[", "t", "]"}]}], ")"}], "/", "2"}], "//", 
       "Simplify"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6689227811718473`*^9, 3.6689228938939457`*^9}, {
   3.668922925446006*^9, 3.668923062694755*^9}, {3.668924507918563*^9, 
   3.6689245188382607`*^9}, 3.828070877610923*^9, {3.8280709268140182`*^9, 
   3.828070931543746*^9}, {3.828070963213306*^9, 3.828070973682391*^9}, {
   3.828071160900569*^9, 3.828071278363995*^9}, {3.830274945340941*^9, 
   3.830274945726845*^9}, {3.8303499474980173`*^9, 3.830349995520851*^9}, {
   3.830350254648329*^9, 3.830350416344852*^9}, {3.830350483207498*^9, 
   3.830350510919792*^9}, 3.8683335752349873`*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"2c81f3e5-6ad0-4fc5-be1c-e8b81edc1df7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g`dd", " ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g`dd", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"L", "\[Rule]", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "3"}]}], "}"}]}], " ", "//", " ", 
  "FullForm"}]}], "Input",
 CellChangeTimes->{{3.8683328899592257`*^9, 3.868332891874404*^9}, {
  3.868333004947701*^9, 3.868333020130204*^9}, {3.86833311694027*^9, 
  3.868333136181119*^9}, {3.8683332221665287`*^9, 3.8683332457131023`*^9}, {
  3.868333529434441*^9, 3.868333539972863*^9}, {3.868333577290346*^9, 
  3.868333583028706*^9}, {3.868333678069797*^9, 3.868333699132614*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"61e8501b-e71c-4498-9ec3-57bf0e8a5fab"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z", "+", 
          SuperscriptBox["z", "2"], "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["z", "3"], " ", 
            SuperscriptBox["\[Mu]", "2"]}], "2"]}], ")"}], " ", 
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "z"}], "]"}]}], 
       SuperscriptBox["z", "2"]], "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "z"}], "]"}]}], 
       SuperscriptBox["z", "2"]], "0", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", 
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "z"}], "]"}], " ", 
       RowBox[{"Qxz", "[", 
        RowBox[{"x", ",", "z"}], "]"}]}]},
     {"0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"Qyy", "[", 
         RowBox[{"x", ",", "z"}], "]"}]}], 
       SuperscriptBox["z", "2"]], "0"},
     {"0", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", 
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "z"}], "]"}], " ", 
       RowBox[{"Qxz", "[", 
        RowBox[{"x", ",", "z"}], "]"}]}], "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["z", "4"], " ", 
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Qxz", "[", 
             RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"Qzz", "[", 
             RowBox[{"x", ",", "z"}], "]"}]}], 
           RowBox[{"2", "+", 
            RowBox[{
             SuperscriptBox["z", "4"], " ", 
             SuperscriptBox["\[Mu]", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["z", "3"], " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}]]}], ")"}]}], 
       SuperscriptBox["z", "2"]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.86833301351198*^9, {3.868333107609376*^9, 3.86833313666796*^9}, {
   3.8683332244484177`*^9, 3.868333246073205*^9}, {3.8683335313567677`*^9, 
   3.8683335403132353`*^9}, {3.868333583571829*^9, 3.8683336042844143`*^9}, {
   3.868333692909349*^9, 3.868333699924486*^9}, 3.868686487787397*^9, 
   3.869240811324257*^9},
 CellLabel->
  "Out[98]//MatrixForm=",ExpressionUUID->"0987b41c-4b2a-4a74-b7ae-\
ad75569b800c"]
}, Open  ]],

Cell["\<\
Next, we use EDCRGT package to compute a few useful quantities such as \
Christoffel symbols and Riemann tensor:\
\>", "Text",
 CellChangeTimes->{{3.82807136521244*^9, 3.8280714184738817`*^9}, {
  3.830274899098885*^9, 
  3.830274928483005*^9}},ExpressionUUID->"42e7e01e-bd3c-4b31-87e0-\
240f2043ff7a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"g`UU", ",", "\[CapitalGamma]`Udd", ",", "R`Uddd", ",", "R`dd"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RGtensors", "[", 
   RowBox[{"g`dd", ",", "Coord", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g`UU", "=", "gUU"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]`Udd", "=", "GUdd"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R`Uddd", "=", "RUddd"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R`dd", "=", "Rdd"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"gUU", ",", "GUdd", ",", "Rdddd", ",", "RUddd", ",", "Rdd"}], 
     "]"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.828261911771081*^9, 3.82826196288898*^9}, {
  3.8282620132019787`*^9, 3.828262039509717*^9}, {3.850299524163578*^9, 
  3.8502995658995237`*^9}, {3.868686614000211*^9, 3.8686866191033373`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"9fb09d0b-588f-4582-ae16-9d3c91edba08"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gdd = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{
          SuperscriptBox["L", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z", "+", 
            SuperscriptBox["z", "2"], "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["z", "3"], " ", 
              SuperscriptBox["\[Mu]", "2"]}], "2"]}], ")"}], " ", 
          RowBox[{"Qtt", "[", 
           RowBox[{"x", ",", "z"}], "]"}]}], 
         SuperscriptBox["z", "2"]], "0", "0", "0"},
       {"0", 
        FractionBox[
         RowBox[{
          SuperscriptBox["L", "2"], " ", 
          RowBox[{"Qxx", "[", 
           RowBox[{"x", ",", "z"}], "]"}]}], 
         SuperscriptBox["z", "2"]], "0", 
        RowBox[{
         SuperscriptBox["L", "2"], " ", 
         RowBox[{"Qxx", "[", 
          RowBox[{"x", ",", "z"}], "]"}], " ", 
         RowBox[{"Qxz", "[", 
          RowBox[{"x", ",", "z"}], "]"}]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          SuperscriptBox["L", "2"], " ", 
          RowBox[{"Qyy", "[", 
           RowBox[{"x", ",", "z"}], "]"}]}], 
         SuperscriptBox["z", "2"]], "0"},
       {"0", 
        RowBox[{
         SuperscriptBox["L", "2"], " ", 
         RowBox[{"Qxx", "[", 
          RowBox[{"x", ",", "z"}], "]"}], " ", 
         RowBox[{"Qxz", "[", 
          RowBox[{"x", ",", "z"}], "]"}]}], "0", 
        FractionBox[
         RowBox[{
          SuperscriptBox["L", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["z", "4"], " ", 
             RowBox[{"Qxx", "[", 
              RowBox[{"x", ",", "z"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Qxz", "[", 
               RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
            FractionBox[
             RowBox[{"2", " ", 
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "z"}], "]"}]}], 
             RowBox[{"2", "+", 
              RowBox[{
               SuperscriptBox["z", "4"], " ", 
               SuperscriptBox["\[Mu]", "2"]}], "-", 
              RowBox[{
               SuperscriptBox["z", "3"], " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}]]}], ")"}]}], 
         SuperscriptBox["z", "2"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gdd = ", 
   MatrixForm[{{$CellContext`L^2 (-1 + $CellContext`z) $CellContext`z^(-2) (
       1 + $CellContext`z + $CellContext`z^2 + 
       Rational[-1, 
          2] $CellContext`z^3 $CellContext`\[Mu]^2) \
$CellContext`Qtt[$CellContext`x, $CellContext`z], 0, 0, 0}, {
     0, $CellContext`L^2 $CellContext`z^(-2) $CellContext`Qxx[$CellContext`x, \
$CellContext`z], 
      0, $CellContext`L^2 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]}, {
     0, 0, $CellContext`L^2 $CellContext`z^(-2) \
$CellContext`Qyy[$CellContext`x, $CellContext`z], 0}, {
     0, $CellContext`L^2 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z], 
      0, $CellContext`L^2 $CellContext`z^(-2) ($CellContext`z^4 \
$CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 + 
       2 (2 + $CellContext`z^4 $CellContext`\[Mu]^2 - $CellContext`z^3 (
           2 + $CellContext`\[Mu]^2))^(-1) $CellContext`Qzz[$CellContext`x, \
$CellContext`z])}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240825493877*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"9a24b16a-ef8b-4443-9703-31dfcff03bc3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LineElement = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "-", 
          RowBox[{"2", " ", "z"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["z", "3"], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"d", "[", "t", "]"}], "2"], " ", 
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "z"}], "]"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"]}]]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["L", "2"], " ", 
       SuperscriptBox[
        RowBox[{"d", "[", "x", "]"}], "2"], " ", 
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "z"}], "]"}]}], 
      SuperscriptBox["z", "2"]], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["L", "2"], " ", 
      RowBox[{"d", "[", "x", "]"}], " ", 
      RowBox[{"d", "[", "z", "]"}], " ", 
      RowBox[{"Qxx", "[", 
       RowBox[{"x", ",", "z"}], "]"}], " ", 
      RowBox[{"Qxz", "[", 
       RowBox[{"x", ",", "z"}], "]"}]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["L", "2"], " ", 
       SuperscriptBox[
        RowBox[{"d", "[", "y", "]"}], "2"], " ", 
       RowBox[{"Qyy", "[", 
        RowBox[{"x", ",", "z"}], "]"}]}], 
      SuperscriptBox["z", "2"]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        SuperscriptBox[
         RowBox[{"d", "[", "z", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["z", "4"], " ", 
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Qxz", "[", 
             RowBox[{"x", ",", "z"}], "]"}], "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["z", "7"], " ", 
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Qxz", "[", 
             RowBox[{"x", ",", "z"}], "]"}], "2"]}], "-", 
          RowBox[{
           SuperscriptBox["z", "7"], " ", 
           SuperscriptBox["\[Mu]", "2"], " ", 
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Qxz", "[", 
             RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["z", "8"], " ", 
           SuperscriptBox["\[Mu]", "2"], " ", 
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Qxz", "[", 
             RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
        SuperscriptBox["z", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "-", 
          RowBox[{"2", " ", "z"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["z", "3"], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], ")"}]}]}],
    Short[#, 32]& ]}],
  SequenceForm["LineElement = ", 
   Short[Rational[-1, 
       2] $CellContext`L^2 (-1 + $CellContext`z) $CellContext`z^(-2) (-2 - 
      2 $CellContext`z - 
      2 $CellContext`z^2 + $CellContext`z^3 $CellContext`\[Mu]^2) \
$CellContext`d[$CellContext`t]^2 $CellContext`Qtt[$CellContext`x, \
$CellContext`z] + $CellContext`L^2 $CellContext`z^(-2) \
$CellContext`d[$CellContext`x]^2 $CellContext`Qxx[$CellContext`x, \
$CellContext`z] + 
    2 $CellContext`L^2 $CellContext`d[$CellContext`x] \
$CellContext`d[$CellContext`z] $CellContext`Qxx[$CellContext`x, \
$CellContext`z] $CellContext`Qxz[$CellContext`x, $CellContext`z] + \
$CellContext`L^2 $CellContext`z^(-2) $CellContext`d[$CellContext`y]^2 \
$CellContext`Qyy[$CellContext`x, $CellContext`z] + $CellContext`L^2 (-1 + \
$CellContext`z)^(-1) $CellContext`z^(-2) (-2 - 2 $CellContext`z - 
       2 $CellContext`z^2 + $CellContext`z^3 $CellContext`\[Mu]^2)^(-1) \
$CellContext`d[$CellContext`z]^2 (
      2 $CellContext`z^4 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 - 
      2 $CellContext`z^7 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 - $CellContext`z^7 \
$CellContext`\[Mu]^2 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 + $CellContext`z^8 \
$CellContext`\[Mu]^2 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 + 
      2 $CellContext`Qzz[$CellContext`x, $CellContext`z]), 32]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240825509087*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"285882df-1b71-49a3-a59b-402fee2783e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           SuperscriptBox["z", "2"]}], 
          RowBox[{
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", "z"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["z", "3"], " ", 
              SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
           RowBox[{"Qtt", "[", 
            RowBox[{"x", ",", "z"}], "]"}]}]]}], "0", "0", "0"},
       {"0", 
        FractionBox[
         RowBox[{
          SuperscriptBox["z", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["z", "4"], " ", 
             RowBox[{"Qxx", "[", 
              RowBox[{"x", ",", "z"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Qxz", "[", 
               RowBox[{"x", ",", "z"}], "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["z", "7"], " ", 
             RowBox[{"Qxx", "[", 
              RowBox[{"x", ",", "z"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Qxz", "[", 
               RowBox[{"x", ",", "z"}], "]"}], "2"]}], "-", 
            RowBox[{
             SuperscriptBox["z", "7"], " ", 
             SuperscriptBox["\[Mu]", "2"], " ", 
             RowBox[{"Qxx", "[", 
              RowBox[{"x", ",", "z"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Qxz", "[", 
               RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["z", "8"], " ", 
             SuperscriptBox["\[Mu]", "2"], " ", 
             RowBox[{"Qxx", "[", 
              RowBox[{"x", ",", "z"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Qxz", "[", 
               RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Qzz", "[", 
              RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["L", "2"], " ", 
          RowBox[{"Qxx", "[", 
           RowBox[{"x", ",", "z"}], "]"}], " ", 
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]], "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
           SuperscriptBox["z", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", "z"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["z", "3"], " ", 
              SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "z"}], "]"}]}], 
          RowBox[{"2", " ", 
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "z"}], "]"}]}]]}]},
       {"0", "0", 
        FractionBox[
         SuperscriptBox["z", "2"], 
         RowBox[{
          SuperscriptBox["L", "2"], " ", 
          RowBox[{"Qyy", "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]], "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
           SuperscriptBox["z", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", "z"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["z", "3"], " ", 
              SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "z"}], "]"}]}], 
          RowBox[{"2", " ", 
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "z"}], "]"}]}]]}], "0", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
          SuperscriptBox["z", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "-", 
            RowBox[{"2", " ", "z"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["z", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["z", "3"], " ", 
             SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["L", "2"], " ", 
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gUU = ", 
   MatrixForm[{{(-2) $CellContext`L^(-2) (-1 + $CellContext`z)^(-1) \
$CellContext`z^2 (-2 - 2 $CellContext`z - 
        2 $CellContext`z^2 + $CellContext`z^3 \
$CellContext`\[Mu]^2)^(-1)/$CellContext`Qtt[$CellContext`x, $CellContext`z], 
      0, 0, 0}, {
     0, Rational[
       1, 2] $CellContext`L^(-2) $CellContext`z^2 \
$CellContext`Qxx[$CellContext`x, $CellContext`z]^(-1) \
$CellContext`Qzz[$CellContext`x, $CellContext`z]^(-1) (
       2 $CellContext`z^4 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 - 
       2 $CellContext`z^7 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 - $CellContext`z^7 \
$CellContext`\[Mu]^2 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 + $CellContext`z^8 \
$CellContext`\[Mu]^2 $CellContext`Qxx[$CellContext`x, $CellContext`z] \
$CellContext`Qxz[$CellContext`x, $CellContext`z]^2 + 
       2 $CellContext`Qzz[$CellContext`x, $CellContext`z]), 0, 
      Rational[-1, 
        2] $CellContext`L^(-2) (-1 + $CellContext`z) $CellContext`z^4 (-2 - 
       2 $CellContext`z - 
       2 $CellContext`z^2 + $CellContext`z^3 $CellContext`\[Mu]^2) \
$CellContext`Qxz[$CellContext`x, \
$CellContext`z]/$CellContext`Qzz[$CellContext`x, $CellContext`z]}, {
     0, 0, $CellContext`L^(-2) \
$CellContext`z^2/$CellContext`Qyy[$CellContext`x, $CellContext`z], 0}, {
     0, Rational[-1, 
        2] $CellContext`L^(-2) (-1 + $CellContext`z) $CellContext`z^4 (-2 - 
       2 $CellContext`z - 
       2 $CellContext`z^2 + $CellContext`z^3 $CellContext`\[Mu]^2) \
$CellContext`Qxz[$CellContext`x, \
$CellContext`z]/$CellContext`Qzz[$CellContext`x, $CellContext`z], 0, 
      Rational[1, 
        2] $CellContext`L^(-2) (-1 + $CellContext`z) $CellContext`z^2 (-2 - 
       2 $CellContext`z - 
       2 $CellContext`z^2 + $CellContext`z^3 \
$CellContext`\[Mu]^2)/$CellContext`Qzz[$CellContext`x, $CellContext`z]}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240825526127*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"57c37888-72a8-4134-bcfe-7e970fccb190"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU computed in \"\>", "\[InvisibleSpace]", 
   "0.011265999999977794`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["gUU computed in ", 0.011265999999977794`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240825540696*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"e7b940dc-215d-456a-ae24-f2be0b26c1b0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gamma computed in \"\>", "\[InvisibleSpace]", 
   "0.09173899999996138`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Gamma computed in ", 0.09173899999996138, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240825596438*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"48c8d6d2-1baf-440a-919f-db4234c7b2bf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(dddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.4410530000000108`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(dddd) computed in ", 0.4410530000000108, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240826037055*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"60a7c078-91dc-4538-9c56-164c7d7aeb33"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(Uddd) computed in \"\>", "\[InvisibleSpace]", 
   "1.2895669999998063`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(Uddd) computed in ", 1.2895669999998063`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240827325448*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"a1e07191-5caa-4242-af1a-e26ce062cf27"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Ricci computed in \"\>", "\[InvisibleSpace]", 
   "3.6513190000000577`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Ricci computed in ", 3.6513190000000577`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240830973814*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"2946297b-61e6-492a-b61e-dc96716653bb"],

Cell[BoxData[
 StyleBox["\<\"Weyl tensor not computed\"\>",
  StripOnInput->False,
  FontSize->16,
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240830986747*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"5c61af63-7145-478b-9ab8-d1e778b6f190"],

Cell[BoxData[
 StyleBox["\<\"Einstein tensor not computed\"\>",
  StripOnInput->False,
  FontSize->16,
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.869240831001223*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"dad8a8c1-774d-4668-8c07-d5d1cf7195da"],

Cell[BoxData["\<\"All tasks completed in 5.51707 seconds\"\>"], "Print",
 CellChangeTimes->{{3.850298646754161*^9, 3.8502986549896603`*^9}, 
   3.8502986950570307`*^9, 3.850299566704556*^9, 3.8686864971910057`*^9, 
   3.86868661959774*^9, 3.8692408310159187`*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"7c4377d7-78a0-4977-b18c-4bc80ee97889"]
}, Open  ]]
}, Open  ]],

Cell[TextData[StyleBox["Exporting expressions to C++ header files", \
"Section"]], "Text",
 CellChangeTimes->{{3.830276130331777*^9, 3.8302761427179813`*^9}, {
  3.830276181547792*^9, 
  3.8302761820470457`*^9}},ExpressionUUID->"92e84169-33a1-4e2a-8eb0-\
b92a6e833f99"],

Cell["\<\
Entering expressions like the above into numerical code written in another \
language is very error-prone. Instead, we will automatically convert \
expressions into Halide code.
Step one is to get rid of \[OpenCurlyDoubleQuote]^\[CloseCurlyDoubleQuote] \
character since in C++ it is interpreted as bitwise exclusive or rather than \
exponentiation. We will rewrite powers as products and then replace \
\[OpenCurlyDoubleQuote]*\[CloseCurlyDoubleQuote] with \[OpenCurlyDoubleQuote]\
\[CirclePlus]\[CloseCurlyDoubleQuote] to ensure that Mathematica does not \
simplify it back into powers. Later on, we can always replace \
\[OpenCurlyDoubleQuote]\[CirclePlus]\[CloseCurlyDoubleQuote] with \
\[OpenCurlyDoubleQuote]*\[CloseCurlyDoubleQuote] in the string \
representation. Note that we specifically picked \[OpenCurlyDoubleQuote]\
\[CirclePlus]\[CloseCurlyDoubleQuote] because it has no built-in meaning in \
Mathematica and it has a relatively low precedence (we want Mathematica to \
put enough parentheses).\
\>", "Text",
 CellChangeTimes->{{3.828073735035111*^9, 3.828074149412776*^9}, {
  3.830275312491612*^9, 
  3.830275314486264*^9}},ExpressionUUID->"88d955bc-9947-4cf8-bf05-\
568af34a5e60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"RewritePowerAsTimes", ",", " ", "RepeatedRewrite"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RepeatedRewrite", "[", 
    RowBox[{"expr_", ",", " ", "f_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#", ",", " ", 
        RowBox[{"x_", " ", ":>", " ", 
         RowBox[{"f", "[", "x", "]"}]}]}], " ", "]"}], "&"}], ",", 
     RowBox[{"expr", "/.", 
      RowBox[{"{", 
       RowBox[{"x_", " ", ":>", " ", 
        RowBox[{"f", "[", "x", "]"}]}], "}"}]}], ",", "Infinity"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewritePowerAsTimes", "[", "x_", "]"}], " ", ":=", " ", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewritePowerAsTimes", "[", 
    RowBox[{"x_", "^", 
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}]}], "]"}], " ", ":=", 
   RowBox[{"CircleTimes", "[", 
    RowBox[{"1", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewritePowerAsTimes", "[", 
    RowBox[{"x_", "^", "n_Integer"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", "=", 
        RowBox[{"CirclePlus", " ", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{"x", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Abs", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", ">", "0"}], ",", "t", ",", 
        RowBox[{"CircleTimes", "[", 
         RowBox[{"1", ",", "t"}], "]"}]}], "]"}]}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"Abs", "[", "n", "]"}], ">", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.828071665274109*^9, 3.828071938811919*^9}, {
   3.828071977869735*^9, 3.828072094497354*^9}, {3.828074201282503*^9, 
   3.828074220555674*^9}, {3.828074528012631*^9, 3.828074626686119*^9}, {
   3.828074662042871*^9, 3.828074682143005*^9}, 3.828074716572612*^9, {
   3.828077538058861*^9, 3.8280775873864727`*^9}, {3.83095357772134*^9, 
   3.830953650238935*^9}, {3.830953924894163*^9, 3.830953925242441*^9}, {
   3.830954248460681*^9, 3.830954252330535*^9}, {3.8309542882132177`*^9, 
   3.8309543478599987`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"faf3eef3-4e56-4690-870e-908330bf6e7b"],

Cell["\<\
Next step is to rewrite expressions such as \[OpenCurlyDoubleQuote]Qxz[x, z]\
\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]Derivative[0, 1][Qxz[x, \
z]]\[CloseCurlyDoubleQuote] into something C++ can understand. We will do \
this in two steps. First, we will drop \[OpenCurlyDoubleQuote][x, z]\
\[CloseCurlyDoubleQuote] arguments since all our functions are local. Then we \
will rewrite derivatives into symbols, e.g. \
\[OpenCurlyDoubleQuote]Derivative[0, 1][Qxz]\[CloseCurlyDoubleQuote] will \
become \[OpenCurlyDoubleQuote]DzQxz\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{{3.828076716447606*^9, 3.8280768154023542`*^9}, {
  3.8280768714224873`*^9, 3.828076929191475*^9}, {3.8280769794151907`*^9, 
  3.828077099732345*^9}, {3.8280772039605083`*^9, 3.8280772117043962`*^9}, {
  3.830275338497546*^9, 
  3.8302753562713614`*^9}},ExpressionUUID->"5d53460c-658f-4870-b815-\
2d758e83097e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RewriteDerivativeAsSymbol", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteDerivativeAsSymbol", "[", "x_", "]"}], " ", ":=", " ", 
   "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteDerivativeAsSymbol", "[", 
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"nx_Integer", ",", " ", "nz_Integer"}], "]"}], "[", "s_Symbol", 
     "]"}], "]"}], " ", ":=", 
   RowBox[{"Symbol", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"\"\<Dx\>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nx"}], "}"}]}], "]"}], "]"}], "<>", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"\"\<Dz\>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nz"}], "}"}]}], "]"}], "]"}], "<>", 
     RowBox[{"ToString", "[", "s", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteDerivativeAsSymbol", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"nx_Integer", ",", " ", "nz_Integer"}], "]"}], "[", "s_Symbol",
       "]"}], "[", 
     RowBox[{"x", ",", "z"}], "]"}], "]"}], " ", ":=", " ", 
   RowBox[{"RewriteDerivativeAsSymbol", "[", 
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"nx", ",", " ", "nz"}], "]"}], "[", "s", "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.828077156677102*^9, 3.828077253628105*^9}, {
   3.8280773183201637`*^9, 3.828077421330606*^9}, 3.828077489281702*^9, {
   3.830940255857132*^9, 3.83094025803374*^9}, {3.830940292645001*^9, 
   3.830940294208036*^9}, {3.830940344023757*^9, 3.8309403451619377`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"cfa4974f-13f4-478b-b956-164df4b6eb6e"],

Cell[CellGroupData[{

Cell["For example:", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.82807748558817*^9, 3.8280774870121527`*^9}, 
   3.8280803001956367`*^9},ExpressionUUID->"246443fd-a70c-40ba-a15c-\
6f53ea94aad0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"RewriteDerivativeAsSymbol", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Qzz", "[", 
       RowBox[{"x", ",", "z"}], "]"}], ",", " ", "z"}], "]"}], "]"}], ",", 
   " ", 
   RowBox[{"RewriteDerivativeAsSymbol", "[", 
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "[", "Qzz", "]"}], "]"}], ",", " ", 
   RowBox[{"Q", "[", 
    RowBox[{"x", ",", "z"}], "]"}]}], "}"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.828077274004993*^9, 3.828077298127198*^9}, {
   3.828077425990902*^9, 3.828077469316218*^9}, {3.828077637413698*^9, 
   3.8280776932804203`*^9}, 3.8280803001961823`*^9, {3.8309403237647467`*^9, 
   3.8309403252803497`*^9}, {3.830949330095312*^9, 3.8309493302908583`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"7049a8e2-b8ff-4b1b-9b7a-f0cb56303d39"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"DzQzz", ",", "DzQzz", ",", 
   RowBox[{"Q", "[", 
    RowBox[{"x", ",", "z"}], "]"}]}], "}"}]], "Output",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{3.8309493321266603`*^9, 3.831105602761306*^9, 
  3.850297854347912*^9, 3.850298722700263*^9, 3.8686865280343857`*^9, 
  3.8686866490747223`*^9, 3.8692408876084337`*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"46a7fc9a-42dc-4ca0-a672-d177c41fd517"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Parameters", "=", 
   RowBox[{"{", 
    RowBox[{
    "Qtt", ",", "Qxx", ",", "Qyy", ",", "Qzz", ",", "Qxz", ",", "\[Psi]", ",",
      "\[Phi]1", ",", "\[Chi]1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.830940850815866*^9, 3.830940885781952*^9}, {
  3.830945569492733*^9, 3.8309455871454144`*^9}, {3.830945812659802*^9, 
  3.830945813978456*^9}, {3.830946220872908*^9, 3.830946223384004*^9}, {
  3.869240901068604*^9, 3.869240901729847*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"a22d6691-d649-4d57-9d1c-2256257ee6c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"ParameterQ", ",", "CoordQ", ",", "RewriteParameter"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParameterQ", "[", "s_", "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"Parameters", ",", "s"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordQ", "[", "s_", "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"Coord", ",", "s"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteParameter", "[", "xx_", "]"}], ":=", "xx"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteParameter", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"nx_Integer", ",", "nz_Integer"}], "]"}], "[", 
      RowBox[{"s_", "?", "ParameterQ"}], "]"}], "[", 
     RowBox[{
      RowBox[{"xx_", "?", "CoordQ"}], ",", 
      RowBox[{"zz_", "?", "NumberQ"}]}], "]"}], "]"}], ":=", 
   RowBox[{"RewriteParameter", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"nx", ",", "nz"}], "]"}], "[", "s", "]"}], "[", 
     RowBox[{"xx", ",", "z"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteParameter", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"nx_Integer", ",", " ", "nz_Integer"}], "]"}], "[", 
      RowBox[{"s_", "?", "ParameterQ"}], "]"}], "[", 
     RowBox[{
      RowBox[{"x_", "?", "CoordQ"}], ",", 
      RowBox[{"z_", "?", "CoordQ"}]}], "]"}], "]"}], " ", ":=", " ", 
   RowBox[{"Apply", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<D\>\"", ",", 
          RowBox[{"nx", "+", "nz"}]}], "]"}], "]"}], "<>", "\"\<Q\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "batch", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FirstPosition", "[", 
            RowBox[{"Coord", ",", "x"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "nx"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FirstPosition", "[", 
            RowBox[{"Coord", ",", "z"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "nz"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstPosition", "[", 
           RowBox[{"Parameters", ",", "s"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteParameter", "[", 
    RowBox[{
     RowBox[{"s_", "?", "ParameterQ"}], "[", 
     RowBox[{
      RowBox[{"x_", "?", "CoordQ"}], ",", 
      RowBox[{
       RowBox[{"z_", "?", "CoordQ"}], "|", 
       RowBox[{"z_", "?", "NumberQ"}]}]}], "]"}], "]"}], ":=", 
   RowBox[{"Q", "[", 
    RowBox[{"batch", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FirstPosition", "[", 
        RowBox[{"Parameters", ",", "s"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.830941729815379*^9, 3.8309417887851057`*^9}, {
   3.8309419084210043`*^9, 3.830941926188911*^9}, {3.830942034358083*^9, 
   3.830942044593306*^9}, {3.830945309073429*^9, 3.830945362814035*^9}, {
   3.830945486812286*^9, 3.83094556010431*^9}, {3.83094567063459*^9, 
   3.830945746965869*^9}, {3.830945852442615*^9, 3.830945857466117*^9}, {
   3.830945981009158*^9, 3.830946129329378*^9}, {3.8309461876487007`*^9, 
   3.8309461985609093`*^9}, {3.830946233893785*^9, 3.8309462345499287`*^9}, {
   3.830947775824292*^9, 3.830947776765544*^9}, {3.830949084937875*^9, 
   3.830949095544126*^9}, {3.8309491512762747`*^9, 3.830949152685483*^9}, {
   3.8309492027956057`*^9, 3.830949223843313*^9}, {3.830949472599613*^9, 
   3.83094960197114*^9}, {3.830949669172085*^9, 3.830949766138423*^9}, {
   3.830949913315708*^9, 3.8309499272378693`*^9}, {3.831105781695425*^9, 
   3.831105794659628*^9}, {3.831105826172883*^9, 3.831105828363316*^9}, {
   3.831114677027103*^9, 3.831114717564382*^9}, {3.8691413013925333`*^9, 
   3.869141302276843*^9}, {3.869141377162951*^9, 3.8691415007189627`*^9}, {
   3.869141643413789*^9, 3.869141657061837*^9}, {3.869141789066461*^9, 
   3.869141840731585*^9}, {3.869141871180935*^9, 3.869141883559067*^9}, {
   3.869142008057699*^9, 3.8691420124848557`*^9}, {3.869142058045526*^9, 
   3.869142064686966*^9}, {3.869142308810422*^9, 3.869142316887982*^9}, {
   3.869142349102415*^9, 3.8691423821323023`*^9}, {3.869142431674313*^9, 
   3.869142432012412*^9}, {3.869193086557906*^9, 3.869193089280822*^9}, {
   3.869193139050076*^9, 3.869193164654915*^9}, {3.8691932786792316`*^9, 
   3.869193419897889*^9}, {3.869193487267989*^9, 3.869193501968664*^9}, {
   3.869193559921653*^9, 3.8691935802429457`*^9}, {3.869193818300748*^9, 
   3.869193992907745*^9}, {3.8691940310691013`*^9, 3.86919413141637*^9}, {
   3.869194169874887*^9, 3.869194201794956*^9}, {3.869194238777911*^9, 
   3.869194251919132*^9}, {3.869194290698591*^9, 3.869194354866489*^9}, {
   3.869194406752358*^9, 3.869194452660158*^9}, 3.869240929219777*^9},
 CellLabel->
  "In[126]:=",ExpressionUUID->"49236ed5-3bb9-43e6-a9f7-2108c1b08660"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PrepareForHalide", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrepareForHalide", "[", "expression_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", "expression"}], ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"RepeatedRewrite", "[", 
        RowBox[{"t", ",", "RewriteParameter"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"RepeatedRewrite", "[", 
        RowBox[{"t", ",", " ", "RewritePowerAsTimes"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"t", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Mu]", "\[Rule]", "mu"}], ",", 
          RowBox[{"\[Theta]", "\[Rule]", "theta"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"t", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "batch", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "batch", "]"}]}], ",", 
          RowBox[{"z", "\[Rule]", 
           RowBox[{"z", "[", "batch", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"t", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Mu]", "\[Rule]", "mu"}], ",", 
            RowBox[{"\[Psi]", "\[Rule]", "Psi"}], ",", 
            RowBox[{"\[Phi]1", "\[Rule]", "Phi"}], ",", 
            RowBox[{"\[Chi]1", "\[Rule]", "Chi"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", "=", 
         RowBox[{"RepeatedRewrite", "[", 
          RowBox[{"t", ",", " ", "RewritePowerAsTimes"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", "=", 
         RowBox[{"RepeatedRewrite", "[", 
          RowBox[{"t", ",", " ", "RewriteDerivativeAsSymbol"}], " ", "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"t", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a_", "[", 
             RowBox[{"x", ",", "z"}], "]"}], ":>", "a"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", "=", 
         RowBox[{"t", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a_", "[", 
             RowBox[{"x", ",", "0"}], "]"}], ":>", "a"}], "}"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "need", " ", "it", " ", "for", " ", "boundary", " ", 
          "conditions"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"t", "=", 
         RowBox[{"t", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a_", "[", 
             RowBox[{"x", ",", "1"}], "]"}], ":>", "a"}], "}"}]}]}], ";"}], 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{"same", " ", "here"}], " ", "*)"}], "\[IndentingNewLine]", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"N", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"ExportString", "[", 
        RowBox[{"t", ",", " ", "\"\<Text\>\"", ",", " ", 
         RowBox[{"CharacterEncoding", "\[Rule]", "\"\<ASCII\>\""}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"t", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<(+)\>\"", "\[Rule]", "\"\<*\>\""}], ",", 
          RowBox[{"\"\<(x)\>\"", "\[Rule]", "\"\</\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<batch\>\"", "\[Rule]", "\"\<i...\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"\"\<Qzx\>\"", "\[Rule]", "\"\<Qxz\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "\"\<DxDxQtt\>\"", " ", "\[Rule]", "\"\<DDQ(0, 0, 0)\>\""}], ",", 
           RowBox[{
           "\"\<DxDzQtt\>\"", " ", "\[Rule]", "\"\<DDQ(0, 1, 0)\>\""}], ",", 
           RowBox[{
           "\"\<DzDzQtt\>\"", " ", "\[Rule]", "\"\<DDQ(1, 1, 0)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "\"\<DxDxQxx\>\"", " ", "\[Rule]", "\"\<DDQ(0, 0, 1)\>\""}], ",", 
           RowBox[{
           "\"\<DxDzQxx\>\"", " ", "\[Rule]", "\"\<DDQ(0, 1, 1)\>\""}], ",", 
           RowBox[{
           "\"\<DzDzQxx\>\"", " ", "\[Rule]", "\"\<DDQ(1, 1, 1)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "\"\<DxDxQyy\>\"", " ", "\[Rule]", "\"\<DDQ(0, 0, 2)\>\""}], ",", 
           RowBox[{
           "\"\<DxDzQyy\>\"", " ", "\[Rule]", "\"\<DDQ(0, 1, 2)\>\""}], ",", 
           RowBox[{
           "\"\<DzDzQyy\>\"", " ", "\[Rule]", "\"\<DDQ(1, 1, 2)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "\"\<DxDxQzz\>\"", " ", "\[Rule]", "\"\<DDQ(0, 0, 3)\>\""}], ",", 
           RowBox[{
           "\"\<DxDzQzz\>\"", " ", "\[Rule]", "\"\<DDQ(0, 1, 3)\>\""}], ",", 
           RowBox[{
           "\"\<DzDzQzz\>\"", " ", "\[Rule]", "\"\<DDQ(1, 1, 3)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "\"\<DxDxQxz\>\"", " ", "\[Rule]", "\"\<DDQ(0, 0, 4)\>\""}], ",", 
           RowBox[{
           "\"\<DxDzQxz\>\"", " ", "\[Rule]", "\"\<DDQ(0, 1, 4)\>\""}], ",", 
           RowBox[{
           "\"\<DzDzQxz\>\"", " ", "\[Rule]", "\"\<DDQ(1, 1, 4)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<DxQtt\>\"", " ", "\[Rule]", "\"\<DQ(0, 0)\>\""}], ",", 
           RowBox[{"\"\<DzQtt\>\"", " ", "\[Rule]", "\"\<DQ(1, 0)\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<DxQxx\>\"", " ", "\[Rule]", "\"\<DQ(0, 1)\>\""}], ",", 
           RowBox[{"\"\<DzQxx\>\"", " ", "\[Rule]", "\"\<DQ(1, 1)\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<DxQyy\>\"", " ", "\[Rule]", "\"\<DQ(0, 2)\>\""}], ",", 
           RowBox[{"\"\<DzQyy\>\"", " ", "\[Rule]", "\"\<DQ(1, 2)\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<DxQzz\>\"", " ", "\[Rule]", "\"\<DQ(0, 3)\>\""}], ",", 
           RowBox[{"\"\<DzQzz\>\"", " ", "\[Rule]", "\"\<DQ(1, 3)\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<DxQxz\>\"", " ", "\[Rule]", "\"\<DQ(0, 4)\>\""}], ",", 
           RowBox[{"\"\<DzQxz\>\"", " ", "\[Rule]", "\"\<DQ(1, 4)\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<Qtt\>\"", " ", "\[Rule]", " ", "\"\<Q(0)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<Qxx\>\"", " ", "\[Rule]", " ", "\"\<Q(1)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<Qyy\>\"", "\[Rule]", "\"\<Q(2)\>\""}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<Qzz\>\"", "\[Rule]", "\"\<Q(3)\>\""}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<Qxz\>\"", "\[Rule]", "\"\<Q(4)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<DxDxPsi\>\"", "\[Rule]", "\"\<DDPsi(0, 0)\>\""}], ",", 
           RowBox[{"\"\<DxDzPsi\>\"", "\[Rule]", "\"\<DDPsi(0, 1)\>\""}], ",", 
           RowBox[{"\"\<DzDzPsi\>\"", "\[Rule]", "\"\<DDPsi(1, 1)\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<DxPsi\>\"", "\[Rule]", "\"\<DPsi(0)\>\""}], ",", 
           RowBox[{"\"\<DzPsi\>\"", "\[Rule]", "\"\<DPsi(1)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<DxDxPhi\>\"", "\[Rule]", "\"\<DDPhi(0, 0)\>\""}], ",", 
           RowBox[{"\"\<DxDzPhi\>\"", "\[Rule]", "\"\<DDPhi(0, 1)\>\""}], ",", 
           RowBox[{"\"\<DzDzPhi\>\"", "\[Rule]", "\"\<DDPhi(1, 1)\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<DxPhi\>\"", "\[Rule]", "\"\<DPhi(0)\>\""}], ",", 
           RowBox[{"\"\<DzPhi\>\"", "\[Rule]", "\"\<DPhi(1)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<DxDxChi\>\"", "\[Rule]", "\"\<DDChi(0, 0)\>\""}], ",", 
           RowBox[{"\"\<DxDzChi\>\"", "\[Rule]", "\"\<DDChi(0, 1)\>\""}], ",", 
           RowBox[{"\"\<DzDzChi\>\"", "\[Rule]", "\"\<DDChi(1, 1)\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<DxChi\>\"", "\[Rule]", "\"\<DChi(0)\>\""}], ",", 
           RowBox[{"\"\<DzChi\>\"", "\[Rule]", "\"\<DChi(1)\>\""}]}], "*)"}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.828078551724134*^9, 3.828078831942458*^9}, {
   3.8280789088089037`*^9, 3.828078933093917*^9}, {3.82808134796189*^9, 
   3.828081384516323*^9}, {3.828085660370358*^9, 3.828085700107809*^9}, {
   3.828161354911045*^9, 3.828161355437777*^9}, {3.828261739637829*^9, 
   3.828261765548306*^9}, {3.828262128309931*^9, 3.828262331835957*^9}, 
   3.828262429480674*^9, {3.828262588518721*^9, 3.8282626200139027`*^9}, {
   3.8282626606646557`*^9, 3.828262663624659*^9}, {3.8282628227151213`*^9, 
   3.828262896966982*^9}, {3.828262975559058*^9, 3.8282630050746727`*^9}, {
   3.830236011090125*^9, 3.830236094487639*^9}, {3.830236139727908*^9, 
   3.830236202803403*^9}, {3.830236828087522*^9, 3.830236830417902*^9}, {
   3.8302727508636227`*^9, 3.830272753618537*^9}, {3.830272791256014*^9, 
   3.830272793066409*^9}, {3.830272858872821*^9, 3.83027290807828*^9}, {
   3.8302753865296507`*^9, 3.8302754120686407`*^9}, {3.830315137301174*^9, 
   3.830315141402884*^9}, {3.830315234827615*^9, 3.83031523520297*^9}, {
   3.830315270389677*^9, 3.830315294847681*^9}, {3.830315480325248*^9, 
   3.830315480600892*^9}, {3.830315608206211*^9, 3.830315655017877*^9}, {
   3.830316215100642*^9, 3.830316217006412*^9}, {3.8303530468777237`*^9, 
   3.83035305491014*^9}, {3.830949345736369*^9, 3.830949426609803*^9}, {
   3.8309499553704777`*^9, 3.830949971371045*^9}, {3.8309500219993887`*^9, 
   3.830950034697122*^9}, {3.830953713699684*^9, 3.830953733066649*^9}, {
   3.830954122958267*^9, 3.830954196449916*^9}, {3.831105882728055*^9, 
   3.831105893935005*^9}, {3.8311059666433496`*^9, 3.831105974969255*^9}, {
   3.831108470853485*^9, 3.831108471823769*^9}, {3.8691408163784113`*^9, 
   3.8691408238977423`*^9}, {3.869141553724766*^9, 3.869141564448081*^9}, {
   3.869204611755788*^9, 3.8692046199911413`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"afe87b07-8539-4dd6-ac72-d95d6ac48b5d"],

Cell[CellGroupData[{

Cell["For example:", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8280790188779993`*^9, 3.828079026774913*^9}, 
   3.828080272212541*^9},ExpressionUUID->"1db507cb-9d2e-4ae9-8f09-\
dc276f5f7b6a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"PrepareForHalide", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"g`UU", ",", " ", "z"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", " ", "2"}], "]"}], "]"}], "]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.828078874595212*^9, 3.828078900508808*^9}, 
   3.82808027221292*^9, {3.830954404772685*^9, 3.830954409961029*^9}, {
   3.8502992220014153`*^9, 3.8502992431390343`*^9}, 3.869204577621736*^9},
 CellLabel->
  "In[1389]:=",ExpressionUUID->"f9c35832-1302-4069-8d7a-441b371aef64"],

Cell[BoxData["\<\"-0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * \
L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * \
mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...)) - 0.5*(z(i...) * z(i...) * \
z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. + 3.*(mu * \
mu)*(z(i...) * z(i...)) - 4.*z(i...))*(-1. + z(i...)) - 0.5*(z(i...) * \
z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*DQ(i..., 3, 4)*(-2. \
- 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - \
2.*z(i...))*(-1. + z(i...)) - 2.*(z(i...) * z(i...) * z(i...))*1. / (L * \
L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * \
mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)) + \
0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * \
Q(i..., 3))*DQ(i..., 3, 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * \
mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...))\"\>"], \
"Output",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.828078885417366*^9, 3.828078938106134*^9}, 
   3.8280790300611687`*^9, 3.828080272238887*^9, {3.828081366656562*^9, 
   3.828081388564617*^9}, 3.8303505480370083`*^9, 3.83035060475249*^9, 
   3.8303508131734953`*^9, 3.8309494383694553`*^9, 3.830949801587433*^9, 
   3.83094993860569*^9, 3.830949977265361*^9, {3.83095003136388*^9, 
   3.830950038964781*^9}, {3.830954150232853*^9, 3.830954177666792*^9}, 
   3.83095437588727*^9, 3.8309544106842747`*^9, 3.8311056028662977`*^9, 
   3.831105910059342*^9, 3.831105982008849*^9, 3.850297884305945*^9, 
   3.850298794646124*^9, 3.850299244710994*^9, 3.868686556517385*^9, 
   3.868686665770034*^9, 3.86914171157036*^9, 3.8692045807201014`*^9},
 CellLabel->
  "Out[1389]=",ExpressionUUID->"e71d97dd-beca-4afe-8616-33198d222c37"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "RewriteElementAsMacro", ",", " ", "RewriteScalarAsMacro", ",", 
    "RewriteTensorAsMacros"}], "]"}], ";", 
  RowBox[{
   RowBox[{"RewriteElementAsMacro", "[", 
    RowBox[{"name_", ",", " ", "indices_", ",", "expression_"}], "]"}], " ", ":=",
    " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StringTemplate", "[", "\"\<    ``(i..., ``) = ``\>\"", "]"}], 
    "[", 
    RowBox[{"name", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"ToString", " ", "/@", 
         RowBox[{"(", 
          RowBox[{"indices", "-", "1"}], ")"}]}], ",", " ", "\"\<, \>\""}], 
       "]"}], "]"}], ",", 
     RowBox[{"PrepareForHalide", "[", "expression", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteScalarAsMacro", "[", 
    RowBox[{"name_", ",", " ", "expression_"}], "]"}], " ", ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
   "\"\<#define FROM_EXPRESSIONS_\>\"", " ", "<>", "name", " ", "<>", " ", 
    "\"\<(dEsTiNaTiOn) \\\\\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<    dEsTiNaTiOn(i...) = \>\"", "<>", 
    RowBox[{"PrepareForHalide", "[", "expression", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RewriteTensorAsMacros", "[", 
    RowBox[{"name_", ",", " ", "expression_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"indices", ",", " ", "strings"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indices", " ", "=", " ", 
       RowBox[{
        RowBox[{"SparseArray", "[", "expression", "]"}], "[", 
        "\"\<NonzeroPositions\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"strings", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RewriteElementAsMacro", "[", 
          RowBox[{"\"\<dEsTiNaTiOn\>\"", ",", " ", "#", ",", " ", 
           RowBox[{"Part", "[", 
            RowBox[{"expression", ",", 
             RowBox[{"Sequence", "@@", "#"}]}], "]"}]}], "]"}], "&"}], " ", "/@",
         " ", "indices"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<#define FROM_EXPRESSIONS_\>\"", " ", "<>", "name", " ", "<>", " ", 
       "\"\<(dEsTiNaTiOn) \\\\\\n\>\"", "<>", "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{"strings", ",", "\"\<; \\\\\\n\>\""}], "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.828079993916347*^9, 3.828080131852626*^9}, {
  3.830236630866612*^9, 3.830236782051498*^9}, {3.830236891043241*^9, 
  3.8302369300077143`*^9}, {3.83110605002639*^9, 3.831106053112381*^9}, {
  3.831106775140788*^9, 3.8311067813280478`*^9}, {3.831108455704451*^9, 
  3.831108462838484*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"ae09e6c6-a6f6-4f3a-916e-5bacdcb12b76"],

Cell[CellGroupData[{

Cell["For example:", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.828080230309638*^9, 
  3.828080254267577*^9}},ExpressionUUID->"0c08c246-7023-4f53-be28-\
9714c85eed87"],

Cell[BoxData[
 RowBox[{"RewriteTensorAsMacros", "[", 
  RowBox[{"\"\<g_dd\>\"", ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"g`dd", ",", " ", "#"}], "]"}], "&"}], " ", "/@", "Coord"}]}], 
  "]"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8280801619739323`*^9, 3.82808019405278*^9}, 
   3.8280802542682533`*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"2c0a2e07-ce6e-4a29-8c7d-b114bbd836cd"],

Cell[BoxData["\<\"#define FROM_EXPRESSIONS_g_dd(dEsTiNaTiOn) \\\\\\n    \
dEsTiNaTiOn(i..., 1, 0, 0) = (L * L)*1. / (z(i...) * z(i...))*DQ(i..., 1, \
0)*(-1. + z(i...))*(1. + z(i...) * z(i...) - 0.5*(mu * mu)*(z(i...) * z(i...) \
* z(i...)) + z(i...)); \\\\\\n    dEsTiNaTiOn(i..., 1, 1, 1) = (L * L)*1. / \
(z(i...) * z(i...))*DQ(i..., 1, 1); \\\\\\n    dEsTiNaTiOn(i..., 1, 1, 3) = \
(L * L)*DQ(i..., 1, 4)*Q(i..., 1) + (L * L)*DQ(i..., 1, 1)*Q(i..., 4); \
\\\\\\n    dEsTiNaTiOn(i..., 1, 2, 2) = (L * L)*1. / (z(i...) * \
z(i...))*DQ(i..., 1, 2); \\\\\\n    dEsTiNaTiOn(i..., 1, 3, 1) = (L * \
L)*DQ(i..., 1, 4)*Q(i..., 1) + (L * L)*DQ(i..., 1, 1)*Q(i..., 4); \\\\\\n    \
dEsTiNaTiOn(i..., 1, 3, 3) = (L * L)*1. / (z(i...) * z(i...))*((Q(i..., 4) * \
Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 1) + 2.*1. / \
(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * \
z(i...) * z(i...) * z(i...)))*DQ(i..., 1, 3) + 2.*(z(i...) * z(i...) * \
z(i...) * z(i...))*DQ(i..., 1, 4)*Q(i..., 1)*Q(i..., 4)); \\\\\\n    \
dEsTiNaTiOn(i..., 3, 0, 0) = (L * L)*1. / (z(i...) * z(i...))*Q(i..., 0)*(1. \
+ z(i...) * z(i...) - 0.5*(mu * mu)*(z(i...) * z(i...) * z(i...)) + z(i...)) \
+ (L * L)*1. / (z(i...) * z(i...))*DQ(i..., 3, 0)*(-1. + z(i...))*(1. + \
z(i...) * z(i...) - 0.5*(mu * mu)*(z(i...) * z(i...) * z(i...)) + z(i...)) - \
2.*(L * L)*1. / (z(i...) * z(i...) * z(i...))*Q(i..., 0)*(-1. + z(i...))*(1. \
+ z(i...) * z(i...) - 0.5*(mu * mu)*(z(i...) * z(i...) * z(i...)) + z(i...)) \
+ (L * L)*1. / (z(i...) * z(i...))*Q(i..., 0)*(-1. + z(i...))*(1. - 1.5*(mu * \
mu)*(z(i...) * z(i...)) + 2.*z(i...)); \\\\\\n    dEsTiNaTiOn(i..., 3, 1, 1) \
= (L * L)*1. / (z(i...) * z(i...))*DQ(i..., 3, 1) - 2.*(L * L)*1. / (z(i...) \
* z(i...) * z(i...))*Q(i..., 1); \\\\\\n    dEsTiNaTiOn(i..., 3, 1, 3) = (L * \
L)*DQ(i..., 3, 4)*Q(i..., 1) + (L * L)*DQ(i..., 3, 1)*Q(i..., 4); \\\\\\n    \
dEsTiNaTiOn(i..., 3, 2, 2) = (L * L)*1. / (z(i...) * z(i...))*DQ(i..., 3, 2) \
- 2.*(L * L)*1. / (z(i...) * z(i...) * z(i...))*Q(i..., 2); \\\\\\n    \
dEsTiNaTiOn(i..., 3, 3, 1) = (L * L)*DQ(i..., 3, 4)*Q(i..., 1) + (L * \
L)*DQ(i..., 3, 1)*Q(i..., 4); \\\\\\n    dEsTiNaTiOn(i..., 3, 3, 3) = -2.*(L \
* L)*1. / (z(i...) * z(i...) * z(i...))*((Q(i..., 4) * Q(i..., 4))*(z(i...) * \
z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*1. / (2. - 1.*(2. + mu * \
mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * \
z(i...)))*Q(i..., 3)) + (L * L)*1. / (z(i...) * z(i...))*((Q(i..., 4) * \
Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 1) + 2.*1. / \
(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * \
z(i...) * z(i...) * z(i...)))*DQ(i..., 3, 3) + 4.*(Q(i..., 4) * Q(i..., \
4))*(z(i...) * z(i...) * z(i...))*Q(i..., 1) - 2.*(-3.*(2. + mu * \
mu)*(z(i...) * z(i...)) + 4.*(mu * mu)*(z(i...) * z(i...) * z(i...)))*1. / \
((2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * \
z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * \
z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))))*Q(i..., 3) + \
2.*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 4)*Q(i..., 1)*Q(i..., \
4))\"\>"], "Output",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.82808015330737*^9, 3.82808019522569*^9}, 
   3.8280802542893047`*^9, 3.8303505481054573`*^9, 3.8303506048137417`*^9, 
   3.830350813226472*^9, 3.8311056031852503`*^9, 3.831105954538642*^9, 
   3.83110599025121*^9, 3.831108481300623*^9, 3.868686571821685*^9, 
   3.8686866734617577`*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"76a4828b-d183-43ce-a789-5d2f559e06c5"]
}, Closed]],

Cell[TextData[StyleBox["Equations of motion", "Section"]], "Text",
 CellChangeTimes->{{3.830276231144121*^9, 3.830276234897141*^9}, {
  3.830276658864457*^9, 
  3.8302766630423927`*^9}},ExpressionUUID->"4db71845-e93b-4134-b38a-\
d522f28c30e9"],

Cell["Now we are ready to define the equations.", "Text",
 CellChangeTimes->{{3.830275479850546*^9, 
  3.8302755101482553`*^9}},ExpressionUUID->"7b7b55e8-95a8-481a-bfd6-\
cd70cd635216"],

Cell[TextData[StyleBox["Maxwell\[CloseCurlyQuote]s equations", \
"Subsection"]], "Text",
 CellChangeTimes->{{3.830276252935956*^9, 
  3.830276263110774*^9}},ExpressionUUID->"004938ca-d89f-4158-8a1c-\
b7a2531fdbf5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Psi]", ",", "A`d", ",", "F`dd", ",", "F`Ud", ",", "F`UU"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A`d", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z"}], ")"}], 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"x", ",", "z"}], "]"}]}], ",", "0", ",", "0", ",", "0"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F`dd", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "#", "]"}], "-", "#"}], "&"}], ")"}], "@", 
     " ", 
     RowBox[{"covD", "[", "A`d", "]"}]}], " ", "//", " ", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F`Ud", "=", 
   RowBox[{
    RowBox[{"Raise", "[", 
     RowBox[{"F`dd", ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F`UU", "=", 
   RowBox[{"Raise", "[", 
    RowBox[{"F`Ud", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.828261689219561*^9, 3.8282616911364183`*^9}, {
  3.828262096319706*^9, 3.828262106699448*^9}, {3.828262496922913*^9, 
  3.828262547353429*^9}, {3.828262642693409*^9, 3.828262648728138*^9}, {
  3.828262683845818*^9, 3.8282626982048798`*^9}, {3.828262763807123*^9, 
  3.8282627850188*^9}, {3.828263016749161*^9, 3.828263017254506*^9}, {
  3.8302755186591988`*^9, 3.830275581871599*^9}, {3.8302757696698647`*^9, 
  3.8302757732061777`*^9}, {3.8302760401739883`*^9, 3.830276043306817*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"a01dcdc6-af6e-41f9-a6e1-36188aa055b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F`dd", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.829974103133844*^9, 3.829974115288587*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"1e2e2e7b-e283-4699-8e25-019b2d1bbafb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Psi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "z"}], "]"}]}], "0", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"x", ",", "z"}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Psi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "z"}], "]"}]}]}]},
     {
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Psi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "z"}], "]"}]}], ")"}]}], "0", "0", "0"},
     {"0", "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"x", ",", "z"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Psi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "z"}], "]"}]}]}], "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.829974116066576*^9, 3.830275552876672*^9, 
  3.830350548190755*^9, 3.83035060489207*^9, 3.830350813306776*^9, 
  3.831105603283231*^9, 3.8686865970250273`*^9, 3.868686680462605*^9, 
  3.869241074351201*^9},
 CellLabel->
  "Out[143]//MatrixForm=",ExpressionUUID->"c173acb0-ead1-4a84-ab71-\
8d64fd61253d"]
}, Open  ]],

Cell["And the equation of motion itself:", "Text",
 CellChangeTimes->{{3.8302757921578712`*^9, 3.830275797864265*^9}, {
  3.830276402136585*^9, 
  3.830276427649152*^9}},ExpressionUUID->"11fae75a-0849-49de-a791-\
c03cd01b1a27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"divF`d", ",", "EOM`\[Psi]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divF`d", "=", 
   RowBox[{
    RowBox[{"covDiv", "[", 
     RowBox[{"F`Ud", ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOM`\[Psi]", "=", 
   RowBox[{"divF`d", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830275752666129*^9, 3.830275756627779*^9}, {
  3.830276065277686*^9, 3.8302760661326513`*^9}, {3.830276564348415*^9, 
  3.8302765752717857`*^9}, {3.830278486575066*^9, 3.830278513941749*^9}, {
  3.869064711142881*^9, 3.869064712172462*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"ee5f8696-9c85-4d29-aa8c-ed9d09c47cdd"],

Cell["Note that only one component is non-zero:", "Text",
 CellChangeTimes->{{3.83027599298717*^9, 
  3.8302760029791813`*^9}},ExpressionUUID->"e0cfbb32-3662-44f7-931b-\
c7f2cdd9313d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SparseArray", "[", "divF`d", "]"}], "[", 
  "\"\<NonzeroPositions\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.830275950062834*^9, 3.8302759841737423`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"9b5d2438-37b0-4af2-a7f8-d19fbd2da0b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.830275965925424*^9, 3.8302759846335917`*^9}, 
   3.8303505492755327`*^9, 3.830350606191071*^9, 3.8303508148943777`*^9, 
   3.831105604480365*^9, 3.868686747669594*^9, 3.869241081409528*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"ea73180c-e2fc-4663-9370-e171b5ed207f"]
}, Open  ]],

Cell[TextData[StyleBox["Scalar fields", "Subsection"]], "Text",
 CellChangeTimes->{{3.830276026769773*^9, 3.830276031621524*^9}, 
   3.830276434412717*^9},ExpressionUUID->"5e31d897-1e12-442a-a244-\
9843ea9aa863"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[Phi]", ",", "\[Phi]1", ",", "\[Chi]", ",", "\[Chi]1", ",", "V", ",", 
    "waveEquation"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"z", "*", 
    RowBox[{"\[Phi]1", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]", "=", 
   RowBox[{"z", "*", 
    RowBox[{"\[Chi]1", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Phi]", "^", "2"}], "+", 
       RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}], "/", 
    RowBox[{"L", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DV`\[Phi]", "=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"\[Phi]", "/", 
     RowBox[{"L", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DV`\[Chi]", "=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"\[Chi]", "/", 
     RowBox[{"L", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOM`\[Phi]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"covDiv", "[", 
      RowBox[{
       RowBox[{"Raise", "[", 
        RowBox[{
         RowBox[{"covD", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], "-", "DV`\[Phi]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOM`\[Chi]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"covDiv", "[", 
      RowBox[{
       RowBox[{"Raise", "[", 
        RowBox[{
         RowBox[{"covD", "[", "\[Chi]", "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], "-", "DV`\[Chi]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQfSXhwAWFzjeOCk6rboDoB89146cDacFZmakgmu3/
7ywQPeGnSSWIflKRXAui3W4nt4PoZO45c2cA6cvra5aA6PdXP6wG0W4tCmtA
tEGdtt1cIC3WGeUAome5CmSC6AcGT8D0xRch+muA9DM5cXMQfUAwxvIIkJ4k
rmwFomVtZNNBdLbl0iwQHWl8Ih9E/wjrKwLRFvsTy0C0xB7WChA9d5f4mvNA
etHD5PUg2ufoqe0g+pVuxy4Q3XDFcx+IZqnYAaYdWitvg+gPFR6PQfS6ter/
LgPpaPb5LFeAtN2ralkQ/XtfggKILvH/Fg2i03mmZoFoAORUr6Y=
  "],
 CellLabel->
  "In[148]:=",ExpressionUUID->"61a297c0-88f6-43cd-990d-778a76639fda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"foo", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</home/tom/src/fermions-on-stripes/equations/test.dat\>\"", ",", 
     "\"\<String\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.869242985056641*^9, 3.869243011472814*^9}, {
  3.869243344428218*^9, 3.8692433782521753`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"f87aa852-1e00-49b7-bf1a-da44b51ce6e2"],

Cell[BoxData["foo"], "Input",
 CellChangeTimes->{{3.8692430005071087`*^9, 3.869243001192492*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"4c4f9e06-2116-411a-a4a8-8f93ffdf5a1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"askar", "=", 
   RowBox[{
   "<<", "\"\</home/tom/src/fermions-on-stripes/equations/test.dat\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8692400815565567`*^9, 3.8692401107602797`*^9}, {
  3.8692401440873413`*^9, 3.869240194859768*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"b5679054-f6b9-4ee1-a6e4-514a5b53ba87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"G`dd", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.869241200729117*^9, 3.869241216651215*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"4e477c4e-ef80-4b84-9443-d53b7e3c9463"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"16", " ", 
    SuperscriptBox["z", "2"]}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "-", 
        RowBox[{"2", " ", "z"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["z", "3"], " ", 
         SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
      RowBox[{"Qtt", "[", 
       RowBox[{"x", ",", "z"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        RowBox[{
         SuperscriptBox["z", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Phi]1", "[", 
           RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox["z", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Chi]1", "[", 
           RowBox[{"x", ",", "z"}], "]"}], "2"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "z"}], "]"}], " ", 
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "z"}], "]"}]}]], 
      RowBox[{"4", " ", 
       SuperscriptBox["z", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "z"}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Psi]", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "-", 
            RowBox[{"2", " ", "z"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["z", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["z", "3"], " ", 
             SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
          RowBox[{"Qxx", "[", 
           RowBox[{"x", ",", "z"}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Psi]", "[", 
              RowBox[{"x", ",", "z"}], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[Psi]", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "-", 
                RowBox[{
                 SuperscriptBox["z", "2"], " ", 
                 RowBox[{"Qxz", "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{
                  SuperscriptBox["\[Psi]", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}]}], ")"}], 
           "2"]}]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "-", 
          RowBox[{"2", " ", "z"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["z", "3"], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           RowBox[{"Qyy", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox["Qtt", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"x", ",", "z"}], "]"}], "2"]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "-", 
                RowBox[{"2", " ", "z"}], "-", 
                RowBox[{"2", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["z", "3"], " ", 
                 SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
              RowBox[{"Qxx", "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["Qtt", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"x", ",", "z"}], "]"}], "-", 
                 RowBox[{
                  SuperscriptBox["z", "2"], " ", 
                  RowBox[{"Qxz", "[", 
                   RowBox[{"x", ",", "z"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], "2"]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Qtt", "[", 
             RowBox[{"x", ",", "z"}], "]"}], "2"], " ", 
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "4"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["z", "4"], " ", 
                 SuperscriptBox["\[Mu]", "2"]}], "-", 
                RowBox[{
                 SuperscriptBox["z", "3"], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
              RowBox[{"Qyy", "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["Qxx", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "-", 
                RowBox[{
                 SuperscriptBox["z", "2"], " ", 
                 RowBox[{"Qxz", "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{
                  SuperscriptBox["Qxx", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"Qxx", "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "4"}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "-", 
                   RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                 RowBox[{"Qzz", "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["Qyy", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], "-", 
                   RowBox[{
                    SuperscriptBox["z", "2"], " ", 
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qyy", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"Qyy", "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Qzz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{"6", "+", 
                    RowBox[{
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"8", " ", 
                    SuperscriptBox["z", "3"]}], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["z", "7"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["z", "6"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], "+", 
                   RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "-", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    SuperscriptBox["Qzz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "2"], " ", 
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qzz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}], "+", 
          RowBox[{"z", " ", 
           RowBox[{"Qtt", "[", 
            RowBox[{"x", ",", "z"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "z", " ", 
              RowBox[{"Qyy", "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Qzz", "[", 
                RowBox[{"x", ",", "z"}], "]"}], "2"], " ", 
              RowBox[{
               SuperscriptBox["Qtt", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["Qxx", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "z"}], "]"}]}], "+", 
             RowBox[{"z", " ", 
              RowBox[{"Qxx", "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "z"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"Qzz", "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{
                  SuperscriptBox["Qtt", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{
                  SuperscriptBox["Qyy", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"Qyy", "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["z", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "-", 
                    RowBox[{
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxx", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["z", "4"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "-", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], "2"], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxx", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "-", 
                    RowBox[{"2", " ", "z"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["z", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["Qxx", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], "-", 
                    RowBox[{
                    SuperscriptBox["z", "2"], " ", 
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxx", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qzz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                   RowBox[{"4", " ", 
                    RowBox[{"Qzz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"2", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Qxx", "[", 
                RowBox[{"x", ",", "z"}], "]"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "-", 
                   RowBox[{"2", " ", "z"}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["z", "2"]}], "+", 
                   RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
                 RowBox[{"Qzz", "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], "-", 
                   RowBox[{
                    SuperscriptBox["z", "2"], " ", 
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["Qyy", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], "-", 
                   RowBox[{
                    SuperscriptBox["z", "2"], " ", 
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qyy", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"Qyy", "[", 
                  RowBox[{"x", ",", "z"}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "-", 
                    RowBox[{"2", " ", "z"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["z", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "2"], " ", 
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    SuperscriptBox["Qzz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "2"], " ", 
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qzz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"Qzz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{"12", "-", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "-", 
                    RowBox[{"2", " ", "z"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["z", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "-", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "2"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "-", 
                    RowBox[{
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "-", 
                    RowBox[{"10", " ", 
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "+", 
                    RowBox[{"7", " ", 
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}], "+", 
                    RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "-", 
                    RowBox[{"2", " ", "z"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["z", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"4", " ", "z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "-", 
                    RowBox[{
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{
                    SuperscriptBox["z", "4"], " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "-", 
                    RowBox[{
                    SuperscriptBox["z", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}]}]}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "z"}], "]"}], "2"], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"2", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "z"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Qxx", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "2"], " ", 
        RowBox[{"Qyy", "[", 
         RowBox[{"x", ",", "z"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Qzz", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "2"]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.869241205355645*^9, 3.869241219456628*^9}},
 CellLabel->
  "Out[172]=",ExpressionUUID->"910c1ef4-4360-45ee-8e08-72fc35747244"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"G`dd", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "4"}], "]"}], "]"}], "-", 
    RowBox[{"askar", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]"}], ",", 
     RowBox[{
      RowBox[{"M", "^", "2"}], "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"L", "^", "2"}]}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8692401824883966`*^9, 3.869240183261627*^9}, {
   3.8692402206293077`*^9, 3.8692404717836723`*^9}, {3.869240519742394*^9, 
   3.869240537451907*^9}, {3.8692411135562077`*^9, 3.86924111854622*^9}, {
   3.869241230867269*^9, 3.869241244155796*^9}, 3.8692413726841183`*^9, {
   3.869247105356823*^9, 3.869247120057481*^9}, {3.869247152454761*^9, 
   3.869247153355975*^9}, {3.869247263968214*^9, 3.8692472780761023`*^9}, {
   3.869247344436473*^9, 3.8692473645521393`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"4c4bbb7e-91d9-4842-af8c-45f03beacd8f"],

Cell[BoxData[
 RowBox[{"z", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     RowBox[{"Qxx", "[", 
      RowBox[{"x", ",", "z"}], "]"}], " ", 
     RowBox[{"Qxz", "[", 
      RowBox[{"x", ",", "z"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"\[Phi]2", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"\[Chi]1", "[", 
         RowBox[{"x", ",", "z"}], "]"}], "2"]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"\[Phi]2", "[", 
      RowBox[{"x", ",", "z"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "z"}], "]"}]}], "+", 
    RowBox[{"2", " ", "z", " ", 
     RowBox[{
      SuperscriptBox["\[Phi]2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "z"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Chi]1", "[", 
        RowBox[{"x", ",", "z"}], "]"}], "+", 
       RowBox[{"z", " ", 
        RowBox[{
         SuperscriptBox["\[Chi]1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[Chi]1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.869241119043168*^9, 3.86924124538361*^9, 3.869241373725237*^9, 
   3.869242555276039*^9, 3.869242833695795*^9, 3.869243448403707*^9, {
   3.869247111237569*^9, 3.869247120860488*^9}, 3.86924715432795*^9, 
   3.8692471988562717`*^9, {3.869247268776672*^9, 3.869247279686734*^9}, {
   3.869247359022777*^9, 3.869247365523225*^9}},
 CellLabel->
  "Out[209]=",ExpressionUUID->"f241a9c7-4054-44ea-a509-7b2ef6922232"]
}, Open  ]],

Cell[TextData[StyleBox["Einstein\[CloseCurlyQuote]s equations", \
"Subsection"]], "Text",
 CellChangeTimes->{{3.8302766421956882`*^9, 3.830276646310175*^9}, {
  3.8302766774997387`*^9, 
  3.8302766821461906`*^9}},ExpressionUUID->"957f88ae-3316-47de-8349-\
8f26afcbc887"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "cell", " ", "may", " ", "take", " ", "a", " ", "while", " ",
      "to", " ", "run"}], "..."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "conformalQ", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"conformalQ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qtt", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}], ",", 
       RowBox[{"Qzz", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}], ",", 
       RowBox[{"Qxx", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}], ",", 
       RowBox[{"Qyy", "->", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}], ",", 
       RowBox[{"Qxz", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"0", "&"}], ")"}]}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[CapitalGamma]`Udd`Ref", "=", 
     RowBox[{
      RowBox[{"\[CapitalGamma]`Udd", "/.", "conformalQ"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dg`ddd", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"g`dd", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], "//", 
      "Simplify"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DDg`dddd", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Dg`ddd", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]`U", "=", 
     RowBox[{"multiDot", " ", "[", 
      RowBox[{"g`UU", ",", 
       RowBox[{"(", 
        RowBox[{"\[CapitalGamma]`Udd", "-", "\[CapitalGamma]`Udd`Ref"}], 
        ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]`d", "=", 
     RowBox[{"Lower", "[", 
      RowBox[{"\[Xi]`U", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D\[Xi]`dU", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"\[Xi]`U", ",", " ", "#"}], "]"}], "&"}], "/@", "Coord"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"div\[Xi]`dd", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "#", "]"}], "+", "#"}], ")"}], "/", 
         "2"}], "&"}], "@", 
       RowBox[{"covD", "[", "\[Xi]`d", "]"}]}], "//", "Simplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.830276751484325*^9, 3.830276880652156*^9}, {
  3.83027728117878*^9, 3.830277296570546*^9}, {3.8302773772188597`*^9, 
  3.8302773915149813`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"353a4442-c6fe-4a7f-8e02-6cd3c7d629ed"],

Cell["And the equations themselves:", "Text",
 CellChangeTimes->{{3.830277091849903*^9, 
  3.8302770984707317`*^9}},ExpressionUUID->"04de0dbb-5b91-462b-a8b8-\
cde93be7d4bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"G`dd", ",", "EOM`Q"}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "why", " ", "do", " ", "we", " ", "need", " ", "a", " ", "coefficient", 
     " ", "2", " ", "before", " ", 
     RowBox[{"Outer", "?", "\[IndentingNewLine]", "why"}], " ", "do", " ", 
     "we", " ", "have", " ", "to", " ", "set", " ", 
     RowBox[{"M", "^", "2"}]}], "=", 
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"L", "^", "2"}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G`dd", "=", 
   RowBox[{"R`dd", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "/", 
        RowBox[{"L", "^", "2"}]}], "-", "V"}], ")"}], "*", "gdd"}], "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"covD", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"covD", "[", "\[Phi]", "]"}]}], "]"}], "+", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"covD", "[", "\[Chi]", "]"}], ",", 
         RowBox[{"covD", "[", "\[Chi]", "]"}]}], "]"}]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"multiDot", "[", 
       RowBox[{"F`dd", ",", 
        RowBox[{"Raise", "[", 
         RowBox[{"F`dd", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "-", 
      RowBox[{
       RowBox[{"gdd", "/", "4"}], "*", 
       RowBox[{"multiDot", "[", 
        RowBox[{"F`dd", ",", "F`UU", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOM`Q", "=", 
   RowBox[{"G`dd", "-", "div\[Xi]`dd"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830277111351478*^9, 3.830277154132721*^9}, 
   3.83027720969672*^9, {3.830277311343466*^9, 3.8302773653413057`*^9}, 
   3.830277407100472*^9, 3.830350576427421*^9, {3.830358129121724*^9, 
   3.830358142416656*^9}, {3.830358881458119*^9, 3.8303588909796886`*^9}, {
   3.869242549648054*^9, 3.869242570947419*^9}, {3.869242826807502*^9, 
   3.8692428276431723`*^9}, 3.869247194733203*^9, {3.8692474143550262`*^9, 
   3.869247444640826*^9}},ExpressionUUID->"10834676-b990-411d-8ea3-\
bbfb174632a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SparseArray", "[", "EOM`Q", "]"}], "[", "\"\<NonzeroPositions\>\"",
   "]"}]], "Input",
 CellChangeTimes->{{3.8309623691186113`*^9, 3.830962370494824*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"06e0ff92-af5a-4f56-a3b4-680f71af3201"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.83096237122864*^9, 3.8310033204601707`*^9, 
  3.831105663489959*^9, 3.868686838081358*^9, 3.869240590322359*^9, 
  3.8692411940003653`*^9},
 CellLabel->
  "Out[170]=",ExpressionUUID->"b8113cf4-9375-4605-938b-633812df37ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"covD", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"covD", "[", "\[Phi]", "]"}]}], "]"}], "+", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"covD", "[", "\[Chi]", "]"}], ",", 
     RowBox[{"covD", "[", "\[Chi]", "]"}]}], "]"}]}], ")"}]], "Input",
 CellLabel->
  "In[179]:=",ExpressionUUID->"9625caad-fe09-464a-8ad2-30bb826d05c5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "2"], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Phi]1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "z"}], "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["z", "2"], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Chi]1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "z"}], "]"}], "2"]}]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"z", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Phi]1", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "+", 
         RowBox[{"z", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "z"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Chi]1", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "+", 
         RowBox[{"z", " ", 
          RowBox[{
           SuperscriptBox["\[Chi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Chi]1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "z"}], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"z", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Phi]1", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "+", 
         RowBox[{"z", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "z"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Chi]1", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "+", 
         RowBox[{"z", " ", 
          RowBox[{
           SuperscriptBox["\[Chi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Chi]1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "z"}], "]"}]}]}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Phi]1", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "+", 
         RowBox[{"z", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Chi]1", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "+", 
         RowBox[{"z", " ", 
          RowBox[{
           SuperscriptBox["\[Chi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "z"}], "]"}]}]}], ")"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8692425795466347`*^9},
 CellLabel->
  "Out[179]=",ExpressionUUID->"18e8eafb-d082-4ea8-8b76-991892953473"]
}, Open  ]],

Cell[TextData[StyleBox["Boundary conditions", "Section"]], "Text",
 CellChangeTimes->{{3.8302774688319893`*^9, 
  3.830277471444171*^9}},ExpressionUUID->"46893bda-27a2-4290-92b1-\
b757928f0114"],

Cell[TextData[StyleBox["Conformal boundary", "Subsection"]], "Text",
 CellChangeTimes->{{3.830277483216424*^9, 
  3.830277486052021*^9}},ExpressionUUID->"7093105a-4623-4c0c-ac24-\
434d67acee16"],

Cell[TextData[{
 "I.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "\[Rule]", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8d8e475e-8489-4ba0-8fb1-c18115887ee2"]
}], "Text",
 CellChangeTimes->{{3.8302775042204447`*^9, 
  3.8302775458484707`*^9}},ExpressionUUID->"1cd1a550-395d-4c75-9e0a-\
3baf0afdba1f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"V0", ",", "k0", ",", "\[Theta]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"conformalBoundaries", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Qtt", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"Qxx", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"Qyy", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"Qzz", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"Qxz", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"\[Psi]", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "\[Mu]"}], ",", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", "V0", "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", "*", "x"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"\[Chi]1", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", "V0", "*", 
      RowBox[{"Sin", "[", 
       RowBox[{"k0", "*", "x"}], "]"}]}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8302775829605837`*^9, 3.830277690996106*^9}, {
  3.830277734850432*^9, 3.8302779165473213`*^9}, {3.8303144629295683`*^9, 
  3.830314469251274*^9}, {3.869059801791753*^9, 3.869059814329281*^9}, {
  3.869231171061846*^9, 3.8692311712809687`*^9}, {3.869238080320668*^9, 
  3.869238080692321*^9}},
 CellLabel->
  "In[1430]:=",ExpressionUUID->"51c2ebe4-fb78-4efd-baf4-a2a606edd95d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Qtt", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"Qxx", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"Qyy", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"Qzz", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"Qxz", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Psi]", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", "\[Mu]"}], ",", 
   RowBox[{
    RowBox[{"\[Phi]1", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", 
    RowBox[{"V0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", " ", "x"}], "]"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Chi]1", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "\[Rule]", 
    RowBox[{"V0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"k0", " ", "x"}], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.830277822933649*^9, 3.830277863325498*^9, 
  3.830277917170635*^9, 3.830350674786413*^9, 3.830350895566889*^9, 
  3.8309523767001*^9, 3.831105663533105*^9, 3.868686844006054*^9, 
  3.869059816379738*^9, 3.8692311803957663`*^9, 3.869238081562312*^9},
 CellLabel->
  "Out[1431]=",ExpressionUUID->"88e89d1e-5183-45e6-9be9-96723769fc32"]
}, Open  ]],

Cell[TextData[StyleBox["Horizon", "Subsection"]], "Text",
 CellChangeTimes->{{3.8302780485737543`*^9, 
  3.8302780499113827`*^9}},ExpressionUUID->"40851352-1028-4a3d-9ff0-\
60982f7d38cb"],

Cell[TextData[{
 "I.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "\[Rule]", "1"}], TraditionalForm]],ExpressionUUID->
  "1d3ce91a-b6fb-496d-b976-ab593c03e823"],
 "\nThe following function computes the smallest power present in the series \
expansion:"
}], "Text",
 CellChangeTimes->{{3.830278102422536*^9, 3.830278123327701*^9}, {
  3.830314172594565*^9, 
  3.830314205100875*^9}},ExpressionUUID->"6de7e417-501d-4019-a537-\
0950c7be225b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "GetSmallestPower", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetSmallestPower", "[", "x_SeriesData", "]"}], ":=", 
   RowBox[{"List", "@@", 
    RowBox[{"x", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[1437]:=",ExpressionUUID->"b4c5290b-65a2-4b9d-b1de-081c646ce0d3"],

Cell[CellGroupData[{

Cell["For example:", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.830278160205752*^9, 3.8302781706075*^9}, 
   3.830278217320513*^9},ExpressionUUID->"4079727f-7d35-4d5b-b1ef-\
8be1c826a89f"],

Cell[BoxData[{
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"x", ",", "z"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", "z"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "1", ",", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"GetSmallestPower", "[", "%", "]"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.830278173596655*^9, 3.830278217320862*^9}},
 CellLabel->
  "In[1439]:=",ExpressionUUID->"278143b6-7153-4db3-82d3-9d99a73684f2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "1"}], "]"}], 
     RowBox[{"z", "-", "1"}]]}], "-", 
   RowBox[{
    SuperscriptBox["f", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "1"}], "]"}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{
     SuperscriptBox["f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "1"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"z", "-", "1"}], ")"}]}], "-", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{
     SuperscriptBox["f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "3"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "1"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}], "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"z", "-", "1"}], "]"}], "3"],
    SeriesData[$CellContext`z, 1, {}, -1, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`z, 
   1, {-$CellContext`f[$CellContext`x, 1], -
    Derivative[0, 1][$CellContext`f][$CellContext`x, 1], Rational[-1, 2] 
    Derivative[0, 2][$CellContext`f][$CellContext`x, 1], Rational[-1, 6] 
    Derivative[0, 3][$CellContext`f][$CellContext`x, 1]}, -1, 3, 1],
  Editable->False]], "Output",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.830278181446301*^9, 3.830278217321067*^9}, 
   3.830350674814992*^9, 3.8303508955865993`*^9, 3.831105663564917*^9, 
   3.8686868480783854`*^9, 3.869239219341505*^9},
 CellLabel->
  "Out[1439]=",ExpressionUUID->"8217bf12-3822-48aa-be96-b858a3723a23"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.830278181446301*^9, 3.830278217321067*^9}, 
   3.830350674814992*^9, 3.8303508955865993`*^9, 3.831105663564917*^9, 
   3.8686868480783854`*^9, 3.869239219356307*^9},
 CellLabel->
  "Out[1440]=",ExpressionUUID->"7a99f6a1-5508-467b-9b17-9a66bcda0e5f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "GetLeadingTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetLeadingTerm", "[", "expression_SeriesData", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{"expression", ",", 
      RowBox[{"GetSmallestPower", "[", "expression", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetLeadingTerm", "[", "expression_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"SparseArray", "[", "expression", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"t", ",", 
           RowBox[{"Sequence", "@@", "#"}]}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"t", "[", "\"\<NonzeroPositions\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"GetLeadingTerm", "/@", "t"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830278267260551*^9, 3.8302783425259647`*^9}, {
  3.8302785472158737`*^9, 3.830278710621879*^9}},
 CellLabel->
  "In[1441]:=",ExpressionUUID->"7c21860b-643f-4352-9ac0-00f49c7c41b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"boundary`\[Phi]", "=", 
   RowBox[{"GetLeadingTerm", "[", 
    RowBox[{"Series", "[", 
     RowBox[{"EOM`\[Phi]", ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "1", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundary`\[Chi]", "=", 
   RowBox[{"GetLeadingTerm", "[", 
    RowBox[{"Series", "[", 
     RowBox[{"EOM`\[Chi]", ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "1", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundary`\[Psi]", "=", 
   RowBox[{"GetLeadingTerm", "[", 
    RowBox[{"Series", "[", 
     RowBox[{"EOM`\[Psi]", ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "1", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.830278397586162*^9, 3.8302784695435266`*^9}, {
  3.830278522644244*^9, 3.830278535038127*^9}, {3.830278740965849*^9, 
  3.8302787439119873`*^9}},
 CellLabel->
  "In[1444]:=",ExpressionUUID->"62db7485-7a18-45ee-b19e-da3fa34f62a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "cell", " ", "may", " ", "take", " ", "a", " ", "while", " ",
      "to", " ", "evaluate"}], "..."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"boundary`Q`expansion", "=", 
    RowBox[{"Series", "[", 
     RowBox[{"EOM`Q", ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.830278747378789*^9, 3.830278773151579*^9}, {
  3.8302788259782343`*^9, 3.830278836344348*^9}},
 CellLabel->
  "In[1447]:=",ExpressionUUID->"3a3cbcad-d35e-4dac-ab9e-a88523a664f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"boundary`Q", "=", 
   RowBox[{"GetLeadingTerm", "[", "boundary`Q`expansion", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8302789193156776`*^9, 3.830278957927594*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"255e911a-bfa0-4037-81ba-9587eceee99b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"boundary`Q", "[", 
    RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.830278982414324*^9, 3.8302789976905127`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"69db37e7-204a-4031-9480-a2dd88496718"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Qzz", "[", 
    RowBox[{"x", ",", "1"}], "]"}], 
   RowBox[{"Qtt", "[", 
    RowBox[{"x", ",", "1"}], "]"}]], "\[Equal]", "1"}]], "Output",
 CellChangeTimes->{{3.830278987759516*^9, 3.830278998352388*^9}, 
   3.830350711439138*^9, 3.830350933646266*^9, 3.830952424403049*^9, 
   3.831105693384687*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"33dac7d7-7476-4979-b3e0-1e2b160aaed9"]
}, Open  ]],

Cell[TextData[{
 "From where we see that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "zz"], "[", 
     RowBox[{"x", ",", "1"}], "]"}], "=", 
    RowBox[{
     SubscriptBox["Q", "tt"], "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "acc1193a-c4ea-4a5b-acaa-20f32a1a4f4e"],
 ". We can now use this condition to simplify boundary`Q a bit:"
}], "Text",
 CellChangeTimes->{{3.83027901102358*^9, 
  3.830279071675083*^9}},ExpressionUUID->"27025709-fd48-4be0-8681-\
2ee89bcc851a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"boundary`Q", "/.", 
   RowBox[{"{", 
    RowBox[{"Qtt", "\[Rule]", "Qzz"}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8302790748287373`*^9, 3.83027909307373*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"f7a174e8-b886-4579-931b-afae318711dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "6"}], "+", 
           SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["Qxx", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], 
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}]]}], "+", 
      FractionBox[
       RowBox[{"6", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["Qxx", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["Qyy", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"Qyy", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "-", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["Qzz", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["L", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], "2"]}]], 
       RowBox[{"4", " ", 
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["L", "2"]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["L", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Qzz", "[", 
             RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             SuperscriptBox[
              RowBox[{"\[Phi]1", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"\[Chi]1", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"]}], ")"}]}], "+", 
          SuperscriptBox[
           RowBox[{"\[Psi]", "[", 
            RowBox[{"x", ",", "1"}], "]"}], "2"], "-", 
          RowBox[{
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Qzz", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["\[Phi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["\[Chi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}], "2"]}], ")"}]}], "-", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{
         SuperscriptBox["Qxx", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "1"}], "]"}]]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"8", " ", 
      RowBox[{"Qzz", "[", 
       RowBox[{"x", ",", "1"}], "]"}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"Qyy", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "6"}], "+", 
         SuperscriptBox["\[Mu]", "2"], "-", 
         RowBox[{"2", " ", 
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            SuperscriptBox[
             RowBox[{"\[Phi]1", "[", 
              RowBox[{"x", ",", "1"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"\[Chi]1", "[", 
              RowBox[{"x", ",", "1"}], "]"}], "2"]}], ")"}]}], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"\[Psi]", "[", 
            RowBox[{"x", ",", "1"}], "]"}], "2"], 
          RowBox[{
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}]]}], ")"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "6"}], "+", 
         SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Qyy", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "1"}], "]"}]}], "+", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["Qyy", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
       RowBox[{
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"Qyy", "[", 
         RowBox[{"x", ",", "1"}], "]"}]}]], "-", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Qyy", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "1"}], "]"}]]}], ")"}]}], ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.830279089643877*^9, 3.830279095696845*^9}, 
   3.830350711778426*^9, 3.830350934002269*^9, 3.830952428022285*^9, 
   3.831105693710286*^9, 3.8686869010972557`*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"d400b5f8-cb11-4b4c-bc74-9337585c9e1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SparseArray", "[", "boundary`Q`expansion", "]"}], "[", 
  "\"\<NonzeroPositions\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.830279711749174*^9, 3.830279726919724*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"584b30fc-c9d0-4d46-9801-ecb9fa215806"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.830279732479343*^9, 3.830350711837657*^9, 
  3.830350934065424*^9, 3.830952432611183*^9, 3.831105693773794*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"0dc67cd5-a4c8-4128-8e12-9dd77e412160"]
}, Open  ]],

Cell["\<\
We see that out of the 6 non-zero elements, only the first three diagonal \
elements result in independent equations. To obtain the remaining two, we \
need to consider subleading terms.\
\>", "Text",
 CellChangeTimes->{{3.830279950606842*^9, 
  3.830280019187213*^9}},ExpressionUUID->"01b281fb-59b9-4117-a967-\
11743ae175ba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", "===", "0"}], ",", "\"\<-\>\"", ",", 
       RowBox[{"GetSmallestPower", "[", "#", "]"}]}], "]"}], "&"}], ",", 
    "boundary`Q`expansion", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.830279227657651*^9, 3.830279249404471*^9}, {
   3.830279295503153*^9, 3.830279297490149*^9}, {3.830279346788638*^9, 
   3.830279466151474*^9}, 3.8302795152458143`*^9, {3.8302795867494164`*^9, 
   3.8302795982274027`*^9}, {3.830279634073696*^9, 3.8302796863362627`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"2f283d8f-dcf7-456e-aba8-0ea24349020a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "\<\"-\"\>", "\<\"-\"\>", "\<\"-\"\>"},
     {"\<\"-\"\>", "0", "\<\"-\"\>", 
      RowBox[{"-", "1"}]},
     {"\<\"-\"\>", "\<\"-\"\>", "0", "\<\"-\"\>"},
     {"\<\"-\"\>", 
      RowBox[{"-", "1"}], "\<\"-\"\>", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.830279276780983*^9, 3.83027932661759*^9, 3.830279358362547*^9, 
   3.830279459620638*^9, {3.830279504993538*^9, 3.830279506076833*^9}, {
   3.83027956268408*^9, 3.830279599213426*^9}, {3.830279653155571*^9, 
   3.830279687179433*^9}, 3.830350711869463*^9, 3.830350934081889*^9, 
   3.830952435242269*^9, 3.8311056937973137`*^9},
 CellLabel->
  "Out[103]//MatrixForm=",ExpressionUUID->"7c40f918-e01d-4fbd-ab00-\
b6f6629d50ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"horizonConditions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"boundary`Q", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
    RowBox[{"boundary`Q", "[", 
     RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
    RowBox[{"boundary`Q", "[", 
     RowBox[{"[", "6", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       RowBox[{"boundary`Q`expansion", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "4"}], "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], "//", "Simplify"}], ",", 
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       RowBox[{"boundary`Q`expansion", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", "0"}], "]"}], "//", 
     "Simplify"}], " ", ",", "boundary`\[Psi]", ",", "boundary`\[Phi]", ",", 
    " ", "boundary`\[Chi]"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.830280233548668*^9, 3.830280337685176*^9}, 
   3.830280371463038*^9, {3.830314419554141*^9, 3.830314421377392*^9}, 
   3.83111442238774*^9, {3.83111450957924*^9, 3.831114536918288*^9}},
 CellLabel->
  "In[510]:=",ExpressionUUID->"4c79086e-e822-4884-bdd7-1b255c610752"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "6"}], "+", 
           SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["Qxx", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], 
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "1"}], "]"}]]}], "+", 
      FractionBox[
       RowBox[{"6", " ", 
        RowBox[{
         SuperscriptBox["Qxx", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       RowBox[{"Qzz", "[", 
        RowBox[{"x", ",", "1"}], "]"}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Mu]", "2"], " ", 
        RowBox[{
         SuperscriptBox["Qxx", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       RowBox[{"Qzz", "[", 
        RowBox[{"x", ",", "1"}], "]"}]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["Qtt", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "+", 
      FractionBox[
       RowBox[{"6", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["Qxx", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["Qyy", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"Qyy", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["Qzz", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"-", "6"}], "+", 
           SuperscriptBox["\[Mu]", "2"]}], 
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}]], "-", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            SuperscriptBox[
             RowBox[{"\[Phi]1", "[", 
              RowBox[{"x", ",", "1"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"\[Chi]1", "[", 
              RowBox[{"x", ",", "1"}], "]"}], "2"]}], ")"}]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "6"}], "+", 
           SuperscriptBox["\[Mu]", "2"], "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"\[Psi]", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"]}], 
            RowBox[{
             SuperscriptBox["L", "2"], " ", 
             RowBox[{"Qzz", "[", 
              RowBox[{"x", ",", "1"}], "]"}]}]]}], 
          RowBox[{"Qtt", "[", 
           RowBox[{"x", ",", "1"}], "]"}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Qtt", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], 
          SuperscriptBox[
           RowBox[{"Qtt", "[", 
            RowBox[{"x", ",", "1"}], "]"}], "2"]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Qzz", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], 
          SuperscriptBox[
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], "2"]]}], ")"}]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Phi]1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Chi]1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]}], "-", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{
         SuperscriptBox["Qxx", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "1"}], "]"}]]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"8", " ", 
      RowBox[{"Qzz", "[", 
       RowBox[{"x", ",", "1"}], "]"}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"Qyy", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "6"}], "+", 
         SuperscriptBox["\[Mu]", "2"], "-", 
         RowBox[{"4", " ", 
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            SuperscriptBox[
             RowBox[{"\[Phi]1", "[", 
              RowBox[{"x", ",", "1"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"\[Chi]1", "[", 
              RowBox[{"x", ",", "1"}], "]"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Qyy", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"\[Psi]", "[", 
             RowBox[{"x", ",", "1"}], "]"}], "2"]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "1"}], "]"}]}]], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "6"}], "+", 
         SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Qyy", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "1"}], "]"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "6"}], "+", 
          SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Qyy", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       RowBox[{"Qtt", "[", 
        RowBox[{"x", ",", "1"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["Qyy", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}], "2"], "-", 
          RowBox[{
           RowBox[{"Qyy", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Qyy", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"2", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"Qyy", "[", 
         RowBox[{"x", ",", "1"}], "]"}]}]]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       RowBox[{"Qzz", "[", 
        RowBox[{"x", ",", "1"}], "]"}], 
       RowBox[{"Qtt", "[", 
        RowBox[{"x", ",", "1"}], "]"}]]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Qtt", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"\[Psi]", "[", 
             RowBox[{"x", ",", "1"}], "]"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["Qtt", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "6"}], "+", 
          SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "1"}], "]"}]}]], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"Qyy", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"6", "+", 
                  SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
                RowBox[{"Qzz", "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}], "+", 
               RowBox[{"8", " ", 
                SuperscriptBox[
                 RowBox[{"Qzz", "[", 
                  RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  SuperscriptBox[
                   RowBox[{"\[Phi]1", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"\[Chi]1", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "2"]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "6"}], "+", 
                  SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["Qzz", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{"2", " ", 
          RowBox[{"Qyy", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["Qzz", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Qzz", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["Qzz", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"2", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "6"}], "+", 
           SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
         RowBox[{"Qxx", "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         RowBox[{"Qyy", "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         RowBox[{"Qzz", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"Qxz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", 
                 SuperscriptBox["L", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", 
                   SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
                 RowBox[{"Qzz", "[", 
                  RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox[
                  RowBox[{"\[Psi]", "[", 
                   RowBox[{"x", ",", "1"}], "]"}], "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["L", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["Qxz", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"0", ",", "1"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["L", "2"], " ", 
           RowBox[{"Qtt", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], ")"}]}], ")"}]}], "-", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Qtt", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Qtt", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "3"]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["Qzz", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Qtt", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "2"]], "+", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"Qtt", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "6"}], "+", 
          SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"Qxz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["Qtt", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}], "+", 
          RowBox[{
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Qtt", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], "+", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"Qxx", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]], 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["Qxx", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["Qxx", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Qxx", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"Qyy", "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], "2"]}]], 
       RowBox[{
        RowBox[{"Qxx", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{"Qyy", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Qxz", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Qxz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"Qzz", "[", 
                RowBox[{"x", ",", "1"}], "]"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"Qyy", "[", 
               RowBox[{"x", ",", "1"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "8"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Qzz", "[", 
                   RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   SuperscriptBox[
                    RowBox[{"\[Phi]1", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"\[Chi]1", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "2"]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "6"}], "+", 
                   SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
                 RowBox[{
                  SuperscriptBox["Qzz", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Qzz", "[", 
                  RowBox[{"x", ",", "1"}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"18", "-", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["\[Mu]", "2"]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Qxz", "[", 
             RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
           RowBox[{"Qyy", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Qzz", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Qzz", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"6", "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["Qtt", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["Qtt", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "6"}], "+", 
          SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Qtt", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["L", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "6"}], "+", 
           SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
         RowBox[{"Qtt", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["L", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["\[Mu]", "2"]}], ")"}], "2"], " ", 
          RowBox[{"Qxz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["Qxx", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["L", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"6", "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["Qtt", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "-", 
            RowBox[{"8", " ", 
             RowBox[{"\[Psi]", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["\[Psi]", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["L", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["Qtt", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"Qxx", "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         RowBox[{"Qzz", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}]], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["Qxx", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}], "-", 
             RowBox[{
              RowBox[{"Qxz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["Qxx", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["Qzz", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Qzz", "[", 
            RowBox[{"x", ",", "1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               SuperscriptBox["Qxx", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "1"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["Qxz", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"Qxz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["Qxx", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"2", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], "+", 
      
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Qyy", "[", 
           RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], "2"]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qxz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Qyy", "[", 
            RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
             RowBox[{"Qzz", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["Qxx", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["Qzz", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"Qyy", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
             RowBox[{
              SuperscriptBox["Qyy", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Qzz", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"Qzz", "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                SuperscriptBox["Qyy", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"0", ",", "1"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"x", ",", "1"}], "]"}]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["Qyy", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Qyy", "[", 
               RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{
                  SuperscriptBox["Qzz", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"x", ",", "1"}], "]"}]}], " ", 
                RowBox[{
                 SuperscriptBox["Qzz", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}], "-", 
               RowBox[{"4", " ", 
                RowBox[{"Qzz", "[", 
                 RowBox[{"x", ",", "1"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   SuperscriptBox["Qxz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"x", ",", "1"}], "]"}]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["Qzz", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"Qzz", "[", 
                  RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"\[Phi]1", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], " ", 
                   RowBox[{
                    SuperscriptBox["\[Phi]1", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                  RowBox[{"2", " ", 
                   RowBox[{
                    SuperscriptBox["\[Phi]1", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}], " ", 
                   RowBox[{
                    SuperscriptBox["\[Phi]1", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"\[Chi]1", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], " ", 
                   RowBox[{
                    SuperscriptBox["\[Chi]1", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                  RowBox[{"2", " ", 
                   RowBox[{
                    SuperscriptBox["\[Chi]1", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}], " ", 
                   RowBox[{
                    SuperscriptBox["\[Chi]1", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["Qxz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"2", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"x", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"Qtt", "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         RowBox[{"Qyy", "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["Qxx", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Psi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "6"}], "+", 
           SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Qxx", "[", 
           RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Qtt", "[", 
             RowBox[{"x", ",", "1"}], "]"}], " ", 
            RowBox[{"Qzz", "[", 
             RowBox[{"x", ",", "1"}], "]"}], " ", 
            RowBox[{"\[Psi]", "[", 
             RowBox[{"x", ",", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["Qyy", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"0", ",", "1"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"x", ",", "1"}], "]"}], "-", 
              RowBox[{
               RowBox[{"Qxz", "[", 
                RowBox[{"x", ",", "1"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["Qyy", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Qyy", "[", 
             RowBox[{"x", ",", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Qtt", "[", 
                RowBox[{"x", ",", "1"}], "]"}], " ", 
               RowBox[{"\[Psi]", "[", 
                RowBox[{"x", ",", "1"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   SuperscriptBox["Qzz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Qxz", "[", 
                   RowBox[{"x", ",", "1"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["Qzz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"Qzz", "[", 
                RowBox[{"x", ",", "1"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"\[Psi]", "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qtt", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Qtt", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{"4", " ", 
                  RowBox[{"Qtt", "[", 
                   RowBox[{"x", ",", "1"}], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["\[Psi]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["\[Psi]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Qxx", "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         RowBox[{"Qzz", "[", 
          RowBox[{"x", ",", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"Qyy", "[", 
             RowBox[{"x", ",", "1"}], "]"}], " ", 
            RowBox[{"Qzz", "[", 
             RowBox[{"x", ",", "1"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["Qtt", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "1"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Psi]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "1"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Qtt", "[", 
             RowBox[{"x", ",", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"Qzz", "[", 
                RowBox[{"x", ",", "1"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["Qyy", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"x", ",", "1"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["\[Psi]", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"x", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Qyy", "[", 
                RowBox[{"x", ",", "1"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "6"}], "+", 
                    SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
                  RowBox[{"\[Psi]", "[", 
                   RowBox[{"x", ",", "1"}], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["Qxx", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"Qxz", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["Qxx", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{
                   SuperscriptBox["Qzz", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"x", ",", "1"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["\[Psi]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"x", ",", "1"}], "]"}]}], "+", 
                 RowBox[{"4", " ", 
                  RowBox[{"Qzz", "[", 
                   RowBox[{"x", ",", "1"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["\[Psi]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"2", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", 
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"Qtt", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Qxx", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
        RowBox[{"Qyy", "[", 
         RowBox[{"x", ",", "1"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Qzz", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "2"]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"Qyy", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"Qzz", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["Qtt", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Qtt", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Qyy", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], " ", 
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["Qxx", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
          RowBox[{"Qyy", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"], "+", 
               RowBox[{"4", " ", 
                RowBox[{"Qzz", "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}], " ", 
             RowBox[{"\[Phi]1", "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Phi]1", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"0", ",", "1"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"x", ",", "1"}], "]"}], "-", 
               RowBox[{
                RowBox[{"Qxz", "[", 
                 RowBox[{"x", ",", "1"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["\[Phi]1", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          RowBox[{"Qxx", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Qyy", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["Qzz", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["\[Phi]1", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Qzz", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SuperscriptBox["Qyy", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["\[Phi]1", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Qyy", "[", 
                 RowBox[{"x", ",", "1"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["\[Phi]1", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"2", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox["L", "2"], " ", 
      RowBox[{"Qtt", "[", 
       RowBox[{"x", ",", "1"}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
      RowBox[{"Qyy", "[", 
       RowBox[{"x", ",", "1"}], "]"}], " ", 
      RowBox[{"Qzz", "[", 
       RowBox[{"x", ",", "1"}], "]"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"Qyy", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"Qzz", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["Qtt", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Chi]1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Qtt", "[", 
        RowBox[{"x", ",", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Qyy", "[", 
            RowBox[{"x", ",", "1"}], "]"}]}], " ", 
          RowBox[{"Qzz", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["Qxx", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Chi]1", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Qxx", "[", 
            RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
          RowBox[{"Qyy", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"], "+", 
               RowBox[{"4", " ", 
                RowBox[{"Qzz", "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}], " ", 
             RowBox[{"\[Chi]1", "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               SuperscriptBox["\[Mu]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Chi]1", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"0", ",", "1"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"x", ",", "1"}], "]"}], "-", 
               RowBox[{
                RowBox[{"Qxz", "[", 
                 RowBox[{"x", ",", "1"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["\[Chi]1", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          RowBox[{"Qxx", "[", 
           RowBox[{"x", ",", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Qyy", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["Qzz", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["\[Chi]1", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Qzz", "[", 
              RowBox[{"x", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SuperscriptBox["Qyy", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["\[Chi]1", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Qyy", "[", 
                 RowBox[{"x", ",", "1"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["\[Chi]1", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"2", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"x", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox["L", "2"], " ", 
      RowBox[{"Qtt", "[", 
       RowBox[{"x", ",", "1"}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Qxx", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "2"], " ", 
      RowBox[{"Qyy", "[", 
       RowBox[{"x", ",", "1"}], "]"}], " ", 
      RowBox[{"Qzz", "[", 
       RowBox[{"x", ",", "1"}], "]"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.869064787124976*^9},
 CellLabel->
  "Out[510]=",ExpressionUUID->"4c087321-6e9c-4cdc-b705-0ea79d1f3e3d"]
}, Open  ]],

Cell[TextData[StyleBox["C++ header file", "Section"]], "Text",
 CellChangeTimes->{{3.830314234316712*^9, 
  3.8303142428965282`*^9}},ExpressionUUID->"c18a2db1-fc55-4cbd-96b9-\
caeea70d9aea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "GenerateHeader", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateHeader", " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "m"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{
       "OpenWrite", "[", "\"\<metric/kernels/generated_expressions.hpp\>\"", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", "\[IndentingNewLine]", 
        RowBox[{
        "\"\<// WARNING: DO NOT EDIT\\n\>\"", "<>", "\[IndentingNewLine]", 
         "\"\<// This file is automatically generated by Mathematica.\>\"", "<>",
          "\[IndentingNewLine]", 
         "\"\< Edit HeaderGeneration.nb instead.\\n\\n\>\"", " ", "<>", 
         "\[IndentingNewLine]", "\"\<#pragma once\\n\\n\>\""}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<g_dd\>\"", ",", " ", "g`dd"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<g_UU\>\"", ",", " ", "g`UU"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<Dg_ddd\>\"", ",", " ", "Dg`ddd"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<Dg_dUU\>\"", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"g`UU", ",", " ", "#"}], "]"}], "&"}], " ", "/@", 
            "Coord"}]}], "]"}], "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<DDg_dddd\>\"", ",", " ", "DDg`dddd"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<Gamma_Udd_ref\>\"", ",", "\[CapitalGamma]`Udd`Ref"}], 
          "]"}], "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<DGamma_dUdd_ref\>\"", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"D", "[", 
               RowBox[{"\[CapitalGamma]`Udd`Ref", ",", "#"}], "]"}], "]"}], 
             "&"}], "/@", "Coord"}]}], "]"}], "<>", "\"\<\\n\\n\>\""}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<F_dd\>\"", ",", " ", "F`dd"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<DF_ddd\>\"", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"F`dd", ",", " ", "#"}], "]"}], "&"}], " ", "/@", 
            "Coord"}]}], "]"}], "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"\[Phi]", ",", "#"}], "]"}], "&"}], "/@", "Coord"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<DPhi_d\>\"", ",", "m"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<DDPhi_dd\>\"", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"m", ",", " ", "#"}], "]"}], "&"}], "/@", "Coord"}]}], 
          "]"}], "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"\[Chi]", ",", "#"}], "]"}], "&"}], "/@", "Coord"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<DChi_d\>\"", ",", "m"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<DDChi_dd\>\"", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"m", ",", "#"}], "]"}], "&"}], "/@", "Coord"}]}], "]"}],
          "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteScalarAsMacro", "[", 
          RowBox[{"\"\<V\>\"", ",", "V"}], "]"}], "<>", "\"\<\\n\\n\>\""}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteScalarAsMacro", "[", 
          RowBox[{"\"\<DV_Phi\>\"", ",", "DV`\[Phi]"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteScalarAsMacro", "[", 
          RowBox[{"\"\<DV_Chi\>\"", ",", "DV`\[Chi]"}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{"\"\<Horizon\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", "horizonConditions", "]"}]}], "]"}], "<>", 
         "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"RewriteTensorAsMacros", "[", 
          RowBox[{
          "\"\<Conformal\>\"", ",", "\[IndentingNewLine]", 
           "ConformalEquations"}], "]"}], "<>", "\"\<\\n\>\""}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzk0og3EAx/HZgSTMgdQ2Wc3bIvbQ5GW0uImGUCJlOI2ZA8s2jXlppLyl
ITlMFCOxNa8jShl60hZp4zgvW8plhIP/7zl8+1y/glZVTTubxWLxSbAp7DVL
NxKUHS1Jc2F3VVwnXNTO9MBAjKoPftb5NLDLaNdB3aFyDFoqqifg5bBwHerD
N6zQRUu2oS3DVDlA5Gc+NMDa5tRjD5HK/3HCQo5/KtEUlNFxb4zf2hMFl3gr
5XbAeIU6fIEYu3iZBD+kfiE0ZHNE0Oy9km8Qqdbdelg85NPACwOnH57flM5D
pevADEN3kSsw3ehnTBr9dcASa9E+pE/0vE3iGvXF2PBcYHESJdPR69AZwd6C
9bN7NngvZ53Bcvczo8Zc+E7j76/lA54uP4o9xDzxAQV5tEgFy9RGRhsnTR0a
D8oy7XO98ClhRw8no8yDkFJRKdfuoCx5vzwD6tokghfianQFo4d2/ASIOY1e
xn/JUPte
  "],
 CellLabel->
  "In[1434]:=",ExpressionUUID->"d2a9ded3-9e9c-4704-a541-c5429e319a14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateHeader", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.828081257575891*^9, 3.8280812653242197`*^9}, {
   3.828081298768763*^9, 3.828081303816112*^9}, {3.8280815610907087`*^9, 
   3.8280815657040167`*^9}, 3.830314522755307*^9},
 CellLabel->
  "In[1436]:=",ExpressionUUID->"0d1feb3c-61ec-4d72-aacc-9d007d1271ff"],

Cell[CellGroupData[{

Cell[BoxData["ConformalEquations"], "Input",
 CellChangeTimes->{{3.869140905128441*^9, 3.869140932790414*^9}},
 CellLabel->
  "In[1429]:=",ExpressionUUID->"faf3b053-1c35-4812-8d1a-f7d3d9e06b36"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Qtt", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Qxx", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Qyy", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Qzz", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{"Qxz", "[", 
    RowBox[{"x", ",", "z"}], "]"}], ",", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], "+", 
    RowBox[{"\[Psi]", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "V0"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", " ", "x"}], "]"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"\[Phi]1", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "V0"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", " ", "x"}], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"\[Chi]1", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.869140908089932*^9, 3.8692312473781652`*^9, 
  3.8692316064668417`*^9},
 CellLabel->
  "Out[1429]=",ExpressionUUID->"1c42dadd-d9ad-4cb8-a89c-31aa592c7d80"]
}, Open  ]],

Cell[TextData[StyleBox["Testing", "Section"]], "Text",
 CellChangeTimes->{{3.830314535736204*^9, 
  3.8303145373864594`*^9}},ExpressionUUID->"05ae4957-6f9a-4811-8e87-\
6ba41a4b603c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomParameters", "[", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", 
               RowBox[{"2", ",", "0"}], "]"}], "[", "#", "]"}], "[", 
             RowBox[{"x", ",", "z"}], "]"}], "\[Rule]", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", 
               RowBox[{"1", ",", "1"}], "]"}], "[", "#", "]"}], "[", 
             RowBox[{"x", ",", "z"}], "]"}], "\[Rule]", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", 
               RowBox[{"0", ",", "2"}], "]"}], "[", "#", "]"}], "[", 
             RowBox[{"x", ",", "z"}], "]"}], "\[Rule]", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", 
               RowBox[{"1", ",", "0"}], "]"}], "[", "#", "]"}], "[", 
             RowBox[{"x", ",", "z"}], "]"}], "\[Rule]", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", 
               RowBox[{"0", ",", "1"}], "]"}], "[", "#", "]"}], "[", 
             RowBox[{"x", ",", "z"}], "]"}], "\[Rule]", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"x", ",", "z"}], "]"}], "\[Rule]", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "}"}], "&"}],
         "/@", "Parameters"}], ",", "\[IndentingNewLine]", 
       RowBox[{"z", "\[Rule]", 
        RowBox[{"RandomReal", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]", "\[Rule]", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Sqrt", "[", "2", "]"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"L", "\[Rule]", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"11", "/", "10"}]}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}], "//", "Flatten"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.828104196275119*^9, 3.8281041975051937`*^9}, {
  3.828104237564863*^9, 3.8281042745897293`*^9}, {3.828104334607753*^9, 
  3.828104506687901*^9}, {3.8281151277848053`*^9, 3.8281151428650923`*^9}, {
  3.8281154756453342`*^9, 3.828115652274234*^9}, {3.8281213582466583`*^9, 
  3.828121413185708*^9}, {3.829980687136072*^9, 3.829980697049575*^9}, {
  3.8299809904101877`*^9, 3.8299809948385153`*^9}, {3.830238267005392*^9, 
  3.830238289428947*^9}, {3.83035860146885*^9, 3.830358613096591*^9}, {
  3.8303587000905313`*^9, 3.8303587081433477`*^9}, {3.830358922852371*^9, 
  3.8303589316251383`*^9}, {3.830952055225108*^9, 3.830952068699852*^9}, {
  3.869128686815688*^9, 
  3.869128689606228*^9}},ExpressionUUID->"629475dd-61d7-455e-9ae6-\
9cd174a55e7b"],

Cell["\<\
Grid for a periodic function of x with the period of (2\[Pi]/2.1); using 6 \
points.
Grid for z ranging from 0 to 1; using 6 points.
Askar\[CloseCurlyQuote]s code gives the same output.\
\>", "Text",
 CellChangeTimes->{{3.86903794299702*^9, 
  3.869037981105513*^9}},ExpressionUUID->"be28a504-d988-4fea-8e20-\
33f7f146b686"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xGrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0.4986655005698084", ",", "0.9973310011396168", ",", 
     "1.4959965017094252", ",", "1.9946620022792336", ",", 
     "2.4933275028490423", ",", "2.9919930034188504"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yGrid", "=", 
    RowBox[{"{", "0.0", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"zGrid", "=", 
     RowBox[{"{", 
      RowBox[{
      "1.0", ",", "0.9045084971874737", ",", "0.6545084971874737", ",", 
       "0.34549150281252633", ",", "0.09549150281252633", ",", "0.0"}], 
      "}"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zGrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.9045084971874737", ",", "0.6545084971874737", ",", 
     "0.34549150281252633", ",", "0.09549150281252633"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.868687387686269*^9, 3.868687397518321*^9}, {
   3.8686881293563213`*^9, 3.8686881364315557`*^9}, {3.868688194036151*^9, 
   3.868688198101184*^9}, {3.868688352815341*^9, 3.868688369087976*^9}, {
   3.86903789256172*^9, 3.869037904073278*^9}, {3.869038552273629*^9, 
   3.869038572078102*^9}, 
   3.869122983198831*^9},ExpressionUUID->"0fefebf0-1955-4588-b74f-\
9b6994f82002"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zGridFull", "=", 
   RowBox[{"Catenate", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1.0", "}"}], ",", "zGrid", ",", 
      RowBox[{"{", "0.0", "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.869123792500866*^9, 3.8691238226903877`*^9}},
 CellLabel->
  "In[582]:=",ExpressionUUID->"bad00da0-cd4b-4506-a2ba-ef9df646d1cd"],

Cell["\<\
We now flatten all three grids in such a way that we iterate over x first, \
then y, and then z.\
\>", "Text",
 CellChangeTimes->{{3.869037987782802*^9, 
  3.869038006780525*^9}},ExpressionUUID->"ed85d815-b1a0-4471-af83-\
f971258044a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "CombineGrids", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombineGrids", "[", 
    RowBox[{"xGrid_", ",", "yGrid_", ",", "zGrid_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"xx", ",", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "zGrid"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"yy", ",", "yGrid"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xx", ",", "xGrid"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"yy", ",", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "zGrid"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"yy", ",", "yGrid"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xx", ",", "xGrid"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"zz", ",", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "zGrid"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"yy", ",", "yGrid"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xx", ",", "xGrid"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8691226331552677`*^9, 3.869122812707849*^9}, {
   3.869123379592531*^9, 3.869123549558324*^9}, 3.869123626549418*^9, {
   3.869123659976185*^9, 3.869123697809329*^9}, {3.869124597643265*^9, 
   3.869124628981668*^9}, {3.869124726545094*^9, 3.869124780913294*^9}, 
   3.869128697979742*^9},
 CellLabel->
  "In[938]:=",ExpressionUUID->"6253884d-fc9b-4b90-b99c-e9db3470eedf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bulkX", ",", "bulkY", ",", "bulkZ"}], "}"}], "=", 
   RowBox[{"CombineGrids", "[", 
    RowBox[{"xGrid", ",", "yGrid", ",", "zGrid"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"conformalX", ",", "conformalY", ",", "conformalZ"}], "}"}], "=", 
   
   RowBox[{"CombineGrids", "[", 
    RowBox[{"xGrid", ",", "yGrid", ",", 
     RowBox[{"{", "0.0", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"horizonX", ",", "horizonY", ",", "horizonZ"}], "}"}], "=", 
   RowBox[{"CombineGrids", "[", 
    RowBox[{"xGrid", ",", "yGrid", ",", 
     RowBox[{"{", "1.0", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullGridLength", "=", 
   RowBox[{
    RowBox[{"Length", "[", "xGrid", "]"}], "*", 
    RowBox[{"Length", "[", "yGrid", "]"}], "*", 
    RowBox[{"Length", "[", "zGridFull", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bulkGridLength", "=", 
   RowBox[{"Length", "[", "bulkX", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conformalGridLength", "=", 
   RowBox[{"Length", "[", "conformalX", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"horizonGridLength", "=", 
   RowBox[{"Length", "[", "horizonX", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8691228259221067`*^9, 3.8691228478191*^9}, {
   3.8691228893495083`*^9, 3.8691229586205273`*^9}, {3.86912300904458*^9, 
   3.869123087973996*^9}, 3.869123578364566*^9, {3.8691253618422813`*^9, 
   3.869125386837049*^9}},
 CellLabel->
  "In[940]:=",ExpressionUUID->"4f548b93-8550-4980-b37a-b47f217a9e64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "42", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullQs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"zz", ",", "zGridFull"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yy", ",", "yGrid"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xx", ",", "xGrid"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "Parameters"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullDQs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"zz", ",", "zGridFull"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yy", ",", "yGrid"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xx", ",", "xGrid"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"direction", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "Parameters"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullDDQs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"zz", ",", "zGridFull"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yy", ",", "yGrid"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xx", ",", "xGrid"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"direction1", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"direction2", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "Parameters"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bulkQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullQs", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;", 
         RowBox[{"-", "2"}]}], ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"bulkGridLength", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bulkDQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullDQs", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;", 
         RowBox[{"-", "2"}]}], ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"bulkGridLength", ",", "4", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bulkDDQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullDDQs", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;", 
         RowBox[{"-", "2"}]}], ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"bulkGridLength", ",", "4", ",", "4", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conformalQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullQs", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"conformalGridLength", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conformalDQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullDQs", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"conformalGridLength", ",", "4", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conformalDDQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullDDQs", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"conformalGridLength", ",", "4", ",", "4", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"horizonQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullQs", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"horizonGridLength", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"horizonDQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullDQs", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"horizonGridLength", ",", "4", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"horizonDDQs", "=", 
   RowBox[{"ArrayReshape", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullDDQs", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", ";;", ",", ";;"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"horizonGridLength", ",", "4", ",", "4", ",", 
       RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8686896736492453`*^9, 3.868689706522979*^9}, {
   3.8686899360304193`*^9, 3.868689971008676*^9}, {3.869037868475864*^9, 
   3.869037872633316*^9}, {3.8690430485215178`*^9, 3.869043088982868*^9}, {
   3.869043134467656*^9, 3.869043206992178*^9}, {3.8691236138980083`*^9, 
   3.8691236468648977`*^9}, {3.8691237293935204`*^9, 
   3.8691237440647907`*^9}, {3.8691238300506687`*^9, 
   3.8691238374842587`*^9}, {3.86912389433012*^9, 3.869123910271747*^9}, {
   3.869123963269891*^9, 3.8691241002110243`*^9}, {3.869124424748329*^9, 
   3.869124520619389*^9}, {3.869124799981908*^9, 3.869124801170022*^9}, 
   3.869125406184723*^9, {3.869126248701022*^9, 3.869126319053261*^9}, {
   3.8691281680291033`*^9, 3.869128268307712*^9}},
 CellLabel->
  "In[947]:=",ExpressionUUID->"771c4d20-cb11-4d0c-85a2-dcf8550c170e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "GenericParameterReplacement", ",", "ParameterIndex", ",", 
    "GenericDerivativeReplacement"}], "]"}], ";", 
  RowBox[{
   RowBox[{"GenericParameterReplacement", "[", "Q_", "]"}], ":=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#2", "[", 
        RowBox[{"x", ",", "z_"}], "]"}], "\[Rule]", 
       RowBox[{"Q", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]}],
       "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "Parameters", "]"}], "]"}], ",", 
       "Parameters"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ParameterIndex", "[", "s_Symbol", "]"}], ":=", 
   RowBox[{
    RowBox[{"FirstPosition", "[", 
     RowBox[{"Parameters", ",", "s"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenericDerivativeReplacement", "[", 
     RowBox[{"DQ_", ",", "DDQ_"}], "]"}], "[", "x_", "]"}], ":=", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenericDerivativeReplacement", "[", 
     RowBox[{"DQ_", ",", "DDQ_"}], "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"1", ",", "0"}], "]"}], "[", "s_Symbol", "]"}], "[", 
     RowBox[{"x_Symbol", ",", "z_"}], "]"}], "]"}], ":=", 
   RowBox[{"DQ", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", 
      RowBox[{"ParameterIndex", "[", "s", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenericDerivativeReplacement", "[", 
     RowBox[{"DQ_", ",", "DDQ_"}], "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"0", ",", "1"}], "]"}], "[", "s_Symbol", "]"}], "[", 
     RowBox[{"x_Symbol", ",", "z_"}], "]"}], "]"}], ":=", 
   RowBox[{"DQ", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", 
      RowBox[{"ParameterIndex", "[", "s", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenericDerivativeReplacement", "[", 
     RowBox[{"DQ_", ",", "DDQ_"}], "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"2", ",", "0"}], "]"}], "[", "s_Symbol", "]"}], "[", 
     RowBox[{"x_Symbol", ",", "z_"}], "]"}], "]"}], ":=", 
   RowBox[{"DDQ", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", 
      RowBox[{"ParameterIndex", "[", "s", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenericDerivativeReplacement", "[", 
     RowBox[{"DQ_", ",", "DDQ_"}], "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "[", "s_Symbol", "]"}], "[", 
     RowBox[{"x_Symbol", ",", "z_"}], "]"}], "]"}], ":=", 
   RowBox[{"DDQ", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4", ",", 
      RowBox[{"ParameterIndex", "[", "s", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenericDerivativeReplacement", "[", 
     RowBox[{"DQ_", ",", "DDQ_"}], "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"0", ",", "2"}], "]"}], "[", "s_Symbol", "]"}], "[", 
     RowBox[{"x_Symbol", ",", "z_"}], "]"}], "]"}], ":=", 
   RowBox[{"DDQ", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "4", ",", 
      RowBox[{"ParameterIndex", "[", "s", "]"}]}], "]"}], "]"}]}], ";"}]}], \
"Input",
 CellChangeTimes->{{3.869034819431201*^9, 3.8690348221053543`*^9}, {
   3.8690348681631413`*^9, 3.869034887730023*^9}, {3.869035109704352*^9, 
   3.869035111157415*^9}, {3.869035332473819*^9, 3.869035334543706*^9}, {
   3.869035429905472*^9, 3.8690354468428497`*^9}, {3.8690443430761423`*^9, 
   3.8690443513020897`*^9}, {3.8690444817503138`*^9, 3.86904448889223*^9}, 
   3.869064527259388*^9, {3.869123130826227*^9, 3.869123198658183*^9}, {
   3.869124167919119*^9, 3.869124210881257*^9}, {3.869125074498445*^9, 
   3.869125091811471*^9}, 3.869125132294797*^9, 3.869125201101348*^9, {
   3.869128431207815*^9, 3.869128439804755*^9}, {3.8691287165769873`*^9, 
   3.869128718104748*^9}},
 CellLabel->
  "In[960]:=",ExpressionUUID->"3b424eaf-ee2d-4a8c-8dac-b687b69e2f6f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Pi", "/", "4"}], ",", "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.8692051636869717`*^9, 3.869205178633452*^9}},
 CellLabel->
  "In[1399]:=",ExpressionUUID->"40118fe7-9a4a-493a-89f4-12ed9c4856b9"],

Cell[BoxData["0.78539816339744830961566084581987572105`20."], "Output",
 CellChangeTimes->{{3.8692051675586987`*^9, 3.869205179361628*^9}},
 CellLabel->
  "Out[1399]=",ExpressionUUID->"131be26c-c1f1-49be-a000-95571e71f6fc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "ComputeQuantity", ",", "EvalOnBulkGrid", ",", "EvalOnConformalGrid", ",", 
    "EvalOnHorizonGrid"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComputeQuantity", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"{", 
      RowBox[{
      "xx_", ",", "yy_", ",", "zz_", ",", "Q_", ",", "DQ_", ",", "DDQ_"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", "=", "expr"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"RepeatedRewrite", "[", 
        RowBox[{"e", ",", 
         RowBox[{"GenericDerivativeReplacement", "[", 
          RowBox[{"DQ", ",", "DDQ"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"e", "//.", 
        RowBox[{"GenericParameterReplacement", "[", "Q", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"e", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"L", "\[Rule]", "1"}], ",", 
          RowBox[{"\[Mu]", "\[Rule]", "2.3"}], ",", 
          RowBox[{"k0", "\[Rule]", "2.1"}], ",", 
          RowBox[{"\[Theta]", "\[Rule]", "0.785"}], ",", 
          RowBox[{"V0", "\[Rule]", "5.0"}], ",", 
          RowBox[{"x", "\[Rule]", "xx"}], ",", 
          RowBox[{"y", "\[Rule]", "yy"}], ",", 
          RowBox[{"z", "\[Rule]", "zz"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "e"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvalOnBulkGrid", "[", "expr_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ComputeQuantity", "[", 
       RowBox[{"expr", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
       "bulkX", ",", "bulkY", ",", "bulkZ", ",", "bulkQs", ",", "bulkDQs", 
        ",", "bulkDDQs"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvalOnConformalGrid", "[", "expr_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ComputeQuantity", "[", 
       RowBox[{"expr", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
       "conformalX", ",", "conformalY", ",", "conformalZ", ",", "conformalQs",
         ",", "conformalDQs", ",", "conformalDDQs"}], "}"}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvalOnHorizonGrid", "[", "expr_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ComputeQuantity", "[", 
       RowBox[{"expr", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
       "horizonX", ",", "horizonY", ",", "horizonZ", ",", "horizonQs", ",", 
        "horizonDQs", ",", "horizonDDQs"}], "}"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8690352172702293`*^9, 3.8690352483304462`*^9}, {
   3.869035340206605*^9, 3.8690353412658863`*^9}, {3.8690380785796223`*^9, 
   3.869038088546966*^9}, {3.869039499629879*^9, 3.869039521559373*^9}, {
   3.869045040863924*^9, 3.869045066712344*^9}, {3.8691232827990713`*^9, 
   3.869123307107292*^9}, {3.869123359553009*^9, 3.869123361323503*^9}, {
   3.8691241224085503`*^9, 3.869124144233527*^9}, {3.869124225671102*^9, 
   3.8691243671206017`*^9}, {3.869124868013435*^9, 3.869124962005026*^9}, {
   3.869125023819048*^9, 3.869125043994554*^9}, {3.869125216782649*^9, 
   3.86912522147164*^9}, {3.869125625290512*^9, 3.869125625874134*^9}, {
   3.869125669425501*^9, 3.869125671753092*^9}, {3.8691262009410877`*^9, 
   3.8691262283313627`*^9}, {3.869127969843918*^9, 3.869127971336103*^9}, {
   3.869128114438663*^9, 3.8691281544058943`*^9}, {3.8691284020374203`*^9, 
   3.869128405094879*^9}, {3.8691284541075172`*^9, 3.869128455681746*^9}, {
   3.8691287273293047`*^9, 3.869128734651827*^9}, 3.869205190461773*^9},
 CellLabel->
  "In[1419]:=",ExpressionUUID->"41367a9a-58e4-436e-9551-3bdf6b003f11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "BulkEquations", ",", "ConformalEquations", ",", "HorizonEquations"}], 
   "]"}], ";", 
  RowBox[{"BulkEquations", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"EOM`Q", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"EOM`Q", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"EOM`Q", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"EOM`Q", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "4"}], "]"}], "]"}], ",", 
     RowBox[{"EOM`Q", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", "EOM`\[Psi]", ",", 
     "EOM`\[Phi]", ",", "EOM`\[Chi]"}], "}"}]}], ";", 
  RowBox[{"ConformalEquations", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "params", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"params", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "&"}], "/@", "Parameters"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"params", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"params", "/.", 
           RowBox[{"{", 
            RowBox[{"z", "\[Rule]", "0"}], "}"}]}], "/.", 
          "conformalBoundaries"}], "/.", 
         RowBox[{"{", "}"}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HorizonEquations", "=", "horizonConditions"}], ";"}]}], "Input",
 CellChangeTimes->{{3.869126360370528*^9, 3.86912638837224*^9}, {
  3.869126444992446*^9, 3.869126492803117*^9}, {3.869127841240984*^9, 
  3.8691278450875797`*^9}, {3.869127945023687*^9, 3.869127964399411*^9}, {
  3.869128741963887*^9, 3.869128791626186*^9}, {3.869128942834198*^9, 
  3.869129021333069*^9}, {3.869129143851864*^9, 3.869129145210623*^9}, {
  3.869130222127844*^9, 3.86913023482327*^9}},
 CellLabel->
  "In[1432]:=",ExpressionUUID->"72ef7035-58cf-43b5-9a62-0403453a88a0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BulkEquations", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "-", 
   RowBox[{"FullEquations", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.86912908602672*^9, 3.869129100527973*^9}},
 CellLabel->
  "In[990]:=",ExpressionUUID->"cc4b85df-046b-4574-99d1-eb44775b693a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.86912909574049*^9, 3.8691291014632874`*^9}, 
   3.8691291501209106`*^9},
 CellLabel->
  "Out[990]=",ExpressionUUID->"86f49ab1-94c8-475c-a2e8-e5007c02caed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"BulkEquations", "\[Equal]", "FullEquations"}], "]"}]], "Input",
 CellChangeTimes->{{3.869129025495373*^9, 3.8691290421139927`*^9}},
 CellLabel->
  "In[984]:=",ExpressionUUID->"b5aee76e-b743-4a87-bd02-98eeefad9b23"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.869129034506709*^9, 3.869129083905588*^9},
 CellLabel->
  "Out[984]=",ExpressionUUID->"d2395af8-537e-4e5a-ac7d-fde9c52534d3"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8691278367831793`*^9, 
  3.869127837392597*^9}},ExpressionUUID->"a4e96e6a-ff16-43ae-851c-\
46878f1836b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"combinedEquations", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqnsBulk", ",", "eqnsConformal", ",", "eqnsHorizon"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eqnsBulk", "=", 
       RowBox[{"EvalOnBulkGrid", "[", "BulkEquations", "]"}]}], ";", 
      RowBox[{"eqnsBulk", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"eqnsBulk", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "zGrid", "]"}], ",", 
           RowBox[{"Length", "[", "yGrid", "]"}], ",", 
           RowBox[{"Length", "[", "xGrid", "]"}], ",", 
           RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"eqnsConformal", "=", 
       RowBox[{"EvalOnConformalGrid", "[", "ConformalEquations", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"eqnsConformal", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"eqnsConformal", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "yGrid", "]"}], ",", 
           RowBox[{"Length", "[", "xGrid", "]"}], ",", 
           RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"eqnsHorizon", "=", 
       RowBox[{"EvalOnHorizonGrid", "[", "HorizonEquations", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqnsHorizon", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"eqnsHorizon", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "yGrid", "]"}], ",", 
           RowBox[{"Length", "[", "xGrid", "]"}], ",", 
           RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"Catenate", "[", 
         RowBox[{"{", 
          RowBox[{"eqnsHorizon", ",", "eqnsBulk", ",", "eqnsConformal"}], 
          "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "xGrid", "]"}], "*", 
           RowBox[{"Length", "[", "yGrid", "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "zGrid", "]"}], "+", "2"}], ")"}]}], ",", 
          
          RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.86912576918075*^9, 3.869125888201323*^9}, {
  3.869126054471833*^9, 3.869126191801379*^9}, {3.869128011376419*^9, 
  3.869128082636372*^9}, {3.869128471912189*^9, 3.869128529841453*^9}, {
  3.869128772604549*^9, 3.8691287778754797`*^9}, {3.869130242624905*^9, 
  3.8691302432031384`*^9}, {3.86920773000334*^9, 3.869207730857926*^9}, {
  3.869208064218873*^9, 3.869208135643979*^9}},
 CellLabel->
  "In[1424]:=",ExpressionUUID->"b725a6b6-1bd1-4824-8094-6f698fa4aafc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<test_data.h5\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<x\>\"", "\[Rule]", "xGrid"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<y\>\"", "\[Rule]", "yGrid"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<z\>\"", "\[Rule]", "zGridFull"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Qs\>\"", "\[Rule]", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"fullQs", ",", 
         RowBox[{"{", 
          RowBox[{"fullGridLength", ",", 
           RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<DQs\>\"", "\[Rule]", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"fullDQs", ",", 
         RowBox[{"{", 
          RowBox[{"fullGridLength", ",", "4", ",", 
           RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<DDQs\>\"", "\[Rule]", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"fullDDQs", ",", 
         RowBox[{"{", 
          RowBox[{"fullGridLength", ",", "4", ",", "4", ",", 
           RowBox[{"Length", "[", "Parameters", "]"}]}], "}"}]}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<bulk/g_dd\>\"", "\[Rule]", 
       RowBox[{"EvalOnBulkGrid", "[", "g`dd", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<bulk/divF_d\>\"", "\[Rule]", 
       RowBox[{"EvalOnBulkGrid", "[", "divF`d", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<bulk/equations\>\"", "\[Rule]", 
       RowBox[{"EvalOnBulkGrid", "[", "BulkEquations", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<equations\>\"", "\[Rule]", "combinedEquations"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\"\<Datasets\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.869125293506988*^9, 3.869125328553417*^9}, {
  3.86912542150655*^9, 3.869125562246048*^9}, {3.8691257176537457`*^9, 
  3.8691257343715563`*^9}, {3.869128559137671*^9, 3.869128567739399*^9}, {
  3.8691302626533546`*^9, 3.869130264143648*^9}},
 CellLabel->
  "In[1425]:=",ExpressionUUID->"7cf023e8-6077-49d5-8a27-273b6c82311a"],

Cell[CellGroupData[{

Cell[BoxData["ConformalEquations"], "Input",
 CellChangeTimes->{
  3.8692186115846853`*^9, {3.869228300509412*^9, 3.869228300731372*^9}, {
   3.869231089609139*^9, 3.869231091928721*^9}},
 CellLabel->
  "In[1413]:=",ExpressionUUID->"e1e7caaa-ded0-459d-a981-7a019e496403"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Qtt", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Qxx", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Qyy", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{"Qzz", "[", 
    RowBox[{"x", ",", "z"}], "]"}], ",", 
   RowBox[{"Qxz", "[", 
    RowBox[{"x", ",", "z"}], "]"}], ",", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], "+", 
    RowBox[{"\[Psi]", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "V0"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", " ", "x"}], "]"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"\[Phi]1", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "V0"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", " ", "x"}], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"\[Chi]1", "[", 
     RowBox[{"x", ",", "z"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.869231092682888*^9},
 CellLabel->
  "Out[1413]=",ExpressionUUID->"78f19b92-546c-4ff3-8287-bbb27f2a01d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvalOnHorizonGrid", "[", "HorizonEquations", "]"}]], "Input",
 CellChangeTimes->{{3.86913678974753*^9, 3.86913679569458*^9}},
 CellLabel->
  "In[998]:=",ExpressionUUID->"5168e18b-7314-4c2c-8ecd-6ccbc379109e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.180324097493676`"}], ",", "3.5104586448122275`", ",", 
     "0.016338930293857357`", ",", "10.548023941787722`", ",", 
     RowBox[{"-", "5.556235145778011`"}], ",", 
     RowBox[{"-", "4.66240856663025`"}], ",", "1.8399500265481026`", ",", 
     "3.126708764715201`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.906335782600623`"}], ",", 
     RowBox[{"-", "0.25983862155871956`"}], ",", "0.17330327411497748`", ",", 
     "16.54957219758293`", ",", 
     RowBox[{"-", "20.782763295730042`"}], ",", 
     RowBox[{"-", "0.08127656193882249`"}], ",", "1.7032484450009162`", ",", 
     "1.5344947564628475`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"192.84219141257805`", ",", "28.038942183030542`", ",", 
     RowBox[{"-", "0.1498281279932467`"}], ",", 
     RowBox[{"-", "1.752620366291548`"}], ",", "42.145468856920296`", ",", 
     "15.920268938316232`", ",", 
     RowBox[{"-", "64.15539082335452`"}], ",", 
     RowBox[{"-", "25.16529083876896`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.173807116860527`", ",", "0.26583819592399255`", ",", 
     "0.01091411872769743`", ",", "10.318003826416277`", ",", 
     RowBox[{"-", "4.1766134933021855`"}], ",", "0.38100450046820533`", ",", 
     "0.48779331302402157`", ",", "0.08687226946040594`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9258265532427747`", ",", "0.6809084930945206`", ",", 
     RowBox[{"-", "0.03281835344459316`"}], ",", "9.388220599373668`", ",", 
     RowBox[{"-", "4.761617531469617`"}], ",", 
     RowBox[{"-", "0.6394912057095853`"}], ",", "1.3211301245353935`", ",", 
     "1.6613285192974856`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.163707687183466`"}], ",", "0.7935240133440822`", ",", 
     RowBox[{"-", "0.19798289813964792`"}], ",", "6.695091306529454`", ",", 
     RowBox[{"-", "3.792727560942568`"}], ",", 
     RowBox[{"-", "3.7322310816120456`"}], ",", "1.9472413906032973`", ",", 
     "2.561165106155905`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.869131429352153*^9, 3.8691367965155907`*^9},
 CellLabel->
  "Out[998]=",ExpressionUUID->"010a5744-c58b-40a7-a97d-0dc708dfc7c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvalOnConformalGrid", "[", "ConformalEquations", "]"}]], "Input",
 CellChangeTimes->{{3.8692056312176847`*^9, 3.869205635507492*^9}, {
   3.869207707486082*^9, 3.869207712573061*^9}, 3.869207915265135*^9},
 CellLabel->
  "In[1410]:=",ExpressionUUID->"cb0da83a-e52d-4aab-aaff-019672e24dad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.4584964478648277`"}], ",", 
     RowBox[{"-", "0.36597056225355074`"}], ",", 
     RowBox[{"-", "0.8944270806547507`"}], ",", "0.9106813718660185`", ",", 
     "0.5371285647675794`", ",", 
     RowBox[{"-", "1.8423182372306055`"}], ",", 
     RowBox[{"-", "1.1076194072762844`"}], ",", 
     RowBox[{"-", "1.3813133697295414`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8091085925283794`"}], ",", 
     RowBox[{"-", "0.8313729086232351`"}], ",", 
     RowBox[{"-", "0.9549088772158569`"}], ",", "0.9183503076038653`", ",", 
     "0.7035998173011`", ",", 
     RowBox[{"-", "1.5246635430546425`"}], ",", "2.1757446166099124`", ",", 
     "2.2096067526422662`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.12058058894541746`"}], ",", 
     RowBox[{"-", "0.07259076210999704`"}], ",", 
     RowBox[{"-", "0.4382723467169862`"}], ",", "0.7304893128901817`", ",", 
     "0.8358218562592976`", ",", 
     RowBox[{"-", "2.0776286360125695`"}], ",", "3.8693257296584784`", ",", 
     "4.406608737824095`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8887942107040978`"}], ",", 
     RowBox[{"-", "0.6686830385110718`"}], ",", 
     RowBox[{"-", "0.8288543458259892`"}], ",", "0.32116754727179453`", ",", 
     "0.5412646227716322`", ",", 
     RowBox[{"-", "1.3851319701652107`"}], ",", "2.4963979957763645`", ",", 
     "2.4695753333596686`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5711748855463747`"}], ",", 
     RowBox[{"-", "0.6489192397850507`"}], ",", 
     RowBox[{"-", "0.4431788139076429`"}], ",", "0.8132670368812869`", ",", 
     "0.22370719388998528`", ",", 
     RowBox[{"-", "2.0370432185339475`"}], ",", 
     RowBox[{"-", "1.1037939323539`"}], ",", 
     RowBox[{"-", "1.0801890262878833`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6408849526654434`"}], ",", 
     RowBox[{"-", "0.07498237480671932`"}], ",", 
     RowBox[{"-", "0.21073234552672226`"}], ",", "0.7424740074315064`", ",", 
     "0.11640249380122425`", ",", 
     RowBox[{"-", "1.7057732898162792`"}], ",", 
     RowBox[{"-", "3.0314358935905394`"}], ",", 
     RowBox[{"-", "2.618952704301424`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.869205636428548*^9, 3.8692057485369387`*^9, 
  3.869207915764511*^9},
 CellLabel->
  "Out[1410]=",ExpressionUUID->"51426980-c884-4ce4-814c-5c2e49089e69"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"GenerateInputFile", ",", "GenerateInputFiles"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateInputFiles", "[", "parameters_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Fields", ",", "DFields", ",", "DDFields"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Fields", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"x", ",", "z"}], "]"}], "&"}], "/@", "Parameters"}], "/.", 
        "parameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DFields", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"x", ",", "z"}], "]"}], ",", "i"}], "]"}], "&"}], "/@",
            "Parameters"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "Coord"}], "}"}]}], "]"}], "/.", 
        "parameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DDFields", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"x", ",", "z"}], "]"}], ",", "i", ",", "j"}], "]"}], 
            "&"}], "/@", "Parameters"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "Coord"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "Coord"}], "}"}]}], "]"}], "/.", 
        "parameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/input_01/Q.dat\>\"", ",", "Fields"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/input_01/DQ.dat\>\"", ",", "DFields"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/input_01/DDQ.dat\>\"", ",", 
        RowBox[{"DDFields", "//", "Flatten"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/input_01/rest.dat\>\"", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "\[Mu]", ",", "L"}], "}"}], "/.", 
         "parameters"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8309519362892017`*^9, 3.83095194243111*^9}, 
   3.830952033560739*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"64bcdbcd-c792-4ef9-b8e6-a9e2d1c36ef0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "GenerateOutputFiles", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateOutputFiles", "[", "parameters_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/g_dd/output_01.dat\>\"", ",", " ", 
        RowBox[{"g`dd", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/Dg_ddd/output_01.dat\>\"", ",", " ", 
        RowBox[{
         RowBox[{"Dg`ddd", "/.", "parameters"}], " ", "//", " ", 
         "Flatten"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/DDg_dddd/output_01.dat\>\"", ",", " ", 
        RowBox[{
         RowBox[{"DDg`dddd", "/.", "parameters"}], " ", "//", " ", 
         "Flatten"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/g_UU/output_01.dat\>\"", ",", " ", 
        RowBox[{"g`UU", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/Dg_dUU/output_01.dat\>\"", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"g`UU", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
           ")"}], "/.", "parameters"}], " ", "//", " ", "Flatten"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/Gamma_Udd/output_01.dat\>\"", ",", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"\[CapitalGamma]`Udd", "/.", "parameters"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/DGamma_dUdd/output_01.dat\>\"", ",", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"\[CapitalGamma]`Udd", ",", "#"}], "]"}], "&"}], "/@", 
            "Coord"}], ")"}], "/.", "parameters"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/Xi_U/output_01.dat\>\"", ",", " ", 
        RowBox[{"\[Xi]`U", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/Xi_d/output_01.dat\>\"", ",", " ", 
        RowBox[{"\[Xi]`d", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/DXi_dU/output_01.dat\>\"", ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"\[Xi]`U", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
          ")"}], "/.", "parameters"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/DXi_dd/output_01.dat\>\"", ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"\[Xi]`d", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
          ")"}], "/.", "parameters"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/DivXi_dd/output_01.dat\>\"", ",", " ", 
        RowBox[{"div\[Xi]`dd", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/R_Uddd/output_01.dat\>\"", ",", " ", 
        RowBox[{
         RowBox[{"R`Uddd", "/.", "parameters"}], " ", "//", " ", 
         "Flatten"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/R_dd/output_01.dat\>\"", ",", " ", 
        RowBox[{"R`dd", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/F_dd/output_01.dat\>\"", ",", " ", 
        RowBox[{"F`dd", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/DF_ddd/output_01.dat\>\"", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"F`dd", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
           ")"}], "/.", "parameters"}], " ", "//", " ", "Flatten"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/F_Ud/output_01.dat\>\"", ",", " ", 
        RowBox[{"F`Ud", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/DF_dUd/output_01.dat\>\"", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"F`Ud", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
           ")"}], "/.", "parameters"}], " ", "//", " ", "Flatten"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/EOM_Psi/output_01.dat\>\"", ",", " ", 
        RowBox[{"EOM`\[Psi]", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/EOM_Phi/output_01.dat\>\"", ",", " ", 
        RowBox[{"EOM`\[Phi]", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/EOM_Chi/output_01.dat\>\"", ",", " ", 
        RowBox[{"EOM`\[Chi]", "/.", "parameters"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<kernels/test/G_dd/output_01.dat\>\"", ",", " ", 
        RowBox[{"G`dd", "/.", "parameters"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830952115180121*^9, 3.830952173459373*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"23e0f7bf-9f15-4b29-929e-022c4aae4dda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "GenerateTests", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateTests", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"parameters", "=", 
       RowBox[{"RandomParameters", "[", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GenerateInputFiles", "[", "parameters", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"GenerateOutputFiles", "[", "parameters", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830952184714384*^9, 3.830952232602407*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"bb889c8f-4524-4bf8-8965-2fcc23125cd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "42", "]"}], ";", 
  RowBox[{"GenerateTests", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.830951135646226*^9, 3.830951141515221*^9}, {
  3.830951552593061*^9, 3.8309515571821623`*^9}, {3.8309519464901037`*^9, 
  3.8309519485102882`*^9}, {3.83095223835513*^9, 3.830952247478504*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"149fb5af-530f-4b09-aff7-86b8d94c1161"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.830952087484296*^9, 3.830952088405403*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"20f9e29d-438f-46e2-818d-f9c6b96ffd7a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"parameters", "=", 
         RowBox[{"RandomParameters", "[", "]"}]}], ",", "t"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/input_01.dat\>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "parameters"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/g_dd/output_01.dat\>\"", ",", " ", 
         RowBox[{"g`dd", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/Dg_ddd/output_01.dat\>\"", ",", " ", 
         RowBox[{
          RowBox[{"Dg`ddd", "/.", "parameters"}], " ", "//", " ", 
          "Flatten"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/DDg_dddd/output_01.dat\>\"", ",", " ", 
         RowBox[{
          RowBox[{"DDg`dddd", "/.", "parameters"}], " ", "//", " ", 
          "Flatten"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/g_UU/output_01.dat\>\"", ",", " ", 
         RowBox[{"g`UU", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/Dg_dUU/output_01.dat\>\"", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"g`UU", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
            ")"}], "/.", "parameters"}], " ", "//", " ", "Flatten"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/Gamma_Udd/output_01.dat\>\"", ",", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"\[CapitalGamma]`Udd", "/.", "parameters"}], "]"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/DGamma_dUdd/output_01.dat\>\"", ",", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"\[CapitalGamma]`Udd", ",", "#"}], "]"}], "&"}], "/@", 
             "Coord"}], ")"}], "/.", "parameters"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/Xi_U/output_01.dat\>\"", ",", " ", 
         RowBox[{"\[Xi]`U", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/Xi_d/output_01.dat\>\"", ",", " ", 
         RowBox[{"\[Xi]`d", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/DXi_dU/output_01.dat\>\"", ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"\[Xi]`U", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
           ")"}], "/.", "parameters"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/DXi_dd/output_01.dat\>\"", ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"\[Xi]`d", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
           ")"}], "/.", "parameters"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/DivXi_dd/output_01.dat\>\"", ",", " ", 
         RowBox[{"div\[Xi]`dd", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/R_Uddd/output_01.dat\>\"", ",", " ", 
         RowBox[{
          RowBox[{"R`Uddd", "/.", "parameters"}], " ", "//", " ", 
          "Flatten"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/R_dd/output_01.dat\>\"", ",", " ", 
         RowBox[{"R`dd", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/F_dd/output_01.dat\>\"", ",", " ", 
         RowBox[{"F`dd", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/DF_ddd/output_01.dat\>\"", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"F`dd", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
            ")"}], "/.", "parameters"}], " ", "//", " ", "Flatten"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/F_Ud/output_01.dat\>\"", ",", " ", 
         RowBox[{"F`Ud", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/DF_dUd/output_01.dat\>\"", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"F`Ud", ",", "#"}], "]"}], "&"}], "/@", "Coord"}], 
            ")"}], "/.", "parameters"}], " ", "//", " ", "Flatten"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/EOM_Psi/output_01.dat\>\"", ",", " ", 
         RowBox[{"EOM`\[Psi]", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"EOM`\[Phi]", "/.", "parameters"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"DV`\[Phi]", "/.", "parameters"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/EOM_Phi/output_01.dat\>\"", ",", " ", 
         RowBox[{"EOM`\[Phi]", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"EOM`\[Chi]", "/.", "parameters"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"DV`\[Chi]", "/.", "parameters"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/EOM_Chi/output_01.dat\>\"", ",", " ", 
         RowBox[{"EOM`\[Chi]", "/.", "parameters"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<kernels/test/G_dd/output_01.dat\>\"", ",", " ", 
         RowBox[{"G`dd", "/.", "parameters"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.828115745172923*^9, 3.828115855102335*^9}, {
   3.82811762000562*^9, 3.828117626517296*^9}, {3.8281180212362833`*^9, 
   3.828118060606161*^9}, {3.8281185136285343`*^9, 3.828118518160542*^9}, {
   3.828118700722975*^9, 3.828118731080118*^9}, {3.828121293327894*^9, 
   3.828121299267004*^9}, {3.828155483620207*^9, 3.828155510932205*^9}, 
   3.82815557105515*^9, {3.828158565441144*^9, 3.828158597578923*^9}, {
   3.828158647983034*^9, 3.828158725817317*^9}, {3.828159405247651*^9, 
   3.8281595068456497`*^9}, {3.8281600820180693`*^9, 3.828160153980735*^9}, {
   3.8281608090784607`*^9, 3.828160859334517*^9}, {3.828161164977689*^9, 
   3.8281611743284597`*^9}, {3.828161221196185*^9, 3.828161267034686*^9}, 
   3.828161636201161*^9, {3.828163404095954*^9, 3.828163410401812*^9}, {
   3.828163760068779*^9, 3.8281637682531967`*^9}, {3.8281642465267353`*^9, 
   3.828164264881275*^9}, {3.828164944344089*^9, 3.82816494802605*^9}, {
   3.8281655863853893`*^9, 3.828165603508925*^9}, {3.828166333027808*^9, 
   3.828166340493874*^9}, {3.828166473438143*^9, 3.828166474688603*^9}, {
   3.828166564317823*^9, 3.828166564633587*^9}, {3.82816686485981*^9, 
   3.828166874570619*^9}, {3.828166913553916*^9, 3.8281669245737047`*^9}, {
   3.828167719773469*^9, 3.828167847414702*^9}, {3.828167904768037*^9, 
   3.8281679100291767`*^9}, {3.8281680552867603`*^9, 3.828168090618739*^9}, {
   3.828168217130313*^9, 3.8281682199511766`*^9}, {3.828168419098938*^9, 
   3.8281684216414623`*^9}, {3.828176064853735*^9, 3.828176084243649*^9}, {
   3.828176743420582*^9, 3.828176761650714*^9}, {3.828177389665022*^9, 
   3.828177428953315*^9}, 3.828177500576488*^9, {3.828177636111418*^9, 
   3.8281776419667377`*^9}, {3.8299807239782743`*^9, 
   3.8299808124346647`*^9}, {3.829982008480432*^9, 3.829982021958858*^9}, {
   3.829982958307447*^9, 3.829982978251214*^9}, {3.8299853637680473`*^9, 
   3.829985368492136*^9}, {3.829990290400093*^9, 3.829990365181549*^9}, {
   3.829990413938471*^9, 3.82999041630504*^9}, {3.8299906743659573`*^9, 
   3.829990685347398*^9}, {3.830238306498539*^9, 3.830238330052457*^9}, {
   3.830245510256542*^9, 3.830245529207348*^9}, {3.8302459334490147`*^9, 
   3.8302459545359497`*^9}, {3.8302462372468348`*^9, 3.830246356824006*^9}, {
   3.8302463921794777`*^9, 3.8302463953576317`*^9}, {3.830246463723523*^9, 
   3.8302465662855186`*^9}, {3.830246904342862*^9, 3.830246912438239*^9}, 
   3.8302470009423647`*^9, {3.8302476088306723`*^9, 3.830247635117614*^9}, {
   3.830248628723074*^9, 3.830248640243916*^9}, {3.830314616430811*^9, 
   3.8303147001120777`*^9}, {3.830358490025999*^9, 3.830358518371031*^9}, {
   3.830358633203844*^9, 3.8303586381938677`*^9}, {3.830358960039997*^9, 
   3.830358972880574*^9}, 3.830952245613978*^9, {3.8309524979205513`*^9, 
   3.830952501721942*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"9cc8ba08-d7a8-4a27-8899-dd76ca9a620e"]
},
WindowSize->{852.75, 687.},
WindowMargins->{{2.25, Automatic}, {2.25, Automatic}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c455f7b6-cdf4-4cf9-8e95-e604252a78a7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 168, 3, 52, "Text",ExpressionUUID->"e04412b3-640a-44e4-8bd7-1b249639252c"],
Cell[729, 25, 475, 9, 29, "Input",ExpressionUUID->"2058286f-9816-456d-8fd4-cb50e7d52def"],
Cell[1207, 36, 691, 17, 35, "Text",ExpressionUUID->"10217085-1c6e-496a-9671-1f29c001f45e"],
Cell[1901, 55, 2509, 71, 154, "Input",ExpressionUUID->"9333a9ab-f331-4260-840e-c4470776d2d7"],
Cell[4413, 128, 569, 13, 35, "Text",ExpressionUUID->"de52d0cd-a9a3-4010-bf90-8b8ad4d124a5"],
Cell[4985, 143, 1615, 36, 154, "Input",ExpressionUUID->"2c81f3e5-6ad0-4fc5-be1c-e8b81edc1df7"],
Cell[CellGroupData[{
Cell[6625, 183, 754, 15, 51, "Input",ExpressionUUID->"61e8501b-e71c-4498-9ec3-57bf0e8a5fab"],
Cell[7382, 200, 3150, 92, 178, "Output",ExpressionUUID->"0987b41c-4b2a-4a74-b7ae-ad75569b800c"]
}, Open  ]],
Cell[10547, 295, 312, 7, 35, "Text",ExpressionUUID->"42e7e01e-bd3c-4b31-87e0-240f2043ff7a"],
Cell[CellGroupData[{
Cell[10884, 306, 1149, 30, 154, "Input",ExpressionUUID->"9fb09d0b-588f-4582-ae16-9d3c91edba08"],
Cell[CellGroupData[{
Cell[12058, 340, 4358, 112, 155, "Print",ExpressionUUID->"9a24b16a-ef8b-4443-9703-31dfcff03bc3"],
Cell[16419, 454, 5542, 140, 127, "Print",ExpressionUUID->"285882df-1b71-49a3-a59b-402fee2783e4"],
Cell[21964, 596, 7790, 197, 140, "Print",ExpressionUUID->"57c37888-72a8-4134-bcfe-7e970fccb190"],
Cell[29757, 795, 552, 11, 23, "Print",ExpressionUUID->"e7b940dc-215d-456a-ae24-f2be0b26c1b0"],
Cell[30312, 808, 553, 11, 23, "Print",ExpressionUUID->"48c8d6d2-1baf-440a-919f-db4234c7b2bf"],
Cell[30868, 821, 567, 11, 23, "Print",ExpressionUUID->"60a7c078-91dc-4538-9c56-164c7d7aeb33"],
Cell[31438, 834, 568, 11, 23, "Print",ExpressionUUID->"a1e07191-5caa-4242-af1a-e26ce062cf27"],
Cell[32009, 847, 552, 11, 23, "Print",ExpressionUUID->"2946297b-61e6-492a-b61e-dc96716653bb"],
Cell[32564, 860, 459, 11, 28, "Print",ExpressionUUID->"5c61af63-7145-478b-9ab8-d1e778b6f190"],
Cell[33026, 873, 463, 11, 28, "Print",ExpressionUUID->"dad8a8c1-774d-4668-8c07-d5d1cf7195da"],
Cell[33492, 886, 369, 6, 23, "Print",ExpressionUUID->"7c4377d7-78a0-4977-b18c-4bc80ee97889"]
}, Open  ]]
}, Open  ]],
Cell[33888, 896, 269, 5, 52, "Text",ExpressionUUID->"92e84169-33a1-4e2a-8eb0-b92a6e833f99"],
Cell[34160, 903, 1208, 20, 150, "Text",ExpressionUUID->"88d955bc-9947-4cf8-bf05-568af34a5e60"],
Cell[35371, 925, 2503, 66, 154, "Input",ExpressionUUID->"faf3eef3-4e56-4690-870e-908330bf6e7b"],
Cell[37877, 993, 919, 15, 81, "Text",ExpressionUUID->"5d53460c-658f-4870-b815-2d758e83097e"],
Cell[38799, 1010, 1825, 48, 133, "Input",ExpressionUUID->"cfa4974f-13f4-478b-b956-164df4b6eb6e"],
Cell[CellGroupData[{
Cell[40649, 1062, 235, 4, 35, "Text",ExpressionUUID->"246443fd-a70c-40ba-a15c-6f53ea94aad0",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[40887, 1068, 906, 20, 51, "Input",ExpressionUUID->"7049a8e2-b8ff-4b1b-9b7a-f0cb56303d39",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[41796, 1090, 467, 9, 33, "Output",ExpressionUUID->"46a7fc9a-42dc-4ca0-a672-d177c41fd517",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[42278, 1102, 567, 12, 25, "Input",ExpressionUUID->"a22d6691-d649-4d57-9d1c-2256257ee6c4"],
Cell[42848, 1116, 5610, 129, 339, "Input",ExpressionUUID->"49236ed5-3bb9-43e6-a9f7-2108c1b08660"],
Cell[48461, 1247, 10942, 221, 979, "Input",ExpressionUUID->"afe87b07-8539-4dd6-ac72-d95d6ac48b5d"],
Cell[CellGroupData[{
Cell[59428, 1472, 234, 4, 35, "Text",ExpressionUUID->"1db507cb-9d2e-4ae9-8f09-dc276f5f7b6a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[59665, 1478, 606, 13, 51, "Input",ExpressionUUID->"f9c35832-1302-4069-8d7a-441b371aef64",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[60274, 1493, 1824, 26, 199, "Output",ExpressionUUID->"e71d97dd-beca-4afe-8616-33198d222c37",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[62113, 1522, 2920, 70, 274, "Input",ExpressionUUID->"ae09e6c6-a6f6-4f3a-916e-5bacdcb12b76"],
Cell[CellGroupData[{
Cell[65058, 1596, 209, 4, 35, "Text",ExpressionUUID->"0c08c246-7023-4f53-be28-9714c85eed87",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[65270, 1602, 469, 12, 29, "Input",ExpressionUUID->"2c0a2e07-ce6e-4a29-8c7d-b114bbd836cd",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[65742, 1616, 3691, 50, 694, "Output",ExpressionUUID->"76a4828b-d183-43ce-a789-5d2f559e06c5",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[69448, 1669, 243, 4, 48, "Text",ExpressionUUID->"4db71845-e93b-4134-b38a-d522f28c30e9"],
Cell[69694, 1675, 185, 3, 35, "Text",ExpressionUUID->"7b7b55e8-95a8-481a-bfd6-cd70cd635216"],
Cell[69882, 1680, 214, 4, 41, "Text",ExpressionUUID->"004938ca-d89f-4158-8a1c-b7a2531fdbf5"],
Cell[70099, 1686, 1698, 46, 113, "Input",ExpressionUUID->"a01dcdc6-af6e-41f9-a6e1-36188aa055b2"],
Cell[CellGroupData[{
Cell[71822, 1736, 221, 4, 29, "Input",ExpressionUUID->"1e2e2e7b-e283-4699-8e25-019b2d1bbafb"],
Cell[72046, 1742, 2564, 81, 104, "Output",ExpressionUUID->"c173acb0-ead1-4a84-ab71-8d64fd61253d"]
}, Open  ]],
Cell[74625, 1826, 227, 4, 35, "Text",ExpressionUUID->"11fae75a-0849-49de-a791-c03cd01b1a27"],
Cell[74855, 1832, 797, 20, 71, "Input",ExpressionUUID->"ee5f8696-9c85-4d29-aa8c-ed9d09c47cdd"],
Cell[75655, 1854, 184, 3, 35, "Text",ExpressionUUID->"e0cfbb32-3662-44f7-931b-c7f2cdd9313d"],
Cell[CellGroupData[{
Cell[75864, 1861, 274, 6, 29, "Input",ExpressionUUID->"9b5d2438-37b0-4af2-a7f8-d19fbd2da0b4"],
Cell[76141, 1869, 368, 7, 33, "Output",ExpressionUUID->"ea73180c-e2fc-4663-9370-e171b5ed207f"]
}, Open  ]],
Cell[76524, 1879, 212, 3, 41, "Text",ExpressionUUID->"5e31d897-1e12-442a-a244-9843ea9aa863"],
Cell[76739, 1884, 2361, 70, 195, "Input",ExpressionUUID->"61a297c0-88f6-43cd-990d-778a76639fda"],
Cell[79103, 1956, 411, 10, 29, "Input",ExpressionUUID->"f87aa852-1e00-49b7-bf1a-da44b51ce6e2"],
Cell[79517, 1968, 180, 3, 29, "Input",ExpressionUUID->"4c4f9e06-2116-411a-a4a8-8f93ffdf5a1f"],
Cell[79700, 1973, 357, 8, 29, "Input",ExpressionUUID->"b5679054-f6b9-4ee1-a6e4-514a5b53ba87"],
Cell[CellGroupData[{
Cell[80082, 1985, 286, 7, 29, "Input",ExpressionUUID->"4e477c4e-ef80-4b84-9443-d53b7e3c9463"],
Cell[80371, 1994, 34864, 873, 607, "Output",ExpressionUUID->"910c1ef4-4360-45ee-8e08-72fc35747244"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115272, 2872, 1086, 26, 29, "Input",ExpressionUUID->"4c4bbb7e-91d9-4842-af8c-45f03beacd8f"],
Cell[116361, 2900, 2442, 75, 58, "Output",ExpressionUUID->"f241a9c7-4054-44ea-a509-7b2ef6922232"]
}, Open  ]],
Cell[118818, 2978, 270, 5, 41, "Text",ExpressionUUID->"957f88ae-3316-47de-8349-8f26afcbc887"],
Cell[119091, 2985, 2943, 89, 216, "Input",ExpressionUUID->"353a4442-c6fe-4a7f-8e02-6cd3c7d629ed"],
Cell[122037, 3076, 173, 3, 35, "Text",ExpressionUUID->"04de0dbb-5b91-462b-a8b8-cde93be7d4bb"],
Cell[122213, 3081, 2444, 64, 154, "Input",ExpressionUUID->"10834676-b990-411d-8ea3-bbfb174632a6"],
Cell[CellGroupData[{
Cell[124682, 3149, 273, 6, 29, "Input",ExpressionUUID->"06e0ff92-af5a-4f56-a3b4-680f71af3201"],
Cell[124958, 3157, 651, 19, 33, "Output",ExpressionUUID->"b8113cf4-9375-4605-938b-633812df37ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125646, 3181, 455, 12, 29, "Input",ExpressionUUID->"9625caad-fe09-464a-8ad2-30bb826d05c5"],
Cell[126104, 3195, 4911, 156, 103, "Output",ExpressionUUID->"18e8eafb-d082-4ea8-8b76-991892953473"]
}, Open  ]],
Cell[131030, 3354, 194, 3, 52, "Text",ExpressionUUID->"46893bda-27a2-4290-92b1-b757928f0114"],
Cell[131227, 3359, 194, 3, 41, "Text",ExpressionUUID->"7093105a-4623-4c0c-ac24-434d67acee16"],
Cell[131424, 3364, 335, 10, 35, "Text",ExpressionUUID->"1cd1a550-395d-4c75-9e0a-3baf0afdba1f"],
Cell[CellGroupData[{
Cell[131784, 3378, 1724, 46, 71, "Input",ExpressionUUID->"51c2ebe4-fb78-4efd-baf4-a2a606edd95d"],
Cell[133511, 3426, 1481, 40, 55, "Output",ExpressionUUID->"88e89d1e-5183-45e6-9be9-96723769fc32"]
}, Open  ]],
Cell[135007, 3469, 187, 3, 41, "Text",ExpressionUUID->"40851352-1028-4a3d-9ff0-60982f7d38cb"],
Cell[135197, 3474, 441, 12, 58, "Text",ExpressionUUID->"6de7e417-501d-4019-a537-0950c7be225b"],
Cell[135641, 3488, 388, 11, 51, "Input",ExpressionUUID->"b4c5290b-65a2-4b9d-b1de-081c646ce0d3"],
Cell[CellGroupData[{
Cell[136054, 3503, 230, 4, 35, "Text",ExpressionUUID->"4079727f-7d35-4d5b-b1ef-8be1c826a89f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[136287, 3509, 552, 15, 52, "Input",ExpressionUUID->"278143b6-7153-4db3-82d3-9d99a73684f2",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[136842, 3526, 1894, 58, 50, "Output",ExpressionUUID->"8217bf12-3822-48aa-be96-b858a3723a23",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[138739, 3586, 372, 7, 33, "Output",ExpressionUUID->"7a99f6a1-5508-467b-9b17-9a66bcda0e5f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[139126, 3596, 1388, 36, 174, "Input",ExpressionUUID->"7c21860b-643f-4352-9ac0-00f49c7c41b4"],
Cell[140517, 3634, 1039, 29, 71, "Input",ExpressionUUID->"62db7485-7a18-45ee-b19e-da3fa34f62a5"],
Cell[141559, 3665, 626, 17, 107, "Input",ExpressionUUID->"3a3cbcad-d35e-4dac-ab9e-a88523a664f2"],
Cell[142188, 3684, 291, 7, 29, "Input",ExpressionUUID->"255e911a-bfa0-4037-81ba-9587eceee99b"],
Cell[CellGroupData[{
Cell[142504, 3695, 304, 8, 29, "Input",ExpressionUUID->"69db37e7-204a-4031-9480-a2dd88496718"],
Cell[142811, 3705, 435, 11, 51, "Output",ExpressionUUID->"33dac7d7-7476-4979-b3e0-1e2b160aaed9"]
}, Open  ]],
Cell[143261, 3719, 541, 16, 35, "Text",ExpressionUUID->"27025709-fd48-4be0-8681-2ee89bcc851a"],
Cell[CellGroupData[{
Cell[143827, 3739, 299, 7, 29, "Input",ExpressionUUID->"f7a174e8-b886-4579-931b-afae318711dd"],
Cell[144129, 3748, 7772, 237, 212, "Output",ExpressionUUID->"d400b5f8-cb11-4b4c-bc74-9337585c9e1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151938, 3990, 286, 6, 29, "Input",ExpressionUUID->"584b30fc-c9d0-4d46-9801-ecb9fa215806"],
Cell[152227, 3998, 623, 18, 33, "Output",ExpressionUUID->"0dc67cd5-a4c8-4128-8e12-9dd77e412160"]
}, Open  ]],
Cell[152865, 4019, 336, 7, 58, "Text",ExpressionUUID->"01b281fb-59b9-4117-a967-11743ae175ba"],
Cell[CellGroupData[{
Cell[153226, 4030, 722, 16, 29, "Input",ExpressionUUID->"2f283d8f-dcf7-456e-aba8-0ea24349020a"],
Cell[153951, 4048, 1152, 29, 95, "Output",ExpressionUUID->"7c40f918-e01d-4fbd-ab00-b6f6629d50ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155140, 4082, 1190, 29, 71, "Input",ExpressionUUID->"4c79086e-e822-4884-bdd7-1b255c610752"],
Cell[156333, 4113, 63340, 1804, 1404, "Output",ExpressionUUID->"4c087321-6e9c-4cdc-b705-0ea79d1f3e3d"]
}, Open  ]],
Cell[219688, 5920, 190, 3, 52, "Text",ExpressionUUID->"c18a2db1-fc55-4cbd-96b9-caeea70d9aea"],
Cell[219881, 5925, 7798, 186, 690, "Input",ExpressionUUID->"d2a9ded3-9e9c-4704-a541-c5429e319a14"],
Cell[227682, 6113, 358, 7, 59, "Input",ExpressionUUID->"0d1feb3c-61ec-4d72-aacc-9d007d1271ff"],
Cell[CellGroupData[{
Cell[228065, 6124, 194, 3, 29, "Input",ExpressionUUID->"faf3b053-1c35-4812-8d1a-f7d3d9e06b36"],
Cell[228262, 6129, 1371, 44, 55, "Output",ExpressionUUID->"1c42dadd-d9ad-4cb8-a89c-31aa592c7d80"]
}, Open  ]],
Cell[229648, 6176, 182, 3, 52, "Text",ExpressionUUID->"05ae4957-6f9a-4811-8e87-6ba41a4b603c"],
Cell[229833, 6181, 4089, 101, 236, "Input",ExpressionUUID->"629475dd-61d7-455e-9ae6-9cd174a55e7b"],
Cell[233925, 6284, 334, 8, 81, "Text",ExpressionUUID->"be28a504-d988-4fea-8e20-33f7f146b686"],
Cell[234262, 6294, 1320, 34, 113, "Input",ExpressionUUID->"0fefebf0-1955-4588-b74f-9b6994f82002"],
Cell[235585, 6330, 385, 10, 29, "Input",ExpressionUUID->"bad00da0-cd4b-4506-a2ba-ef9df646d1cd"],
Cell[235973, 6342, 246, 6, 35, "Text",ExpressionUUID->"ed85d815-b1a0-4471-af83-f971258044a1"],
Cell[236222, 6350, 2111, 55, 174, "Input",ExpressionUUID->"6253884d-fc9b-4b90-b99c-e9db3470eedf"],
Cell[238336, 6407, 1696, 44, 154, "Input",ExpressionUUID->"4f548b93-8550-4980-b37a-b47f217a9e64"],
Cell[240035, 6453, 6292, 171, 484, "Input",ExpressionUUID->"771c4d20-cb11-4d0c-85a2-dcf8550c170e"],
Cell[246330, 6626, 4332, 120, 278, InheritFromParent,ExpressionUUID->"3b424eaf-ee2d-4a8c-8dac-b687b69e2f6f"],
Cell[CellGroupData[{
Cell[250687, 6750, 255, 6, 32, "Input",ExpressionUUID->"40118fe7-9a4a-493a-89f4-12ed9c4856b9"],
Cell[250945, 6758, 223, 3, 33, "Output",ExpressionUUID->"131be26c-c1f1-49be-a000-95571e71f6fc"]
}, Open  ]],
Cell[251183, 6764, 4103, 100, 298, "Input",ExpressionUUID->"41367a9a-58e4-436e-9551-3bdf6b003f11"],
Cell[255289, 6866, 2078, 55, 210, "Input",ExpressionUUID->"72ef7035-58cf-43b5-9a62-0403453a88a0"],
Cell[CellGroupData[{
Cell[257392, 6925, 360, 9, 29, "Input",ExpressionUUID->"cc4b85df-046b-4574-99d1-eb44775b693a"],
Cell[257755, 6936, 206, 4, 33, "Output",ExpressionUUID->"86f49ab1-94c8-475c-a2e8-e5007c02caed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[257998, 6945, 266, 5, 29, "Input",ExpressionUUID->"b5aee76e-b743-4a87-bd02-98eeefad9b23"],
Cell[258267, 6952, 182, 3, 33, "Output",ExpressionUUID->"d2395af8-537e-4e5a-ac7d-fde9c52534d3"]
}, Open  ]],
Cell[258464, 6958, 154, 3, 29, "Input",ExpressionUUID->"a4e96e6a-ff16-43ae-851c-46878f1836b0"],
Cell[258621, 6963, 2971, 69, 216, "Input",ExpressionUUID->"b725a6b6-1bd1-4824-8094-6f698fa4aafc"],
Cell[261595, 7034, 2247, 48, 278, "Input",ExpressionUUID->"7cf023e8-6077-49d5-8a27-273b6c82311a"],
Cell[CellGroupData[{
Cell[263867, 7086, 271, 5, 29, "Input",ExpressionUUID->"e1e7caaa-ded0-459d-a981-7a019e496403"],
Cell[264141, 7093, 1274, 41, 55, "Output",ExpressionUUID->"78f19b92-546c-4ff3-8287-bbb27f2a01d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265452, 7139, 232, 4, 29, "Input",ExpressionUUID->"5168e18b-7314-4c2c-8ecd-6ccbc379109e"],
Cell[265687, 7145, 2233, 46, 137, "Output",ExpressionUUID->"010a5744-c58b-40a7-a97d-0dc708dfc7c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267957, 7196, 313, 5, 29, "Input",ExpressionUUID->"cb0da83a-e52d-4aab-aaff-019672e24dad"],
Cell[268273, 7203, 2490, 57, 137, "Output",ExpressionUUID->"51426980-c884-4ce4-814c-5c2e49089e69"]
}, Open  ]],
Cell[270778, 7263, 2624, 71, 216, "Input",ExpressionUUID->"64bcdbcd-c792-4ef9-b8e6-a9e2d1c36ef0"],
Cell[273405, 7336, 6229, 143, 525, "Input",ExpressionUUID->"23e0f7bf-9f15-4b29-929e-022c4aae4dda"],
Cell[279637, 7481, 746, 20, 113, "Input",ExpressionUUID->"bb889c8f-4524-4bf8-8965-2fcc23125cd6"],
Cell[280386, 7503, 425, 8, 29, "Input",ExpressionUUID->"149fb5af-530f-4b09-aff7-86b8d94c1161"],
Cell[280814, 7513, 175, 3, 29, "Input",ExpressionUUID->"20f9e29d-438f-46e2-818d-f9c6b96ffd7a"],
Cell[280992, 7518, 9896, 201, 628, "Input",ExpressionUUID->"9cc8ba08-d7a8-4a27-8899-dd76ca9a620e"]
}
]
*)

