// WARNING: DO NOT EDIT
// This file is automatically generated by Mathematica. Edit HeaderGeneration.nb instead.

#pragma once

#define FROM_EXPRESSIONS_g_dd(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 0, 0) = (L * L)*1. / (z(i...) * z(i...))*Q(i..., 0)*(-1. + z(i...))*(1. + z(i...) * z(i...) - 0.5*(mu * mu)*(z(i...) * z(i...) * z(i...)) + z(i...)); \
    dEsTiNaTiOn(i..., 1, 1) = (L * L)*1. / (z(i...) * z(i...))*Q(i..., 1); \
    dEsTiNaTiOn(i..., 1, 3) = (L * L)*Q(i..., 1)*Q(i..., 4); \
    dEsTiNaTiOn(i..., 2, 2) = (L * L)*1. / (z(i...) * z(i...))*Q(i..., 2); \
    dEsTiNaTiOn(i..., 3, 1) = (L * L)*Q(i..., 1)*Q(i..., 4); \
    dEsTiNaTiOn(i..., 3, 3) = (L * L)*1. / (z(i...) * z(i...))*((Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*1. / (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*Q(i..., 3))

#define FROM_EXPRESSIONS_g_UU(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 0, 0) = -2.*(z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 0)*1. / (-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*1. / (-1. + z(i...)); \
    dEsTiNaTiOn(i..., 1, 1) = 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 1)*1. / Q(i..., 3)*(2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 1.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + (mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*Q(i..., 3)); \
    dEsTiNaTiOn(i..., 1, 3) = -0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 2, 2) = (z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 2); \
    dEsTiNaTiOn(i..., 3, 1) = -0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 3) = 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...))

#define FROM_EXPRESSIONS_Dg_ddd(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 1, 0, 0) = (L * L)*1. / (z(i...) * z(i...))*DQ(i..., 1, 0)*(-1. + z(i...))*(1. + z(i...) * z(i...) - 0.5*(mu * mu)*(z(i...) * z(i...) * z(i...)) + z(i...)); \
    dEsTiNaTiOn(i..., 1, 1, 1) = (L * L)*1. / (z(i...) * z(i...))*DQ(i..., 1, 1); \
    dEsTiNaTiOn(i..., 1, 1, 3) = (L * L)*(DQ(i..., 1, 4)*Q(i..., 1) + DQ(i..., 1, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 1, 2, 2) = (L * L)*1. / (z(i...) * z(i...))*DQ(i..., 1, 2); \
    dEsTiNaTiOn(i..., 1, 3, 1) = (L * L)*(DQ(i..., 1, 4)*Q(i..., 1) + DQ(i..., 1, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 1, 3, 3) = (L * L)*1. / (z(i...) * z(i...))*((Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 1) + 2.*1. / (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 1, 3) + 2.*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 4)*Q(i..., 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 3, 0, 0) = 0.5*(L * L)*1. / (z(i...) * z(i...) * z(i...))*((4. + (2. + mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*Q(i..., 0) + (-2. + (2. + mu * mu)*(z(i...) * z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 3, 0)*z(i...)); \
    dEsTiNaTiOn(i..., 3, 1, 1) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*(-2.*Q(i..., 1) + DQ(i..., 3, 1)*z(i...)); \
    dEsTiNaTiOn(i..., 3, 1, 3) = (L * L)*(DQ(i..., 3, 4)*Q(i..., 1) + DQ(i..., 3, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 3, 2, 2) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*(-2.*Q(i..., 2) + DQ(i..., 3, 2)*z(i...)); \
    dEsTiNaTiOn(i..., 3, 3, 1) = (L * L)*(DQ(i..., 3, 4)*Q(i..., 1) + DQ(i..., 3, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 3, 3, 3) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*(2.*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1)*Q(i..., 4)*(Q(i..., 4) + DQ(i..., 3, 4)*z(i...)) + 1. / ((2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))))*(-2.*(4. - 5.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 6.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*Q(i..., 3) + ((Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 3, 1) + 2.*DQ(i..., 3, 3))*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...))*z(i...)))

#define FROM_EXPRESSIONS_Dg_dUU(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 1, 0, 0) = 2.*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 0) * Q(i..., 0))*1. / (-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*1. / (-1. + z(i...))*DQ(i..., 1, 0); \
    dEsTiNaTiOn(i..., 1, 1, 1) = -0.5*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 1) * Q(i..., 1))*1. / Q(i..., 3)*DQ(i..., 1, 1)*(2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 1.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + (mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*Q(i..., 3)) - 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * Q(i..., 3))*1. / Q(i..., 1)*DQ(i..., 1, 3)*(2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 1.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + (mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*Q(i..., 3)) + 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 1)*1. / Q(i..., 3)*(2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 1) - 2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 1) - 1.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 1) + (mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 1) + 2.*DQ(i..., 1, 3) + 4.*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 4)*Q(i..., 1)*Q(i..., 4) - 4.*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 4)*Q(i..., 1)*Q(i..., 4) - 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 4)*Q(i..., 1)*Q(i..., 4) + 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 4)*Q(i..., 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 1, 1, 3) = -0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*DQ(i..., 1, 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)) + 0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * Q(i..., 3))*DQ(i..., 1, 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 1, 2, 2) = -1.*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 2) * Q(i..., 2))*DQ(i..., 1, 2); \
    dEsTiNaTiOn(i..., 1, 3, 1) = -0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*DQ(i..., 1, 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)) + 0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * Q(i..., 3))*DQ(i..., 1, 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 1, 3, 3) = -0.5*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * Q(i..., 3))*DQ(i..., 1, 3)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 0, 0) = 2.*(z(i...) * z(i...))*1. / (L * L)*1. / ((-1. + z(i...)) * (-1. + z(i...)))*1. / Q(i..., 0)*1. / (-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...)) + 2.*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 0) * Q(i..., 0))*1. / (-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*1. / (-1. + z(i...))*DQ(i..., 3, 0) + 2.*(z(i...) * z(i...))*1. / (L * L)*1. / ((-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...)) * (-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...)))*1. / Q(i..., 0)*1. / (-1. + z(i...))*(-2. + 3.*(mu * mu)*(z(i...) * z(i...)) - 4.*z(i...)) - 4.*1. / (L * L)*1. / Q(i..., 0)*1. / (-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*1. / (-1. + z(i...))*z(i...); \
    dEsTiNaTiOn(i..., 3, 1, 1) = -0.5*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 1) * Q(i..., 1))*1. / Q(i..., 3)*DQ(i..., 3, 1)*(2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 1.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + (mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*Q(i..., 3)) - 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * Q(i..., 3))*1. / Q(i..., 1)*DQ(i..., 3, 3)*(2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 1.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + (mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*Q(i..., 3)) + 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 1)*1. / Q(i..., 3)*(2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 1) - 2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 1) - 1.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 1) + (mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 1) + 2.*DQ(i..., 3, 3) + 8.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...))*Q(i..., 1) - 14.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 7.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 8.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 4.*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 4)*Q(i..., 1)*Q(i..., 4) - 4.*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 4)*Q(i..., 1)*Q(i..., 4) - 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 4)*Q(i..., 1)*Q(i..., 4) + 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 4)*Q(i..., 1)*Q(i..., 4)) + 1. / (L * L)*1. / Q(i..., 1)*1. / Q(i..., 3)*(2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 2.*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) - 1.*(mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + (mu * mu)*(Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*Q(i..., 3))*z(i...); \
    dEsTiNaTiOn(i..., 3, 1, 3) = -0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...)) - 0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. + 3.*(mu * mu)*(z(i...) * z(i...)) - 4.*z(i...))*(-1. + z(i...)) - 0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*DQ(i..., 3, 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)) - 2.*(z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)) + 0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * Q(i..., 3))*DQ(i..., 3, 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 2, 2) = -1.*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 2) * Q(i..., 2))*DQ(i..., 3, 2) + 2.*1. / (L * L)*1. / Q(i..., 2)*z(i...); \
    dEsTiNaTiOn(i..., 3, 3, 1) = -0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...)) - 0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. + 3.*(mu * mu)*(z(i...) * z(i...)) - 4.*z(i...))*(-1. + z(i...)) - 0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*DQ(i..., 3, 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)) - 2.*(z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)) + 0.5*(z(i...) * z(i...) * z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * Q(i..., 3))*DQ(i..., 3, 3)*Q(i..., 4)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 3, 3) = 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...)) + 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / Q(i..., 3)*(-2. + 3.*(mu * mu)*(z(i...) * z(i...)) - 4.*z(i...))*(-1. + z(i...)) - 0.5*(z(i...) * z(i...))*1. / (L * L)*1. / (Q(i..., 3) * Q(i..., 3))*DQ(i..., 3, 3)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)) + 1. / (L * L)*1. / Q(i..., 3)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...))*z(i...)

#define FROM_EXPRESSIONS_DDg_dddd(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 1, 1, 0, 0) = (L * L)*1. / (z(i...) * z(i...))*DDQ(i..., 1, 1, 0)*(-1. + z(i...))*(1. + z(i...) * z(i...) - 0.5*(mu * mu)*(z(i...) * z(i...) * z(i...)) + z(i...)); \
    dEsTiNaTiOn(i..., 1, 1, 1, 1) = (L * L)*1. / (z(i...) * z(i...))*DDQ(i..., 1, 1, 1); \
    dEsTiNaTiOn(i..., 1, 1, 1, 3) = (L * L)*(2.*DQ(i..., 1, 1)*DQ(i..., 1, 4) + DDQ(i..., 1, 1, 4)*Q(i..., 1) + DDQ(i..., 1, 1, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 1, 1, 2, 2) = (L * L)*1. / (z(i...) * z(i...))*DDQ(i..., 1, 1, 2); \
    dEsTiNaTiOn(i..., 1, 1, 3, 1) = (L * L)*(2.*DQ(i..., 1, 1)*DQ(i..., 1, 4) + DDQ(i..., 1, 1, 4)*Q(i..., 1) + DDQ(i..., 1, 1, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 1, 1, 3, 3) = (L * L)*1. / (z(i...) * z(i...))*((Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*DDQ(i..., 1, 1, 1) + 2.*1. / (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DDQ(i..., 1, 1, 3) + 2.*(DQ(i..., 1, 4) * DQ(i..., 1, 4))*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1) + 2.*(z(i...) * z(i...) * z(i...) * z(i...))*(2.*DQ(i..., 1, 1)*DQ(i..., 1, 4) + DDQ(i..., 1, 1, 4)*Q(i..., 1))*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 1, 3, 0, 0) = 0.5*(L * L)*1. / (z(i...) * z(i...) * z(i...))*((4. + (2. + mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 1, 0) + (-2. + (2. + mu * mu)*(z(i...) * z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DDQ(i..., 1, 3, 0)*z(i...)); \
    dEsTiNaTiOn(i..., 1, 3, 1, 1) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*(-2.*DQ(i..., 1, 1) + DDQ(i..., 1, 3, 1)*z(i...)); \
    dEsTiNaTiOn(i..., 1, 3, 1, 3) = (L * L)*(DQ(i..., 1, 4)*DQ(i..., 3, 1) + DQ(i..., 1, 1)*DQ(i..., 3, 4) + DDQ(i..., 1, 3, 4)*Q(i..., 1) + DDQ(i..., 1, 3, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 1, 3, 2, 2) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*(-2.*DQ(i..., 1, 2) + DDQ(i..., 1, 3, 2)*z(i...)); \
    dEsTiNaTiOn(i..., 1, 3, 3, 1) = (L * L)*(DQ(i..., 1, 4)*DQ(i..., 3, 1) + DQ(i..., 1, 1)*DQ(i..., 3, 4) + DDQ(i..., 1, 3, 4)*Q(i..., 1) + DDQ(i..., 1, 3, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 1, 3, 3, 3) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*(2.*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1)*Q(i..., 4)*(DQ(i..., 1, 4) + DDQ(i..., 1, 3, 4)*z(i...)) + 2.*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 4)*Q(i..., 1)*(Q(i..., 4) + DQ(i..., 3, 4)*z(i...)) + 2.*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 1)*Q(i..., 4)*(Q(i..., 4) + DQ(i..., 3, 4)*z(i...)) + 1. / ((2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))))*(-2.*(4. - 5.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 6.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 1, 3) + ((Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DDQ(i..., 1, 3, 1) + 2.*DDQ(i..., 1, 3, 3) + 2.*(z(i...) * z(i...) * z(i...) * z(i...))*(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 1, 4)*DQ(i..., 3, 1)*Q(i..., 4))*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...))*z(i...))); \
    dEsTiNaTiOn(i..., 3, 1, 0, 0) = 0.5*(L * L)*1. / (z(i...) * z(i...) * z(i...))*((4. + (2. + mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 1, 0) + (-2. + (2. + mu * mu)*(z(i...) * z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DDQ(i..., 1, 3, 0)*z(i...)); \
    dEsTiNaTiOn(i..., 3, 1, 1, 1) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*(-2.*DQ(i..., 1, 1) + DDQ(i..., 1, 3, 1)*z(i...)); \
    dEsTiNaTiOn(i..., 3, 1, 1, 3) = (L * L)*(DQ(i..., 1, 4)*DQ(i..., 3, 1) + DQ(i..., 1, 1)*DQ(i..., 3, 4) + DDQ(i..., 1, 3, 4)*Q(i..., 1) + DDQ(i..., 1, 3, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 3, 1, 2, 2) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*(-2.*DQ(i..., 1, 2) + DDQ(i..., 1, 3, 2)*z(i...)); \
    dEsTiNaTiOn(i..., 3, 1, 3, 1) = (L * L)*(DQ(i..., 1, 4)*DQ(i..., 3, 1) + DQ(i..., 1, 1)*DQ(i..., 3, 4) + DDQ(i..., 1, 3, 4)*Q(i..., 1) + DDQ(i..., 1, 3, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 3, 1, 3, 3) = (L * L)*1. / (z(i...) * z(i...) * z(i...))*((Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*(2.*DQ(i..., 1, 1) + DDQ(i..., 1, 3, 1)*z(i...)) + 2.*1. / ((2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))))*(-2.*(z(i...) * z(i...) * z(i...) * z(i...))*DDQ(i..., 1, 3, 3) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))*DDQ(i..., 1, 3, 3) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DDQ(i..., 1, 3, 3) - 4.*DQ(i..., 1, 3) + 10.*(z(i...) * z(i...) * z(i...))*DQ(i..., 1, 3) + 5.*(mu * mu)*(z(i...) * z(i...) * z(i...))*DQ(i..., 1, 3) - 6.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 3) + ((2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 1, 4)*DQ(i..., 3, 4)*Q(i..., 1) + 2.*DDQ(i..., 1, 3, 3)*z(i...)) + 2.*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 4)*(DQ(i..., 1, 4)*DQ(i..., 3, 1)*z(i...) + DQ(i..., 1, 1)*DQ(i..., 3, 4)*z(i...) + Q(i..., 1)*(2.*DQ(i..., 1, 4) + DDQ(i..., 1, 3, 4)*z(i...)))); \
    dEsTiNaTiOn(i..., 3, 3, 0, 0) = -0.5*(L * L)*1. / (z(i...) * z(i...) * z(i...) * z(i...))*(2.*(6. + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*Q(i..., 0) + z(i...)*((-8. - 2.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 4.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 3, 0) + (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DDQ(i..., 3, 3, 0)*z(i...))); \
    dEsTiNaTiOn(i..., 3, 3, 1, 1) = (L * L)*1. / (z(i...) * z(i...) * z(i...) * z(i...))*(6.*Q(i..., 1) + z(i...)*(-4.*DQ(i..., 3, 1) + DDQ(i..., 3, 3, 1)*z(i...))); \
    dEsTiNaTiOn(i..., 3, 3, 1, 3) = (L * L)*(2.*DQ(i..., 3, 1)*DQ(i..., 3, 4) + DDQ(i..., 3, 3, 4)*Q(i..., 1) + DDQ(i..., 3, 3, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 3, 3, 2, 2) = (L * L)*1. / (z(i...) * z(i...) * z(i...) * z(i...))*(6.*Q(i..., 2) + z(i...)*(-4.*DQ(i..., 3, 2) + DDQ(i..., 3, 3, 2)*z(i...))); \
    dEsTiNaTiOn(i..., 3, 3, 3, 1) = (L * L)*(2.*DQ(i..., 3, 1)*DQ(i..., 3, 4) + DDQ(i..., 3, 3, 4)*Q(i..., 1) + DDQ(i..., 3, 3, 1)*Q(i..., 4)); \
    dEsTiNaTiOn(i..., 3, 3, 3, 3) = (L * L)*1. / (z(i...) * z(i...) * z(i...) * z(i...))*(2.*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1)*Q(i..., 4)*(2.*DQ(i..., 3, 4) + DDQ(i..., 3, 3, 4)*z(i...)) + 2.*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 4)*Q(i..., 1)*(Q(i..., 4) + DQ(i..., 3, 4)*z(i...)) + 2.*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 1)*Q(i..., 4)*(Q(i..., 4) + DQ(i..., 3, 4)*z(i...)) + 2.*(z(i...) * z(i...) * z(i...) * z(i...))*Q(i..., 1)*Q(i..., 4)*(Q(i..., 4) + DQ(i..., 3, 4)*z(i...)) - 3.*1. / ((2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))))*(-2.*(4. - 5.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 6.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*Q(i..., 3) + ((Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 3, 1) + 2.*DQ(i..., 3, 3))*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...))*z(i...)) - 2.*(z(i...) * z(i...) * z(i...))*1. / ((2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))))*(-2.*(4. - 5.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 6.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*Q(i..., 3) + ((Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 3, 1) + 2.*DQ(i..., 3, 3))*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...))*z(i...))*(-6. + (mu * mu)*(-3. + 4.*z(i...))) + 1. / ((2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))) * (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...))))*(6.*(z(i...) * z(i...) * z(i...))*Q(i..., 3)*(10. + (mu * mu)*(5. - 8.*z(i...))) + (-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...))*z(i...)*(-2.*DQ(i..., 3, 3) + 2.*(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...))*DQ(i..., 3, 1)*DQ(i..., 3, 4)*Q(i..., 4) + 2.*DDQ(i..., 3, 3, 3)*z(i...) + (Q(i..., 4) * Q(i..., 4))*(z(i...) * z(i...) * z(i...) * z(i...))*((10. - 11.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 13.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DQ(i..., 3, 1) + (2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*DDQ(i..., 3, 3, 1)*z(i...)))))

#define FROM_EXPRESSIONS_Gamma_Udd_ref(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 0, 0, 3) = (-4. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*1. / (-2.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)) + 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) + 4.*z(i...)); \
    dEsTiNaTiOn(i..., 0, 3, 0) = (-4. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*1. / (-2.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)) + 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) + 4.*z(i...)); \
    dEsTiNaTiOn(i..., 1, 1, 3) = -1.*1. / z(i...); \
    dEsTiNaTiOn(i..., 1, 3, 1) = -1.*1. / z(i...); \
    dEsTiNaTiOn(i..., 2, 2, 3) = -1.*1. / z(i...); \
    dEsTiNaTiOn(i..., 2, 3, 2) = -1.*1. / z(i...); \
    dEsTiNaTiOn(i..., 3, 0, 0) = 0.125*(-4. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*1. / z(i...)*(-2. - 2.*(z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...)) - 2.*z(i...))*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 1, 1) = 0.5*(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*1. / z(i...); \
    dEsTiNaTiOn(i..., 3, 2, 2) = 0.5*(2. - 1.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + (mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*1. / z(i...); \
    dEsTiNaTiOn(i..., 3, 3, 3) = (-4. + 5.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) - 6.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)))*1. / (-2.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)) + 2.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) + 4.*z(i...))

#define FROM_EXPRESSIONS_DGamma_dUdd_ref(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 3, 0, 0, 3) = 0.5*(8. - 20.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 32.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)) - 1.*((2. + mu * mu) * (2. + mu * mu))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) + 2.*(mu * mu)*(2. + mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) - 2.*(mu * mu * mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)))*1. / ((-1. + z(i...)) * (-1. + z(i...)))*1. / (z(i...) * z(i...))*1. / ((2. + 2.*(z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*z(i...)) * (2. + 2.*(z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*z(i...))); \
    dEsTiNaTiOn(i..., 3, 0, 3, 0) = 0.5*(8. - 20.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) + 32.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)) - 1.*((2. + mu * mu) * (2. + mu * mu))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) + 2.*(mu * mu)*(2. + mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) - 2.*(mu * mu * mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)))*1. / ((-1. + z(i...)) * (-1. + z(i...)))*1. / (z(i...) * z(i...))*1. / ((2. + 2.*(z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*z(i...)) * (2. + 2.*(z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*z(i...))); \
    dEsTiNaTiOn(i..., 3, 1, 1, 3) = 1. / (z(i...) * z(i...)); \
    dEsTiNaTiOn(i..., 3, 1, 3, 1) = 1. / (z(i...) * z(i...)); \
    dEsTiNaTiOn(i..., 3, 2, 2, 3) = 1. / (z(i...) * z(i...)); \
    dEsTiNaTiOn(i..., 3, 2, 3, 2) = 1. / (z(i...) * z(i...)); \
    dEsTiNaTiOn(i..., 3, 3, 0, 0) = 0.625*((2. + mu * mu) * (2. + mu * mu))*(z(i...) * z(i...) * z(i...) * z(i...)) - 2.25*(mu * mu)*(2. + mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) + 1.75*(mu * mu * mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) + 1. / (z(i...) * z(i...)) + 0.5*(2. + mu * mu)*z(i...); \
    dEsTiNaTiOn(i..., 3, 3, 1, 1) = 1.5*(mu * mu)*(z(i...) * z(i...)) - 1.*1. / (z(i...) * z(i...)) - 1.*(2. + mu * mu)*z(i...); \
    dEsTiNaTiOn(i..., 3, 3, 2, 2) = 1.5*(mu * mu)*(z(i...) * z(i...)) - 1.*1. / (z(i...) * z(i...)) - 1.*(2. + mu * mu)*z(i...); \
    dEsTiNaTiOn(i..., 3, 3, 3, 3) = 0.5*(8. + 4.*(2. + mu * mu)*(z(i...) * z(i...) * z(i...)) - 16.*(mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...)) + 5.*((2. + mu * mu) * (2. + mu * mu))*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) - 10.*(mu * mu)*(2. + mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)) + 6.*(mu * mu * mu * mu)*(z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...) * z(i...)))*1. / ((-1. + z(i...)) * (-1. + z(i...)))*1. / (z(i...) * z(i...))*1. / ((2. + 2.*(z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*z(i...)) * (2. + 2.*(z(i...) * z(i...)) - 1.*(mu * mu)*(z(i...) * z(i...) * z(i...)) + 2.*z(i...)))

#define FROM_EXPRESSIONS_F_dd(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 0, 1) = DQ(i..., 1, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 0, 3) = Q(i..., 5) + DQ(i..., 3, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 1, 0) = -1.*DQ(i..., 1, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 0) = -1.*Q(i..., 5) - 1.*DQ(i..., 3, 5)*(-1. + z(i...))

#define FROM_EXPRESSIONS_DF_ddd(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 1, 0, 1) = DDQ(i..., 1, 1, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 1, 0, 3) = DQ(i..., 1, 5) + DDQ(i..., 1, 3, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 1, 1, 0) = -1.*DDQ(i..., 1, 1, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 1, 3, 0) = -1.*DQ(i..., 1, 5) - 1.*DDQ(i..., 1, 3, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 0, 1) = DQ(i..., 1, 5) + DDQ(i..., 1, 3, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 0, 3) = 2.*DQ(i..., 3, 5) + DDQ(i..., 3, 3, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 1, 0) = -1.*DQ(i..., 1, 5) - 1.*DDQ(i..., 1, 3, 5)*(-1. + z(i...)); \
    dEsTiNaTiOn(i..., 3, 3, 0) = -2.*DQ(i..., 3, 5) - 1.*DDQ(i..., 3, 3, 5)*(-1. + z(i...))

#define FROM_EXPRESSIONS_DPhi_d(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 1) = DQ(i..., 1, 6)*z(i...); \
    dEsTiNaTiOn(i..., 3) = Q(i..., 6) + DQ(i..., 3, 6)*z(i...)

#define FROM_EXPRESSIONS_DDPhi_dd(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 1, 1) = DDQ(i..., 1, 1, 6)*z(i...); \
    dEsTiNaTiOn(i..., 1, 3) = DQ(i..., 1, 6) + DDQ(i..., 1, 3, 6)*z(i...); \
    dEsTiNaTiOn(i..., 3, 1) = DQ(i..., 1, 6) + DDQ(i..., 1, 3, 6)*z(i...); \
    dEsTiNaTiOn(i..., 3, 3) = 2.*DQ(i..., 3, 6) + DDQ(i..., 3, 3, 6)*z(i...)

#define FROM_EXPRESSIONS_DChi_d(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 1) = DQ(i..., 1, 7)*z(i...); \
    dEsTiNaTiOn(i..., 3) = Q(i..., 7) + DQ(i..., 3, 7)*z(i...)

#define FROM_EXPRESSIONS_DDChi_dd(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 1, 1) = DDQ(i..., 1, 1, 7)*z(i...); \
    dEsTiNaTiOn(i..., 1, 3) = DQ(i..., 1, 7) + DDQ(i..., 1, 3, 7)*z(i...); \
    dEsTiNaTiOn(i..., 3, 1) = DQ(i..., 1, 7) + DDQ(i..., 1, 3, 7)*z(i...); \
    dEsTiNaTiOn(i..., 3, 3) = 2.*DQ(i..., 3, 7) + DDQ(i..., 3, 3, 7)*z(i...)

#define FROM_EXPRESSIONS_V(dEsTiNaTiOn) \
    dEsTiNaTiOn(i...) = (-1.*(Q(i..., 6) * Q(i..., 6))*(z(i...) * z(i...)) - 1.*(Q(i..., 7) * Q(i..., 7))*(z(i...) * z(i...)))*1. / (L * L)

#define FROM_EXPRESSIONS_DV_Phi(dEsTiNaTiOn) \
    dEsTiNaTiOn(i...) = -2.*1. / (L * L)*Q(i..., 6)*z(i...)

#define FROM_EXPRESSIONS_DV_Chi(dEsTiNaTiOn) \
    dEsTiNaTiOn(i...) = -2.*1. / (L * L)*Q(i..., 7)*z(i...)

#define FROM_EXPRESSIONS_Horizon(dEsTiNaTiOn) \
    dEsTiNaTiOn(i..., 0) = 0.125*(-8.*(Derivative(1, 0)(\(Phi)1)(x, 1.) * Derivative(1, 0)(\(Phi)1)(x, 1.)) - 8.*(Derivative(1, 0)(\(Chi)1)(x, 1.) * Derivative(1, 0)(\(Chi)1)(x, 1.)) - 2.*(Derivative(1, 0)(Qtt)(x, 1.) * Derivative(1, 0)(Qtt)(x, 1.))*1. / (Qtt(x, 1.) * Qtt(x, 1.)) + 6.*(Derivative(1, 0)(Qxx)(x, 1.) * Derivative(1, 0)(Qxx)(x, 1.))*1. / (Qxx(x, 1.) * Qxx(x, 1.)) - 2.*(Derivative(1, 0)(Qyy)(x, 1.) * Derivative(1, 0)(Qyy)(x, 1.))*1. / (Qyy(x, 1.) * Qyy(x, 1.)) - 2.*(Derivative(1, 0)(Qzz)(x, 1.) * Derivative(1, 0)(Qzz)(x, 1.))*1. / (Qzz(x, 1.) * Qzz(x, 1.)) - 1.*(-6. + mu * mu)*1. / Qtt(x, 1.)*Derivative(0, 1)(Qxx)(x, 1.) + 6.*1. / Qzz(x, 1.)*Derivative(0, 1)(Qxx)(x, 1.) - 1.*(mu * mu)*1. / Qzz(x, 1.)*Derivative(0, 1)(Qxx)(x, 1.) + 2.*Qxx(x, 1.)*(-4.*(-3. + \(Phi)1(x, 1.) * \(Phi)1(x, 1.) + \(Chi)1(x, 1.) * \(Chi)1(x, 1.)) + (-6. + mu * mu)*1. / Qzz(x, 1.) + 1. / Qtt(x, 1.)*(-6. + mu * mu - 2.*(\(Psi)(x, 1.) * \(Psi)(x, 1.))*1. / (L * L)*1. / Qzz(x, 1.)) + (-6. + mu * mu)*1. / (Qtt(x, 1.) * Qtt(x, 1.))*Qxz(x, 1.)*Derivative(1, 0)(Qtt)(x, 1.) + (-6. + mu * mu)*1. / (Qzz(x, 1.) * Qzz(x, 1.))*Qxz(x, 1.)*Derivative(1, 0)(Qzz)(x, 1.)) - 4.*1. / Qxx(x, 1.)*Derivative(2, 0)(Qxx)(x, 1.)); \
    dEsTiNaTiOn(i..., 1) = 0.125*1. / Qzz(x, 1.)*(2.*1. / (L * L)*1. / Qtt(x, 1.)*Qyy(x, 1.)*(-2.*(\(Psi)(x, 1.) * \(Psi)(x, 1.)) + (L * L)*(-6. + mu * mu)*Qzz(x, 1.)) + 2.*Qyy(x, 1.)*(-6. + mu * mu - 4.*(-3. + \(Phi)1(x, 1.) * \(Phi)1(x, 1.) + \(Chi)1(x, 1.) * \(Chi)1(x, 1.))*Qzz(x, 1.)) - 1.*(-6. + mu * mu)*Derivative(0, 1)(Qyy)(x, 1.) - 1.*(-6. + mu * mu)*1. / Qtt(x, 1.)*Qzz(x, 1.)*Derivative(0, 1)(Qyy)(x, 1.) + 4.*1. / Qxx(x, 1.)*1. / Qyy(x, 1.)*Qzz(x, 1.)*(Derivative(1, 0)(Qyy)(x, 1.) * Derivative(1, 0)(Qyy)(x, 1.) - 1.*Qyy(x, 1.)*Derivative(2, 0)(Qyy)(x, 1.))); \
    dEsTiNaTiOn(i..., 2) = 0.25*(-1. + 1. / Qtt(x, 1.)*Qzz(x, 1.)); \
    dEsTiNaTiOn(i..., 3) = 0.25*(1. / (Qtt(x, 1.) * Qtt(x, 1.))*Qzz(x, 1.)*Derivative(0, 1)(Qtt)(x, 1.) - 2.*1. / (L * L)*1. / (-6. + mu * mu)*1. / Qtt(x, 1.)*(-2.*(\(Psi)(x, 1.) * \(Psi)(x, 1.)) + 3.*(L * L)*(-2. + mu * mu)*Qzz(x, 1.) + (L * L)*(-6. + mu * mu)*Derivative(0, 1)(Qtt)(x, 1.)) + 1. / (-6. + mu * mu)*1. / Qxx(x, 1.)*1. / Qyy(x, 1.)*1. / Qzz(x, 1.)*(-1.*Qxx(x, 1.)*(-2.*(-6. + mu * mu)*(Qzz(x, 1.) * Qzz(x, 1.)) + Qyy(x, 1.)*(8.*(Qzz(x, 1.) * Qzz(x, 1.))*(-3. + \(Phi)1(x, 1.) * \(Phi)1(x, 1.) + \(Chi)1(x, 1.) * \(Chi)1(x, 1.)) + 2.*(6. + mu * mu)*Qzz(x, 1.) + (-6. + mu * mu)*Derivative(0, 1)(Qzz)(x, 1.))) + 2.*Qyy(x, 1.)*((-6. + mu * mu)*(Qzz(x, 1.) * Qzz(x, 1.)) + 2.*(Derivative(1, 0)(Qzz)(x, 1.) * Derivative(1, 0)(Qzz)(x, 1.)) - 2.*Qzz(x, 1.)*Derivative(2, 0)(Qzz)(x, 1.)))); \
    dEsTiNaTiOn(i..., 4) = 0.125*(-1.*1. / (L * L)*1. / Qtt(x, 1.)*1. / Qzz(x, 1.)*Qxx(x, 1.)*(2.*Qxz(x, 1.)*(2.*(\(Psi)(x, 1.) * \(Psi)(x, 1.)) + 3.*(L * L)*(-2. + mu * mu)*Qzz(x, 1.)) + (L * L)*(-6. + mu * mu)*Qzz(x, 1.)*Derivative(0, 1)(Qxz)(x, 1.)) - 4.*1. / (Qtt(x, 1.) * Qtt(x, 1.) * Qtt(x, 1.))*Qzz(x, 1.)*Derivative(0, 1)(Qtt)(x, 1.)*Derivative(1, 0)(Qtt)(x, 1.) + 2.*1. / (Qtt(x, 1.) * Qtt(x, 1.))*Derivative(0, 1)(Qzz)(x, 1.)*Derivative(1, 0)(Qtt)(x, 1.) + (-6. + mu * mu)*1. / (Qtt(x, 1.) * Qtt(x, 1.))*Qxx(x, 1.)*Qxz(x, 1.)*(Derivative(0, 1)(Qtt)(x, 1.) + Qxz(x, 1.)*Derivative(1, 0)(Qtt)(x, 1.)) + 2.*1. / (Qxx(x, 1.) * Qxx(x, 1.))*Derivative(1, 0)(Qxx)(x, 1.)*(-2.*Qzz(x, 1.) + Derivative(0, 1)(Qxx)(x, 1.) + 2.*Qxz(x, 1.)*Derivative(1, 0)(Qxx)(x, 1.)) + 1. / (Qzz(x, 1.) * Qzz(x, 1.))*1. / Qyy(x, 1.)*Qxx(x, 1.)*(-3.*(-6. + mu * mu)*Qyy(x, 1.)*Qzz(x, 1.)*Derivative(0, 1)(Qxz)(x, 1.) + Qxz(x, 1.)*(2.*(-6. + mu * mu)*(Qzz(x, 1.) * Qzz(x, 1.)) + Qyy(x, 1.)*(-8.*(Qzz(x, 1.) * Qzz(x, 1.))*(-3. + \(Phi)1(x, 1.) * \(Phi)1(x, 1.) + \(Chi)1(x, 1.) * \(Chi)1(x, 1.)) + (-6. + mu * mu)*Derivative(0, 1)(Qzz)(x, 1.) + 2.*Qzz(x, 1.)*(18. - 5.*(mu * mu) + (-6. + mu * mu)*Derivative(1, 0)(Qxz)(x, 1.)))) + (-6. + mu * mu)*(Qxz(x, 1.) * Qxz(x, 1.))*Qyy(x, 1.)*Derivative(1, 0)(Qzz)(x, 1.)) + 2.*1. / (-6. + mu * mu)*1. / (Qtt(x, 1.) * Qtt(x, 1.))*Qzz(x, 1.)*((6. + mu * mu)*Derivative(1, 0)(Qtt)(x, 1.) + (-6. + mu * mu)*Derivative(1, 1)(Qtt)(x, 1.)) - 1.*1. / (L * L)*1. / (-6. + mu * mu)*1. / Qtt(x, 1.)*((L * L)*((-6. + mu * mu) * (-6. + mu * mu))*Qxz(x, 1.)*Derivative(0, 1)(Qxx)(x, 1.) + 2.*((L * L)*(6. + mu * mu)*Derivative(1, 0)(Qtt)(x, 1.) - 8.*\(Psi)(x, 1.)*Derivative(1, 0)(\(Psi))(x, 1.) + (L * L)*(-6. + mu * mu)*Derivative(1, 1)(Qtt)(x, 1.))) - 4.*1. / Qxx(x, 1.)*1. / Qzz(x, 1.)*((Derivative(0, 1)(Qxx)(x, 1.) - 1.*Qxz(x, 1.)*Derivative(1, 0)(Qxx)(x, 1.))*Derivative(1, 0)(Qzz)(x, 1.) + Qzz(x, 1.)*(Derivative(1, 0)(Qxx)(x, 1.)*(1. + Derivative(1, 0)(Qxz)(x, 1.)) + Qxz(x, 1.)*Derivative(2, 0)(Qxx)(x, 1.))) + 1. / (Qyy(x, 1.) * Qyy(x, 1.))*1. / (Qzz(x, 1.) * Qzz(x, 1.))*((Qyy(x, 1.) * Qyy(x, 1.))*Qxz(x, 1.)*(2.*(-6. + mu * mu)*(Qzz(x, 1.) * Qzz(x, 1.)) - 4.*(Derivative(1, 0)(Qzz)(x, 1.) * Derivative(1, 0)(Qzz)(x, 1.)) - 1.*(-6. + mu * mu)*Qzz(x, 1.)*Derivative(0, 1)(Qxx)(x, 1.)) - 2.*(-2.*(Qzz(x, 1.) * Qzz(x, 1.))*Qyy(x, 1.)*Derivative(1, 0)(Qyy)(x, 1.) + (Qzz(x, 1.) * Qzz(x, 1.))*(2.*Qzz(x, 1.) + Derivative(0, 1)(Qyy)(x, 1.))*Derivative(1, 0)(Qyy)(x, 1.) + (Qyy(x, 1.) * Qyy(x, 1.))*(-1.*Derivative(0, 1)(Qzz)(x, 1.)*Derivative(1, 0)(Qzz)(x, 1.) - 4.*Qzz(x, 1.)*(1. + Derivative(1, 0)(Qxz)(x, 1.))*Derivative(1, 0)(Qzz)(x, 1.) + 2.*(Qzz(x, 1.) * Qzz(x, 1.))*(2.*\(Phi)1(x, 1.)*Derivative(1, 0)(\(Phi)1)(x, 1.) + 2.*Derivative(0, 1)(\(Phi)1)(x, 1.)*Derivative(1, 0)(\(Phi)1)(x, 1.) + 2.*\(Chi)1(x, 1.)*Derivative(1, 0)(\(Chi)1)(x, 1.) + 2.*Derivative(0, 1)(\(Chi)1)(x, 1.)*Derivative(1, 0)(\(Chi)1)(x, 1.) + Derivative(2, 0)(Qxz)(x, 1.))))))
